1
                 Chemistry at HARvard Macromolecular Mechanics
           (CHARMM) - Developmental Version 44a2   February 15, 2019            
       Copyright(c) 1984-2014  President and Fellows of Harvard College
                              All Rights Reserved
  Current operating system: Linux-3.10.0-1160.45.1.el7.x86_64(x86_64)@cgprod.   
                 Created on  3/24/22 at 14:23:52 by user: apache      

            Maximum number of ATOMS:    360720, and RESidues:      120240
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 24. 2022. JOBID=4814588605
 RDTITL> * GENERATES IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    DIMENS CHSIZE 5000000 MAXRES 5000000 MAXGRP 5000000
Size      Original         New
MAXA        360720     5000000
MAXB        360720     5000000
MAXT        721440    10000000
MAXP       1082160    15000000
MAXIMP      180360     2500000
MAXNB        90180     1250000
MAXPAD      360720     5000000
MAXRES      120240     5000000
MAXSEG       45090      625000
MAXATC        1400
MAXCB         3000
MAXCT        50000
MAXCP        20000
MAXCI         1200
MAXCH         6400
MAXCN       502503
MAXCRT      120240     1666666
  
 CHARMM>     
  
 CHARMM>    ! Read topology and parameter files
 CHARMM>    stream toppar.str
 VOPEN> Attempting to open::toppar.str::
 OPNLGU> Unit 99 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 24. 2022. JOBID=4814588605
 RDTITL> * STREAM FILE FOR TOPOLOGY AND PARAMETER READING
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! protein topology and parameter
 CHARMM>    open read card unit 10 name toppar/top_all36_prot.rtf
 VOPEN> Attempting to open::toppar/top_all36_prot.rtf::
 OPNLGU> Unit 10 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/top_all36_prot.rtf
  
 CHARMM>    read  rtf card unit 10
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *>>>>>>>>CHARMM36 ALL-HYDROGEN TOPOLOGY FILE FOR PROTEINS <<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> MAY 2011 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36m_prot.prm
 VOPEN> Attempting to open::toppar/par_all36m_prot.prm::
 OPNLGU> Unit 20 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/par_all36m_prot.prm
  
 CHARMM>    read para card unit 20 flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *>>>> CHARMM36 ALL-HYDROGEN PARAMETER FILE FOR PROTEINS <<<<<<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! nucleic acids
 CHARMM>    open read card unit 10 name toppar/top_all36_na.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_na.rtf::
 OPNLGU> Unit 10 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/top_all36_na.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID TOPOLOGY FILE ////
 TITLE> *   ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                      APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *           PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_na.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_na.prm::
 OPNLGU> Unit 20 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/par_all36_na.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID PARAMETER FILE ////
 TITLE> *         ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                        APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG PARAMETER
 TITLE> *                     SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! carbohydrates
 CHARMM>    open read card unit 10 name toppar/top_all36_carb.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_carb.rtf::
 OPNLGU> Unit 10 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/top_all36_carb.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * $ID: TOP_ALLXX_SUGAR.INP,V 1.106 2014/08/19 19:07:43 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN TOPOLOGIES USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_carb.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_carb.prm::
 OPNLGU> Unit 20 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/par_all36_carb.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * $ID: PAR_ALLXX_SUGAR.INP,V 1.132 2014/08/19 19:03:21 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN PARAMETERS USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! lipids
 CHARMM>    open read card unit 10 name toppar/top_all36_lipid.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_lipid.rtf::
 OPNLGU> Unit 10 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/top_all36_lipid.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID TOPOLOGY FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_lipid.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_lipid.prm::
 OPNLGU> Unit 20 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/par_all36_lipid.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID PARAMETER FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! CGENFF
 CHARMM>    open read card unit 10 name toppar/top_all36_cgenff.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_cgenff.rtf::
 OPNLGU> Unit 10 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/top_all36_cgenff.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *          CGENFF: TOPOLOGY FOR THE CHARMM GENERAL FORCE FIELD V. 4.6          *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *

 DRUDES PARTICLES WILL BE GENERATED AUTOMATICALLY FOR ALL ATOMS WITH NON-ZERO ALPHA
 Thole-type dipole screening, Slater-Delta shape {S(u) = 1 - (1+u/2)*exp(-u)}, default radius =  1.300000
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_cgenff.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_cgenff.prm::
 OPNLGU> Unit 20 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/par_all36_cgenff.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *         CGENFF: PARAMETERS FOR THE CHARMM GENERAL FORCE FIELD V. 4.6         *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *  2017/8: IF PROTEIN, NUCLEIC ACID AND CARBOHYDRATE TOPOLOGY AND PARAMETER FILES
 TITLE> *  ARE NOT READ PRIOR TO THE CGENFF FILES "WARNING: ATOMS IN NBFIX ' errors will
 TITLE> *  BE ENCOUNTERED.  THESE CAN BE PASSED BY SETTING BOMLEV ( -2) PRIOR TO READING
 TITLE> *  THIS FILE. IN ADDITION, WHEN GENERATING AROMATIC HALOGENS (CL, BR, I) WITH
 TITLE> *  PRE C41B/C42A VERSIONS OF CHARMM "MISSING PARAMETER" ERRORS WILL BE
 TITLE> *  ENCOUNTERED THAT ALSO REQUIRE SETTING BOMLEV ( -2).
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! Phosphates and Sulfates
 CHARMM>    stream toppar/toppar_all36_moreions.str
 VOPEN> Attempting to open::toppar/toppar_all36_moreions.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_moreions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIONAL IONS GENERATED USING CGENFF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "345"
 Parameter: NAT <- "345"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "345"
 Parameter: NAT -> "345"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""345"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "345" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES GENERATED BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Interface FF
 CHARMM>    open read card unit 10 name toppar/top_interface.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_interface.rtf::
 OPNLGU> Unit 10 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/top_interface.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY FOR NANOMATERIALS
 TITLE> *
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO17      -1.050
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO21      -1.050
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/par_interface.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_interface.prm::
 OPNLGU> Unit 10 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/par_interface.prm
  
 CHARMM>    read para card unit 10 append flex

          PARAMETER FILE BEING READ FROM UNIT 10
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY AND PARAMETER FOR CALY MINERALS, CEMENT MINERALS
 TITLE> *
 PARRDR> Error: Repeated DIHE parameter ( 10950): HGR6  ICG1  ICG1  ICGE is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    stream toppar/toppar_all36_nano_lig.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_nano_lig.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR NANO-LIGAND
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_nano_lig_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_nano_lig_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for synthetic polymer
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_synthetic_polymer.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_synthetic_polymer_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_polymer_solvent.str
 VOPEN> Attempting to open::toppar/toppar_all36_polymer_solvent.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_polymer_solvent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for water and ions
 CHARMM>    stream toppar/toppar_water_ions.str
 VOPEN> Attempting to open::toppar/toppar_water_ions.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_water_ions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR WATER AND IONS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_water_ions.inp
 CHARMM>     
  
 CHARMM>    ! IMPORTANT NOTE: this file contains NBFixes between carboxylates and sodium,
 CHARMM>    ! which will only apply if the main files containing carboxylate atom types
 CHARMM>    ! have been read in first!
 CHARMM>     
  
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !TIP3P water model
 CHARMM>    !
 CHARMM>    !W.L. Jorgensen; J.Chandrasekhar; J.D. Madura; R.W. Impey;
 CHARMM>    !M.L. Klein; "Comparison of simple potential functions for
 CHARMM>    !simulating liquid water", J. Chem. Phys. 79 926-935 (1983).
 CHARMM>    !
 CHARMM>    !IONS
 CHARMM>    !
 CHARMM>    !Ions from Roux and coworkers
 CHARMM>    !
 CHARMM>    !Beglov, D. and Roux, B., Finite Representation of an Infinite
 CHARMM>    !Bulk System: Solvent Boundary Potential for Computer Simulations,
 CHARMM>    !Journal of Chemical Physics, 1994, 100: 9050-9063
 CHARMM>    !
 CHARMM>    !ZINC
 CHARMM>    !
 CHARMM>    !Stote, R.H. and Karplus, M. Zinc Binding in Proteins and
 CHARMM>    !Solution: A Simple but Accurate Nonbonded Representation, PROTEINS:
 CHARMM>    !Structure, Function, and Genetics 23:12-31 (1995)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "455"
 Parameter: NAT <- "455"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "455"
 Parameter: NAT -> "455"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""455"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "455" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR WATER AND IONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! The following section contains NBFixes for sodium interacting with
 CHARMM>    ! carboxylate oxygens of various CHARMM force fields. It will generate
 CHARMM>    ! level -1 warnings whenever any of these force fields have not been
 CHARMM>    ! read prior to the current stream file. Since we don't want to force
 CHARMM>    ! the user to always read all the force fields, we're suppressing the
 CHARMM>    ! warnings. The only side effect is that you will have "most severe
 CHARMM>    ! warning was at level 0" at the end of your output. Also note that
 CHARMM>    ! the user is responsible for reading the current file last if they
 CHARMM>    ! want the NBFixes to apply. A more elegant solution would require new
 CHARMM>    ! features to be added to CHARMM.
 CHARMM>    ! parallel fix, to avoid duplicated messages in the log
 CHARMM>    set para
 Parameter: PARA <- "" <empty>
  
 CHARMM>    if ?NUMNODE gt 1 set para node 0
 RDCMND substituted energy or value "?NUMNODE" to "1"
 Comparing "1" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set wrn ?WRNLEV
 RDCMND substituted energy or value "?WRNLEV" to "5"
 Parameter: WRN <- "5"
  
 CHARMM>    ! Some versions of CHARMM don't seem to initialize wrnlev...
 CHARMM>    if "@WRN" eq "?WRNLEV" set wrn 5
 Parameter: WRN -> "5"
 RDCMND: can not substitute energy "?WRNLEV""
 Comparing ""5"" and ""?WRNLEV"".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    set bom ?bomlev
 RDCMND substituted energy or value "?BOMLEV" to "0"
 Parameter: BOM <- "0"
  
 CHARMM>    WRNLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    BOMLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NBFIX BETWEEN CARBOXYLATE AND SODIUM
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    BOMLEV @bom @PARA
 Parameter: BOM -> "0"
 Parameter: PARA -> "" <empty>
  
 CHARMM>    WRNLEV @wrn @PARA
 Parameter: WRN -> "5"
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_dum_noble_gases.str
 VOPEN> Attempting to open::toppar/toppar_dum_noble_gases.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_dum_noble_gases.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_dum_nobel_gases.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous	toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "472"
 Parameter: NAT <- "472"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "472"
 Parameter: NAT -> "472"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""472"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "472" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_ions_won.str
 VOPEN> Attempting to open::toppar/toppar_ions_won.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_ions_won.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOP_IONS_WON.STR: GENERAL MODEL FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !This is a comprehensive set of ions developed using stochastic boundary
 CHARMM>    !conditions. It is strongly recommended that ion parameters in
 CHARMM>    !toppar_water_ions.str be used if available, as they are more highly
 CHARMM>    !optimized.  Accordingly, those ions have been commented in this
 CHARMM>    !file.
 CHARMM>    !
 CHARMM>    !reference
 CHARMM>    !Won, Y., "Force Field for Monovalent, Divalent, and Trivalent Cations
 CHARMM>    !Developed under the Solvent Boundary Potential," Journal of Physical
 CHARMM>    !Chemistry A., 116: 11763-11767, 2012.
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "475"
 Parameter: NAT <- "475"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "475"
 Parameter: NAT -> "475"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""475"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "475" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PAR_CATION.PRM FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for protein
 CHARMM>    stream toppar/toppar_all36_prot_arg0.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_arg0.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_prot_arg0.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>> ALL-HYDROGEN TOPOLOGY FOR NEUTRAL ARG <<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> 2007 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Atom names include "R" (for Arg) as the second letter. The
 CHARMM>    ! only other atom types in the additive FF with this second
 CHARMM>    ! letter are histidine [HN]R[123] in the protein FF and CRL[12]
 CHARMM>    ! in toppar_all36_lipid_cholesterol.str , so no more conflicts.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.rtf
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_arg0.inp
 CHARMM>     
  
 CHARMM>    !Li, L., Vorobyov, I.V., MacKerell, Jr., A.D., Allen, T.W., "Is
 CHARMM>    !arginine charged in a membrane?" Biophysical Journal, 94: L11-L13,
 CHARMM>    !2008, PMCID: PMC2157258
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MGU1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU1          0.00
*** WARNING **** residue MGU2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU2          0.00
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_c36m_d_aminoacids.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_c36m_d_aminoacids.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_prot_c36m_d_aminoacids.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>>CHARMM36 ALL-HYDROGEN TOPPAR FILE FOR D-PROTEINS <<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 RDTITL> *             PARAMETER SET DISCUSSION FORUM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !update 2016/2. use directly inverted CMAPs
 CHARMM>     
  
 CHARMM>    !toppar stream file for D-amino acids. Includes new residue
 CHARMM>    !names, inverted CMAP and additional parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36m_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_d_amino_acid.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "539"
 Parameter: NAT <- "539"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "539"
 Parameter: NAT -> "539"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""539"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "539" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR D- AMINOACIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR D- AMINOACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_fluoro_alkanes.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_fluoro_alkanes.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_prot_fluoro_alkanes.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR FLUORINATED ALKANES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !These parameters are maintained for historic reasons.  The CGenFF
 CHARMM>    !halogen parameters are a significant improvement over these
 CHARMM>    !parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_fluoro_alkanes.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Chen, I.-J., Yin, D. and MacKerell, Jr., A.D., "Combined Ab
 CHARMM>    !initio/Empirical Approach for Optimization of Lennard-Jones Parameters
 CHARMM>    !for Polar-Neutral Compounds," Journal of Computational Chemistry,
 CHARMM>    !2002, 23:199-213.
 CHARMM>    !
 CHARMM>    !Note that these parameters are higly optimized to reproduce the
 CHARMM>    !corresponding condensed phase properties and have not been incorporated
 CHARMM>    !into the CHARMM22 or CHARMM27 biomolecular force fields
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR FLUOROALKANES
 RDTITL> *
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA  0.0
*** WARNING **** residue FETH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FETH  0.0
*** WARNING **** residue DFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DFET 0.0
*** WARNING **** residue TFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFET  0.0
*** WARNING **** residue TFE  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFE   0.0
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * FLUOROALKANE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_heme.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_heme.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_prot_heme.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR HEME AND RELATED
 RDTITL> * LIGANDS AND PATCHES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !updated 2016/2, allow for use of AUTOGENERATE ANGLE DIHEDRAl PATCH
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_heme.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HEME AND RELATED COMPOUNDS AND PATCHES
 RDTITL> *
*** WARNING **** residue CO2  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO2             0.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR HEME
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_na_combined.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_na_combined.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_prot_na_combined.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR PATCHES TO CREATE
 RDTITL> * MODEL COMPOUNDS AND PATCHES THAT REQUIRE BOTH PROTEIN AND
 RDTITL> * NUCLEIC ACID TOPOLOGY AND PARAMETER INFORMATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>    !stream/toppar_all36_prot_fluoro_alkanes.str ! atom types an parameters for fluorinated compounds
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_na_combined.inp
 CHARMM>     
  
 CHARMM>    !all patches must be followed by AUTOGENERATE ANGLES DIHEDRALS
 CHARMM>     
  
 CHARMM>    !PHOSPHOTYROSINE
 CHARMM>    !
 CHARMM>    !Feng, M.-H., Philippopoulos, M., MacKerell, Jr., A.D. and Lim, C.
 CHARMM>    !Structural Characterization of the Phosphotyrosine Binding Region of a
 CHARMM>    !High-Affinity aSH2 Domain-Phosphopeptide Complex by Molecular Dynamics
 CHARMM>    !Simulation and Chemical Shift Calculations. Journal of the American
 CHARMM>    !Chemical Society, 1996, 118: 11265-11277.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
*** WARNING **** residue THFI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFI       0.00
*** WARNING **** residue THMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THMI       0.00
*** WARNING **** residue THFA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFA        0.00
*** WARNING **** residue THAO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THAO         0.00
*** WARNING **** residue RNUS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RNUS         0.00
*** WARNING **** residue NUCL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NUCL        -1.00
*** WARNING **** residue PPH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPH1      -1.00
*** WARNING **** residue BMPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPH      -1.00
*** WARNING **** residue BMPD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPD      -2.00
*** WARNING **** residue BDFP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFP      -1.00
*** WARNING **** residue BDFD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFD -2.00
*** WARNING **** residue EP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EP_2        -2.00
*** WARNING **** residue IP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IP_2        -2.00
 There were  13 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_retinol.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_retinol.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_prot_retinol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR RETINOL AND RETINAL PARAMETERS
 RDTITL> * A. LOCCISANO, A.M.W., J. EVANSECK AND A.D. MACKERELL, JR.
 RDTITL> * APRIL, 2005
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !use with c36 protein force fields
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * RETINAL/RETINOL AND RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue 13DB already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DB       0.00
*** WARNING **** residue 13DP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DP       0.00
*** WARNING **** residue DMB1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMB1       0.00
*** WARNING **** residue DMP1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP1       0.00
*** WARNING **** residue DMP2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP2       0.00
*** WARNING **** residue CROT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CROT       0.00
*** WARNING **** residue PACP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PACP       0.00
*** WARNING **** residue MECH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MECH       0.00
*** WARNING **** residue TMCH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TMCH       0.00
*** WARNING **** residue FRET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FRET       0.00
*** WARNING **** residue RTOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTOL       0.00
*** WARNING **** residue RTAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAL       0.00
*** WARNING **** residue RTAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAC      -1.00
*** WARNING **** residue PRAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAC      -1.00
*** WARNING **** residue PROL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROL       0.00
*** WARNING **** residue PRAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAL       0.00
*** WARNING **** residue SCH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH1       0.00
*** WARNING **** residue SCH2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH2       1.00
*** WARNING **** residue SCH3 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH3       1.00
 There were  20 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * RETINAL/RETINOL AND RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_model.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_prot_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>> ALL-HYDROGEN TOPOLOGY FOR SMALL MODEL COMPOUNDS USED IN THE <<
 RDTITL> *>> DEVELOPMENT OF THE CHARMM22 PROTEIN ALL-HYDROGEN PARAMETERS <<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> JULY 1997 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *CONVERTED TO STREAM FORMAT, DECEMBER 2003
 RDTITL> *CONVERTED TO CHARMM36 PROTEIN ATOM TYPES, MAY 2011
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_model.inp
 CHARMM>     
  
 CHARMM>    !changes after 9/98
 CHARMM>    !
 CHARMM>    !change alkene HA1 and HA2 to HE1 and HE2
 CHARMM>    !
 CHARMM>    !improper atom ordering corrected
 CHARMM>    !
 CHARMM>    !version b5i to be consistent with protein toppar files
 CHARMM>    !
 CHARMM>    !Heme vinyl groups upgraded based on new butene parameters
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    ! references
 CHARMM>    !
 CHARMM>    !PROTEINS
 CHARMM>    !
 CHARMM>    !MacKerell, Jr., A. D.; Bashford, D.; Bellott, M.; Dunbrack Jr., R.L.;
 CHARMM>    !Evanseck, J.D.; Field, M.J.; Fischer, S.; Gao, J.; Guo, H.; Ha, S.;
 CHARMM>    !Joseph-McCarthy, D.; Kuchnir, L.; Kuczera, K.; Lau, F.T.K.; Mattos,
 CHARMM>    !C.; Michnick, S.; Ngo, T.; Nguyen, D.T.; Prodhom, B.; Reiher, III,
 CHARMM>    !W.E.; Roux, B.; Schlenkrich, M.; Smith, J.C.; Stote, R.; Straub, J.;
 CHARMM>    !Watanabe, M.; Wiorkiewicz-Kuczera, J.; Yin, D.; Karplus, M.  All-atom
 CHARMM>    !empirical potential for molecular modeling and dynamics Studies of
 CHARMM>    !proteins.  Journal of Physical Chemistry B, 1998, 102, 3586-3616.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue ACET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACET       -1.00
*** WARNING **** residue PROA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROA       -1.00
*** WARNING **** residue GUAN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GUAN        1.00
*** WARNING **** residue MGUA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGUA        1.00
*** WARNING **** residue GLYN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYN         0.00
*** WARNING **** residue MAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAMM        1.00
*** WARNING **** residue EAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EAMM        1.00
*** WARNING **** residue ACEH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEH        0.00
*** WARNING **** residue MEOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MEOH        0.00
*** WARNING **** residue METO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI METO       -1.00
*** WARNING **** residue ETOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETOH        0.00
*** WARNING **** residue ETO  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETO        -1.00
*** WARNING **** residue PRO2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRO2        0.00
*** WARNING **** residue FORM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FORM        0.00
*** WARNING **** residue ACEM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEM        0.00
*** WARNING **** residue NMA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NMA         0.00
*** WARNING **** residue MESH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MESH        0.00
*** WARNING **** residue MES1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MES1       -1.00
*** WARNING **** residue ETSH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETSH        0.00
*** WARNING **** residue ES1  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ES1        -1.00
*** WARNING **** residue DMDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMDS        0.00
*** WARNING **** residue DEDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DEDS        0.00
*** WARNING **** residue EMS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EMS         0.00
*** WARNING **** residue IMIA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIA        0.00
*** WARNING **** residue MIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MIMI        0.00
*** WARNING **** residue EIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMI        0.00
*** WARNING **** residue IMIM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIM        1.00
*** WARNING **** residue EIMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMM        1.00
*** WARNING **** residue BENZ already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BENZ        0.00
*** WARNING **** residue EBEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EBEN         0.00
*** WARNING **** residue PHEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEN        0.00
*** WARNING **** residue EPHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EPHE        0.00
*** WARNING **** residue PHEO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEO       -1.00
*** WARNING **** residue INDO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI INDO        0.00
*** WARNING **** residue EIND already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIND        0.00
*** WARNING **** residue PDIP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PDIP        0.00
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA        0.00
*** WARNING **** residue PRPA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPA        0.00
*** WARNING **** residue IBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IBUT        0.00
*** WARNING **** residue OCOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI OCOH    0.0
*** WARNING **** residue CO3  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO3  -2.0
*** WARNING **** residue C3   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI C3    0.00
 There were  42 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_modify_res.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_modify_res.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_prot_modify_res.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR FILE FOR VARIOUS MODIFIED RESIDUES AND PATCHES, INCLUDING
 RDTITL> * PATCHES TO COVALENTLY LINK RESIDUES TO IONS TO WORK WITH THE
 RDTITL> * ADDITIVE C36 PROTEIN FORCE FIELD
 RDTITL> * REQUIRES CGENFF PARAMETER FILE
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Acetyllysine (ALY)
 CHARMM>    !Norleucine (NLE) and
 CHARMM>    ! residues and patches for Zn-protein interactions modeled using
 CHARMM>    ! bond and angles between the protein and Zn.
 CHARMM>     
  
 CHARMM>    !non-standard amino acids: 2021
 CHARMM>    !Croitoru, A., Park, S.-J., Kumar, A., Lee, J., Im, Wonpil; MacKerell,
 CHARMM>    !A.D., Jr., and Aleksandrov, A. Additive CHARMM36 Force Field for
 CHARMM>    !Nonstandard Amino Acids, Journal of Chemical Theory and Computation,
 CHARMM>    !17:3554-3570, doi: 10.1021/acs.jctc.1c00254.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPPAR FILE PROTEIN MODIFICATIONS
 RDTITL> *
*** WARNING **** residue CGU  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGU              -2.000
*** WARNING **** residue CME  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CME               0.000
*** WARNING **** residue HIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HIC               0.000
*** WARNING **** residue HICP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HICP              1.000
*** WARNING **** residue CGUP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGUP             -1.000
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for nucleic acids
 CHARMM>    stream toppar/toppar_all36_na_nad_ppi.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_nad_ppi.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_na_nad_ppi.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN NUCLEIC ACID FORCE TOPPAR STREAM FILE
 RDTITL> * NAD+, NADH, ADP, ATP, PPI AND RELATED ANALOGS
 RDTITL> * A.D. MACKERELL, JR., JULY 2001
 RDTITL> * STREAM FOLLOWING RTF AND PARAM READ OF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Update, 2015/1, nomenclature for NAD+ etc. consistent with PDB
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_na_nad_ppi.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Pavelites, J.J., Bash, P.A., Gao, J., and MacKerell, Jr.,
 CHARMM>    !A.D. A Molecular Mechanics Force Field for NAD+, NADH and the
 CHARMM>    !Pyrophosphate Groups of Nucleotides, Journal of Computational
 CHARMM>    !Chemistry, 1997, 18: 221-239.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * NAD, PPI TOPOLOGY
 RDTITL> *
*** WARNING **** residue NIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NIC         1.00
*** WARNING **** residue NICH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NICH         0.00
*** WARNING **** residue PPI1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI1        -3.00
*** WARNING **** residue PPI2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI2        -2.00
*** WARNING **** residue AMP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI AMP         -2.00
*** WARNING **** residue ADP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ADP         -3.00
*** WARNING **** residue ATP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ATP         -4.00
*** WARNING **** residue 5DP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES 5DP         -3.00
*** WARNING **** residue NAD  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NAD         -1.00
*** WARNING **** residue NADH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADH        -2.00
*** WARNING **** residue NADP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADP        -2.00
*** WARNING **** residue NDPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NDPH        -3.00
 There were  12 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NAD, PPI PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_na_rna_modified.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_rna_modified.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_na_rna_modified.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIVE CHARMM FORCE FIELD FOR MODIFIED RIBONUCLEIC ACIDS, INCLUDING
 RDTITL> * THOSE FOUNDS IN TRNA. YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> * |
 RDTITL> * WARNING: PARAMETERS AND ATOM TYPE ASSIGNMENTS IN THIS FILE ARE SPECIFIC
 RDTITL> * FOR THESE COMPOUNDS AND SHOULD UNDER NO CIRCUMSTANCES BE APPLIED TO
 RDTITL> * OTHER ORGANIC MOLECULES
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Xu, Y., Vanommeslaeghe, K., Aleksandrov, A., MacKerell, A.D.,
 CHARMM>    ! Jr. Nilsson, L., Additive CHARMM force field for naturally
 CHARMM>    ! occurring modified ribonucleotides, Journal of Computational
 CHARMM>    !  Chemistry, DOI: 10.1002/jcc.24307, 2016
 CHARMM>     
  
 CHARMM>    ! Should be used with parent files CGenFF: top_all36_cgenff.inp and par_all36_cgenff.inp
 CHARMM>    !                                    NA36: top_all36_na.inp and par_all36_na.inp
 CHARMM>    !                              and Carb36: top_all36_carb.inp and par_all36_carb.inp
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES OF MODIFIED NUCLEOTIDES
 RDTITL> *
*** WARNING **** residue BUG  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUG           -1.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIVE CHARMM PARAMETERS FOR MODIFIED NUCLEIC ACIDS, BETA VERSION
 RDTITL> * YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for lipids
 CHARMM>    stream toppar/toppar_all36_lipid_sphingo.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_sphingo.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_sphingo.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FOR CERAMIDES AND SPINGOMYELINS; REQUIRES FLEX FORMAT FILES
 RDTITL> * TOP_ALL36_LIPID.RTF AND PAR_ALL36_LIPID.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! PSM and SSM Lipids
 CHARMM>    !
 CHARMM>    ! Venable, R. M.; Sodt, A. J.; Rogaski, B.; Rui, H.; Hatcher, E.; MacKerell, A. D.;
 CHARMM>    ! Pastor, R. W.; Klauda, J. B., CHARMM All-Atom Additive Force Field for Sphingomyelin:
 CHARMM>    ! Elucidation of Hydrogen Bonding and of Positive Curvature. Biophys. J. 2014, 107 (1), 134-145
 CHARMM>    !
 CHARMM>    ! Ceramide
 CHARMM>    !
 CHARMM>    ! Submited by Sam Tonddast-Navaei of U. Cincinnati. Advised by Russell Devane
 CHARMM>    ! Tested by Eric Wang of U. Maryland. Advised by Jeffery Klauda
 CHARMM>    !
 CHARMM>    !
 CHARMM>    ! CerAP/Cer6, CerNP/Cer3, and CerEOS/Cer1
 CHARMM>    !
 CHARMM>    ! Wang, E.; Klauda, J. B., Structure and Permeability of Ceramide Bilayers and Multilayers.
 CHARMM>    ! J. Phys. Chem. B., 2019, 123, 11, 2525-2535
 CHARMM>    ! Wang, E.; Klauda, J. B., Molecular Structure of the Long Periodicity Phase in the Stratum Corneum.
 CHARMM>    ! J. Amer. Chem. Soc., 2019. 141, 42, 16930-16943
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "570"
 Parameter: NAT <- "570"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "570"
 Parameter: NAT -> "570"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""570"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "570" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CER/SM RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated DIHE parameter ( 14695): NHL   C     CTO1  HAL1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 14716): O     C     CTO1  HAL1 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_archaeal.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_archaeal.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_archaeal.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR ARCHAEAL LIPIDS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! This is an on-going file of archaeal lipids
 CHARMM>    ! I am adding meanquinone-7 now
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * ARCHAEAL LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY CGENFF
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_bacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_bacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_bacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! Branched Lipids
 CHARMM>    !
 CHARMM>    ! Lim, J.B. & Klauda, J.B. Branching at the Iso- and Anteiso- Positions in Complex Chlamydia
 CHARMM>    ! Membranes: A Molecular Dynamics Study. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1808:323-331 (2011).
 CHARMM>    !
 CHARMM>    ! Cyclic-replacement of double bond
 CHARMM>    !
 CHARMM>    ! Pandit, K.R. & Klauda, J.B. Membrane models of E. coli containing cyclic moieties in
 CHARMM>    ! the aliphatic lipid chain. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1818:1205-1210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "575"
 Parameter: NAT <- "575"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "575"
 Parameter: NAT -> "575"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""575"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "575" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cardiolipin.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cardiolipin.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_cardiolipin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL>  
 RDTITL> No title read.
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cholesterol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cholesterol.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_cholesterol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR CHOLESTEROL.  STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> * TOP_ALL36_CGENFF.RTF
 RDTITL> * AND PAR_ALL36_CGENFF.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !topology and parameters are included for two cholesterol models. the
 CHARMM>    !model may be selected by setting variable chol_model to 1 or 2, as
 CHARMM>    !specified below
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set chol_model 1 !2 for original Suits et al. model
 Parameter: CHOL_MODEL <- "1"
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    !1) Revised model of Lim et al.  This contains a number of NBFIXes that
 CHARMM>    !makes it unsuitable for ANTON (set chol_model 1)
 CHARMM>    !
 CHARMM>    !2) Original model of Suits et al., which is used on ANTON as well as
 CHARMM>    !being suitable for other systems (set chol_model 2 (or anything but 1....))
 CHARMM>    !
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    !Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>    !Suits, F., Pitman, M., MacKerell, A.D., Jr., Feller, S.E. "Molecular Level
 CHARMM>    !Organization of Saturated and Polyunsaturated Fatty Acids in a
 CHARMM>    !Phosphatidylcholine Bilayer Containing Cholesterol" Biochemistry,
 CHARMM>    !43(49):15318-28, 2004
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    !test "append"
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "575"
 Parameter: NAT <- "575"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "575"
 Parameter: NAT -> "575"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""575"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "575" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    if chol_model eq 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>    ! reference
 CHARMM>    ! Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    ! Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR CHOLESTEROL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CHOLESTEROL PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_dag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_dag.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_dag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM DAG
 RDTITL> *
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_inositol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_inositol.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_inositol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR INOSITOL-BASED LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lnp.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lnp.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_lnp.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LNP
 RDTITL> *
 WARNING from DECODF -- Zero length string being converted to 0.
 **** WARNING from RTFRDR **** The total charge of the residue, DAGP,  -0.0100000,
 does not equal the expected charge,   0.0000000.
 WARNING from DECODF -- Zero length string being converted to 0.
          PRES DPEPEG
 **** WARNING from RTFRDR **** The total charge of the residue, DPEP,  -0.0100000,
 does not equal the expected charge,   0.0000000.
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * LNP
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lps.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lps.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_lps.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM LPS
 RDTITL> *
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read param card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_mycobacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_mycobacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_mycobacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR INOSITOL-BASED LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * MYCOBACTERIAL (ACPIM2) RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_miscellaneous.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_miscellaneous.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_miscellaneous.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR MISCELLANEOUS LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETER FOR ACYL PYROPHOSPHATE: ADDED 2019_7
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_model.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN LIPID FORCE FIELD TOPPAR STREAM FILE
 RDTITL> * COLLECTION OF RESIDUES AND PATCHES FOR MODEL COMPOUNDS USED
 RDTITL> * IN THE OPTIMIZATION THE LIPID FORCE FIELD.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_lipid_model.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 LIPID MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MAS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAS          0.00
*** WARNING **** residue ETAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAC         0.00
*** WARNING **** residue MPRO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MPRO         0.00
*** WARNING **** residue MP_1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_1        -1.00
*** WARNING **** residue MP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_2        -2.00
*** WARNING **** residue MSO4 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MSO4        -1.00
*** WARNING **** residue BUTA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUTA         0.00
*** WARNING **** residue PENT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PENT         0.00
*** WARNING **** residue HEXA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HEXA         0.00
*** WARNING **** residue ETHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHE       0.00
*** WARNING **** residue PRPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPE       0.00
*** WARNING **** residue BTE1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE1       0.00
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue DIPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIPE       0.00
*** WARNING **** residue DIHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIHE       0.00
*** WARNING **** residue NC4  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC4          1.00
*** WARNING **** residue NC5  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC5          1.00
*** WARNING **** residue CHOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CHOL         1.00
*** WARNING **** residue ACHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACHO         1.00
*** WARNING **** residue PC   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PC           0.00
*** WARNING **** residue GPC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GPC          0.00
*** WARNING **** residue TEA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TEA          1.00
*** WARNING **** residue ETAM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAM       1.00
*** WARNING **** residue GLYC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYC         0.00
*** WARNING **** residue MBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MBUT         0.00
 There were  25 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_prot.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_prot.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_prot.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR LIPID TAIL LINKERS TO CYSTEINE AND GLYCINE,
 RDTITL> * FOR EXAMPLE, PALMITOYLATION, MARISTOYLATION, FERNASYLATION, GERANYLATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LIPID-MODIFIED PROTEIN RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CYSTEIN-PALMITATE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_tag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_tag.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_tag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TRIACYLGLYCEROLS [STEPHEN GEE FROM LEHIGH UNIVERSITY]
 RDTITL> *
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_yeast.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_yeast.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_yeast.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "575"
 Parameter: NAT <- "575"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "575"
 Parameter: NAT -> "575"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""575"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "575" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_hmmm.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_hmmm.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_hmmm.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TERMINAL PATCHES FOR HMMM TRUNCATED LIPIDS
 RDTITL> *
 WARNING from DECODF -- Zero length string being converted to 0.
 WARNING from DECODF -- Zero length string being converted to 0.
 WARNING from DECODF -- Zero length string being converted to 0.
 WARNING from DECODF -- Zero length string being converted to 0.
 WARNING from DECODF -- Zero length string being converted to 0.
 WARNING from DECODF -- Zero length string being converted to 0.
 WARNING from DECODF -- Zero length string being converted to 0.
 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_detergent.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_detergent.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_detergent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR DETERGENTS AND FATTY ACIDS.
 RDTITL> * STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Additional residues added by Im lab, Aug. 2017
 CHARMM>     
  
 CHARMM>    !Fatty acids added Jan. 2016
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * DETERGENT AND FATTY ACID RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SB3-12 AND SB3-14 PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_ether.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_ether.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_lipid_ether.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN ETHER LIPID FORCE FIELD INCLUDING PLASMALOGENS ALISON
 RDTITL> * N. LEONARD (A. L.), 7/18 WITH RICHARD PASTOR AND JEFFERY KLAUDA, JPCB 122(26)
 RDTITL> * PP. 6744 - 6754.  ANA WEST, 1/20 WITH VALERIA ZONI, WALTER TEAGUE JR., ALISON
 RDTITL> * LEONARD, STEFANO VANNI, KLAUS GAWRISCH, STEPHANIE TRISTAM-NAGLE, JONATHAN
 RDTITL> * SACHS, AND JEFFERY KLAUDA, JPCB 124(5) PP. 828 - 839.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>    !top_all36_cgenff.rtf
 CHARMM>    !par_all36_cgenff.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 ETHER MODEL COMPOUNDS
 RDTITL> *
 WARNING from DECODF -- Zero length string being converted to 0.
 WARNING from DECODF -- Zero length string being converted to 0.
 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for carbohydrates
 CHARMM>    stream toppar/toppar_all36_carb_glycolipid.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycolipid.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_carb_glycolipid.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOLIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PIP RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_glycopeptide.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycopeptide.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_carb_glycopeptide.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOPEPTIDE LINKAGES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_imlab.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_imlab.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_carb_imlab.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for spin/fluorophore labels
 CHARMM>    stream toppar/toppar_all36_label_spin.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_spin.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_label_spin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>> TOPOLOGY FOR NITROXYDE SPIN LABELS <<<<<<<
 RDTITL> * SHAHIDUL M. ISLAM, UNIVERSITY OF CHICAGO
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! please reference the following:
 CHARMM>    !Sezer, D., Freed J. H., and Roux, B. Parametrization, Molecular Dynamics Simulation, and Calculation of Electron Spin
 CHARMM>    !Resonance Spectra of a Nitroxide Spin Label on a Polyalanine alpha-Helix J. Phys. Chem. B 2008, 112, 5755-5767
 CHARMM>     
  
 CHARMM>    !Islam, S. M., and Roux, B. Parameterization and molecular dynamics simulations of a
 CHARMM>    !conformationally constrained double linked spin label constrained by EPR/DEER data
 CHARMM>    !(planed submission to J journal)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "575"
 Parameter: NAT <- "575"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "575"
 Parameter: NAT -> "575"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""575"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "575" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SPIN LABEL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR SPIN LABEL
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_label_fluorophore.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_fluorophore.str::
 OPNLGU> Unit 98 opened for READONLY access to /home/charmm-gui/data/www/4814588605/toppar/toppar_all36_label_fluorophore.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FILES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * MINI FORCE FIELD PARAMETER FILE.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>    ! solvent only? ()
 CHARMM>    ! this should not be here
 CHARMM>    ! Read PSF and Coordinates
 CHARMM>    open read unit 10 card name step1_nanomaterial.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step1_nanomaterial.psf::
 OPNLGU> Unit 10 opened for READONLY access to /home/charmm-gui/data/www/4814588605/step1_nanomaterial.psf
  
 CHARMM>    read psf  unit 10 card
 MAINIO> Protein structure file being read from unit  10.
 PSFRD2> Reading PSF in the expanded format.
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 24. 2022. JOB
 TITLE>  * ORIENT NANOTUBE'S PRINCIPAL AXIS ALONG USER'S CHOSEN PBC DIMENSION OR X
 TITLE>  *  DATE:     3/24/22     14:18:31      CREATED BY USER: apache
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =        1
         Number of atoms         =     2480   Number of groups     =     2480
         Number of bonds         =     3704   Number of angles     =     7384
         Number of dihedrals     =    14724   Number of impropers  =        0
         Number of cross-terms   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =    0.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step1_nanomaterial.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step1_nanomaterial.crd::
 OPNLGU> Unit 10 opened for READONLY access to /home/charmm-gui/data/www/4814588605/step1_nanomaterial.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 24. 2022. JOB
 TITLE> * ORIENT NANOTUBE'S PRINCIPAL AXIS ALONG USER'S CHOSEN PBC DIMENSION OR X
 TITLE> *  DATE:     3/24/22     14:18:32      CREATED BY USER: APACHE
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    stream step1.1_user_input.str
 VOPEN> Attempting to open::step1.1_user_input.str::
 OPNLGU> Unit 99 opened for READONLY access to /home/charmm-gui/data/www/4814588605/step1.1_user_input.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET PREFIX   = STEP1_NANOTUBE
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    set prefix   = step1_nanotube
 Parameter: PREFIX <- "STEP1_NANOTUBE"
  
 CHARMM>    set material = tube
 Parameter: MATERIAL <- "TUBE"
  
 CHARMM>    set pbc      = z
 Parameter: PBC <- "Z"
  
 CHARMM>    set rtube    = 4.362
 Parameter: RTUBE <- "4.362"
  
 CHARMM>    set ltube    = 237.353
 Parameter: LTUBE <- "237.353"
  
 CHARMM>    set imtube   = yes
 Parameter: IMTUBE <- "YES"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    stream step1_nanomaterial.str
 VOPEN> Attempting to open::step1_nanomaterial.str::
 OPNLGU> Unit 99 opened for READONLY access to /home/charmm-gui/data/www/4814588605/step1_nanomaterial.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET NCHARGE = 0
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET NCHARGE = 0
 Parameter: NCHARGE <- "0"
  
 CHARMM>     SET XMAX = 4.373
 Parameter: XMAX <- "4.373"
  
 CHARMM>     SET YMAX = 4.373
 Parameter: YMAX <- "4.373"
  
 CHARMM>     SET ZMAX = 118.697377
 Parameter: ZMAX <- "118.697377"
  
 CHARMM>     SET XMIN = -4.373
 Parameter: XMIN <- "-4.373"
  
 CHARMM>     SET YMIN = -4.373
 Parameter: YMIN <- "-4.373"
  
 CHARMM>     SET ZMIN = -118.697623
 Parameter: ZMIN <- "-118.697623"
  
 CHARMM>     SET XCEN = -1.86230959E-17
 Parameter: XCEN <- "-1.86230959E-17"
  
 CHARMM>     SET YCEN = 8.738529613E-17
 Parameter: YCEN <- "8.738529613E-17"
  
 CHARMM>     SET ZCEN = -3.227179097E-12
 Parameter: ZCEN <- "-3.227179097E-12"
  
 CHARMM>     SET BOXX = 8.746
 Parameter: BOXX <- "8.746"
  
 CHARMM>     SET BOXY = 8.746
 Parameter: BOXY <- "8.746"
  
 CHARMM>     SET BOXZ = 237.395
 Parameter: BOXZ <- "237.395"
  
 CHARMM>     SET ALPHA = 90
 Parameter: ALPHA <- "90"
  
 CHARMM>     SET BETA  = 90
 Parameter: BETA <- "90"
  
 CHARMM>     SET GAMMA = 90
 Parameter: GAMMA <- "90"
  
 CHARMM>     SET IMPATCH = YES
 Parameter: IMPATCH <- "YES"
  
 CHARMM>     SET BOXTYPE = RECT
 Parameter: BOXTYPE <- "RECT"
  
 CHARMM>     SET XTLTYPE = ORTHORHOMBIC
 Parameter: XTLTYPE <- "ORTHORHOMBIC"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    calc A = 38.746
Evaluating: 38.746
 Parameter: A <- "38.746"
  
 CHARMM>    calc B = 38.746
Evaluating: 38.746
 Parameter: B <- "38.746"
  
 CHARMM>    calc C = 237.395
Evaluating: 237.395
 Parameter: C <- "237.395"
  
 CHARMM>    set XTLtype = ORTHorhombic
 Parameter: XTLTYPE <- "ORTHORHOMBIC"
  
 CHARMM>    if A eq @B set XTLtype = TETRagonal
 Parameter: B -> "38.746"
 Comparing "38.746" and "38.746".
 IF test evaluated as true.  Performing command
 Parameter: XTLTYPE <- "TETRAGONAL"
  
 CHARMM>    if A eq @B if B eq @C set XTLtype = CUBIc
 Parameter: B -> "38.746"
 Parameter: C -> "237.395"
 Comparing "38.746" and "38.746".
 IF test evaluated as true.  Performing command
 Comparing "38.746" and "237.395".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    if impatch .ne. no then
 Comparing "YES" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>       crystal define @XTLtype @A @B @C @{alpha} @{beta} @{gamma}
 Parameter: XTLTYPE -> "TETRAGONAL"
 Parameter: A -> "38.746"
 Parameter: B -> "38.746"
 Parameter: C -> "237.395"
 Parameter: ALPHA -> "90"
 Parameter: BETA -> "90"
 Parameter: GAMMA -> "90"
 Crystal Parameters : Crystal Type = TETR
           A     =   38.74600 B    =   38.74600 C     =  237.39500
           Alpha =   90.00000 Beta =   90.00000 Gamma =   90.00000
  
 CHARMM>     
  
 CHARMM>       open unit 10 read card name crystal_image.str
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::crystal_image.str::
 OPNLGU> Unit 10 opened for READONLY access to /home/charmm-gui/data/www/4814588605/crystal_image.str
  
 CHARMM>       crystal read unit 10 card
 CRYSTAL FILE BEING READ FROM UNIT    10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 24. 2022. JOBID=4814588605
 TITLE> * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE> *
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 24. 2022. JOB
 TITLE>  * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE>  *
                     THERE ARE NO ROTATIONS FOR THIS TRANSFORMATION SET
    26 Transformations have been processed.

  
 CHARMM>       open read unit 10 card name cubic.img
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::cubic.img::
 OPNLGU> Unit 10 opened for READONLY access to /home/charmm-gui/data/www/4814588605/cubic.img
  
 CHARMM>       read imag unit 10
 TITLE> * IMAGE FILE FOR CUBIC TRANSFORMATION
 TITLE> * BOX SIZE IS 38.746 X 38.746 X 237.395 ANGSTROMS
 TITLE> *

             READING IMAGE FILE FROM UNIT   10


    26  TRANSFORMATIONS HAVE BEEN READ

                     THERE ARE NO ROTATIONS FOR THIS TRANSFORMATION SET
  
 CHARMM>       print images tran
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 24. 2022. JOB
 TITLE>  * GENERATES IONS
 TITLE>  *

 NUMBER OF TRANSFORMATIONS IS  26

 TRANSFORMATION   1  NAME:X         INVERSE   2
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                     38.746000  0.000000  0.000000

 TRANSFORMATION   2  NAME:A         INVERSE   1
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                    -38.746000  0.000000  0.000000

 TRANSFORMATION   3  NAME:XY        INVERSE   8
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                     38.746000 38.746000  0.000000

 TRANSFORMATION   4  NAME:Y         INVERSE   7
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                      0.000000 38.746000  0.000000

 TRANSFORMATION   5  NAME:AY        INVERSE   6
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                    -38.746000 38.746000  0.000000

 TRANSFORMATION   6  NAME:XB        INVERSE   5
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                     38.746000-38.746000  0.000000

 TRANSFORMATION   7  NAME:B         INVERSE   4
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                      0.000000-38.746000  0.000000

 TRANSFORMATION   8  NAME:AB        INVERSE   3
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                    -38.746000-38.746000  0.000000

 TRANSFORMATION   9  NAME:XZ        INVERSE  20
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                     38.746000  0.000000237.395000

 TRANSFORMATION  10  NAME:Z         INVERSE  19
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                      0.000000  0.000000237.395000

 TRANSFORMATION  11  NAME:AZ        INVERSE  18
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                    -38.746000  0.000000237.395000

 TRANSFORMATION  12  NAME:XYZ       INVERSE  26
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                     38.746000 38.746000237.395000

 TRANSFORMATION  13  NAME:YZ        INVERSE  25
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                      0.000000 38.746000237.395000

 TRANSFORMATION  14  NAME:AYZ       INVERSE  24
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                    -38.746000 38.746000237.395000

 TRANSFORMATION  15  NAME:XBZ       INVERSE  23
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                     38.746000-38.746000237.395000

 TRANSFORMATION  16  NAME:BZ        INVERSE  22
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                      0.000000-38.746000237.395000

 TRANSFORMATION  17  NAME:ABZ       INVERSE  21
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                    -38.746000-38.746000237.395000

 TRANSFORMATION  18  NAME:XC        INVERSE  11
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                     38.746000  0.000000**********

 TRANSFORMATION  19  NAME:C         INVERSE  10
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                      0.000000  0.000000**********

 TRANSFORMATION  20  NAME:AC        INVERSE   9
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                    -38.746000  0.000000**********

 TRANSFORMATION  21  NAME:XYC       INVERSE  17
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                     38.746000 38.746000**********

 TRANSFORMATION  22  NAME:YC        INVERSE  16
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                      0.000000 38.746000**********

 TRANSFORMATION  23  NAME:AYC       INVERSE  15
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                    -38.746000 38.746000**********

 TRANSFORMATION  24  NAME:XBC       INVERSE  14
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                     38.746000-38.746000**********

 TRANSFORMATION  25  NAME:BC        INVERSE  13
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                      0.000000-38.746000**********

 TRANSFORMATION  26  NAME:ABC       INVERSE  12
                      1.000000  0.000000  0.000000
                      0.000000  1.000000  0.000000
                      0.000000  0.000000  1.000000
                    -38.746000-38.746000**********
  
 CHARMM>       update imall

 <MKIMAT2>: updating the image atom lists and remapping
 Transformation   Atoms  Groups  Residues  Min-Distance
    1  X        has       0       0       0       30.00
    2  A        has       0       0       0       30.00
    3  XY       has       0       0       0       44.24
    4  Y        has       0       0       0       30.00
    5  AY       has       0       0       0       44.24
    6  XB       has       0       0       0       44.24
    7  B        has       0       0       0       30.00
    8  AB       has       0       0       0       44.24
    9  XZ       has       0       0       0       30.00
   10  Z        has     144     144       1        0.00
   11  AZ       has       0       0       0       30.00
   12  XYZ      has       0       0       0       44.32
   13  YZ       has       0       0       0       30.04
   14  AYZ      has       0       0       0       44.30
   15  XBZ      has       0       0       0       44.30
   16  BZ       has       0       0       0       30.04
   17  ABZ      has       0       0       0       44.32
   18  XC       has       0       0       0       30.14
   19  C        has     144     144       1        0.00
   20  AC       has       0       0       0       30.14
   21  XYC      has       0       0       0       44.25
   22  YC       has       0       0       0       30.04
   23  AYC      has       0       0       0       44.25
   24  XBC      has       0       0       0       44.25
   25  BC       has       0       0       0       30.04
   26  ABC      has       0       0       0       44.25
 Total of 2768 atoms and 2768 groups and    3 residues were included


 NONBOND OPTION FLAGS: 
     ELEC     VDW      ATOMs    CDIElec  FSHIft   VATOm    VFSWIt  
     BYGRoup  NOEXtnd  NOEWald 
 CUTNB  = 14.000 CTEXNB =999.000 CTONNB = 10.000 CTOFNB = 12.000
 CGONNB =  0.000 CGOFNB = 10.000
 WMIN   =  1.500 WRNMXD =  0.500 E14FAC =  1.000 EPS    =  1.000
 NBXMOD =      5
 There are        0 atom  pairs and        0 atom  exclusions.
 There are        0 group pairs and        0 group exclusions.
 <MAKINB>: Ran out of space. RESIZING
 <MAKINB> with mode   5 found  11088 exclusions and  11052 interactions(1-4)
 <MAKGRP> found  22140 group exclusions.
 <MAKGRP> found      0 image group exclusions.
 Generating nonbond list with Exclusion mode = 5
 == PRIMARY == SPACE FOR   712632 ATOM PAIRS AND        0 GROUP PAIRS

 General atom nonbond list generation found:
   302938 ATOM PAIRS WERE FOUND FOR ATOM LIST
        0 GROUP PAIRS REQUIRED ATOM SEARCHES

 SPACE FOR    37634 ATOM PAIRS AND        0 GROUP PAIRS

 Image nonbond list generation found:
     8772 ATOM PAIRS WERE FOUND FOR ATOM LIST
        0 ATOM PAIRS WERE FOUND FOR ATOM SELF LIST
        0 GROUP PAIRS REQUIRED ATOM SEARCHES

  
 CHARMM>       open read card unit 10 name image.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::image.psf::
 OPNLGU> Unit 10 opened for READONLY access to /home/charmm-gui/data/www/4814588605/image.psf
  
 CHARMM>       read image psf unit 10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 24. 2022. JOB
 TITLE> * ORIENT NANOTUBE'S PRINCIPAL AXIS ALONG USER'S CHOSEN PBC DIMENSION OR X
 TITLE> *  DATE:     3/24/22     14:18:31      CREATED BY USER: APACHE
 TITLE> *
        26        16        56       156         0         0        16
 <IMAUTGEN>:    0 duplicate image bonds deleted
 <IMAUTGEN>:    8 duplicate image angles deleted
 <IMAUTGEN>:   36 duplicate image dihedrals deleted
 <IMAUTGEN>:    0 duplicate image exclusions deleted
          CURRENT IMAGE INTERNAL COORDINATE COUNTS:
          NATOM   NBOND  NTHETA   NPHI   NIMPHI    NCRT   NEXCL
            288      16      56     156       0       0      16
  
 CHARMM>    endif
  
 CHARMM>     
  
 CHARMM>    define PROT sele all end
 SELRPN>   2480 atoms have been selected out of   2480
  
 CHARMM>     
  
 CHARMM>    ! protein volume, calculation with a grid spacing of 0.5
 CHARMM>    coor stat
 STATISTICS FOR      2480 SELECTED ATOMS:
    XMIN =   -4.373000 XMAX =    4.373000 XAVE =   -0.000000
    YMIN =   -4.373000 YMAX =    4.373000 YAVE =    0.000000
    ZMIN = -118.697623 ZMAX =  118.697377 ZAVE =   -0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>     
  
 CHARMM>    open write unit 10 card name step2.2_ions_orient.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step2.2_ions_orient.crd::
 OPNLGU> Unit 10 opened for WRITE access to /home/charmm-gui/data/www/4814588605/step2.2_ions_orient.crd
  
 CHARMM>    write coor unit 10 card
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   10 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    calc dcel = 0.5
Evaluating: 0.5
 Parameter: DCEL <- "0.5"
  
 CHARMM>    calc xdim = int ( ( ?xmax - ?xmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?XMAX" to "4.373"
 RDCMND substituted energy or value "?XMIN" to "-4.373"
Evaluating: INT((4.373--4.373+5.0)/0.5)+1
 Parameter: XDIM <- "28"
  
 CHARMM>    calc ydim = int ( ( ?ymax - ?ymin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?YMAX" to "4.373"
 RDCMND substituted energy or value "?YMIN" to "-4.373"
Evaluating: INT((4.373--4.373+5.0)/0.5)+1
 Parameter: YDIM <- "28"
  
 CHARMM>    calc zdim = int ( ( ?zmax - ?zmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?ZMAX" to "118.697377"
 RDCMND substituted energy or value "?ZMIN" to "-118.697623"
Evaluating: INT((118.697377--118.697623+5.0)/0.5)+1
 Parameter: ZDIM <- "485"
  
 CHARMM>    calc space = @xdim * @ydim * @zdim
 Parameter: XDIM -> "28"
 Parameter: YDIM -> "28"
 Parameter: ZDIM -> "485"
Evaluating: 28*28*485
 Parameter: SPACE <- "380240"
  
 CHARMM>     
  
 CHARMM>    scalar wmain = radius
  
 CHARMM>    scalar wmain add 1.4    ! use solvent accessible surface for molecular volume
  
 CHARMM>    scalar 1 = wmain
  
 CHARMM>    scalar 2 set 6.0
  
 CHARMM>    coor volume hole space @space sele .not. resname TIP3 end
 Parameter: SPACE -> "380240"
 SELRPN>   2480 atoms have been selected out of   2480
 COMPUTING VOLUME PER ATOM WITH:
   XMIN=     -7.7654 XMAX=      7.7654 NX=  28
   YMIN=     -7.7654 YMAX=      7.7654 NY=  28
   ZMIN=   -122.0900 ZMAX=    122.0898 NZ= 454


 A TOTAL OF        0   VACUUM POINTS WERE FOUND
 A TOTAL OF   266016 OCCUPIED POINTS WERE FOUND
 A TOTAL OF    89920 EXTERNAL POINTS WERE FOUND
 A TOTAL OF   355936 SELECTED POINTS WERE FOUND
 TOTAL OCCUPIED  VOLUME =   44018.296463
 TOTAL SELECTED  VOLUME =   58897.571462
 TOTAL FREE      VOLUME =       0.000000
 FRACTIONAL FREE VOLUME =       0.000000
  
 CHARMM>     
  
 CHARMM>    set molvol = ?volume
 RDCMND substituted energy or value "?VOLUME" to "44018.2965"
 Parameter: MOLVOL <- "44018.2965"
  
 CHARMM>     
  
 CHARMM>    ! system volume from parameters for water box
 CHARMM>    stream step2.1_waterbox.prm
 VOPEN> Attempting to open::step2.1_waterbox.prm::
 OPNLGU> Unit 99 opened for READONLY access to /home/charmm-gui/data/www/4814588605/step2.1_waterbox.prm

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET BOXTYPE  = RECT
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET BOXTYPE  = RECT
 Parameter: BOXTYPE <- "RECT"
  
 CHARMM>     SET XTLTYPE  = TETRAGONAL
 Parameter: XTLTYPE <- "TETRAGONAL"
  
 CHARMM>     SET A = 39
 Parameter: A <- "39"
  
 CHARMM>     SET B = 39
 Parameter: B <- "39"
  
 CHARMM>     SET C = 237.395
 Parameter: C <- "237.395"
  
 CHARMM>     SET ALPHA = 90.0
 Parameter: ALPHA <- "90.0"
  
 CHARMM>     SET BETA  = 90.0
 Parameter: BETA <- "90.0"
  
 CHARMM>     SET GAMMA = 90.0
 Parameter: GAMMA <- "90.0"
  
 CHARMM>     SET XCEN = 0
 Parameter: XCEN <- "0"
  
 CHARMM>     SET YCEN = 0
 Parameter: YCEN <- "0"
  
 CHARMM>     SET ZCEN = 0
 Parameter: ZCEN <- "0"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>    if @XTLtype .eq. TETRagonal   calc sysvol = @A * @B * @C
 Parameter: XTLTYPE -> "TETRAGONAL"
 Parameter: A -> "39"
 Parameter: B -> "39"
 Parameter: C -> "237.395"
 Comparing "TETRAGONAL" and "TETRAGONAL".
 IF test evaluated as true.  Performing command
Evaluating: 39*39*237.395
 Parameter: SYSVOL <- "361077.795"
  
 CHARMM>    if @XTLtype .eq. CUBIc        calc sysvol = @A * @B * @C
 Parameter: XTLTYPE -> "TETRAGONAL"
 Parameter: A -> "39"
 Parameter: B -> "39"
 Parameter: C -> "237.395"
 Comparing "TETRAGONAL" and "CUBIC".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    if @XTLtype .eq. ORTHorhombic calc sysvol = @A * @B * @C
 Parameter: XTLTYPE -> "TETRAGONAL"
 Parameter: A -> "39"
 Parameter: B -> "39"
 Parameter: C -> "237.395"
 Comparing "TETRAGONAL" and "ORTHORHOMBIC".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    if @XTLtype .eq. MONOclinic   calc sysvol = @A * @B * @C * sin ( @beta * ?pi / 180.0 )
 Parameter: XTLTYPE -> "TETRAGONAL"
 Parameter: A -> "39"
 Parameter: B -> "39"
 Parameter: C -> "237.395"
 Parameter: BETA -> "90.0"
 RDCMND substituted energy or value "?PI" to "3.14159265"
 Comparing "TETRAGONAL" and "MONOCLINIC".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    if @XTLtype .eq. HEXAgonal    calc sysvol = sqrt( 0.75 ) * @C * @A * @A
 Parameter: XTLTYPE -> "TETRAGONAL"
 Parameter: C -> "237.395"
 Parameter: A -> "39"
 Parameter: A -> "39"
 Comparing "TETRAGONAL" and "HEXAGONAL".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    if @XTLtype .eq. OCTAhedral   calc sysvol = 4.0 * sqrt( 3.0 ) / 9 * @A * @A * @A
 Parameter: XTLTYPE -> "TETRAGONAL"
 Parameter: A -> "39"
 Parameter: A -> "39"
 Parameter: A -> "39"
 Comparing "TETRAGONAL" and "OCTAHEDRAL".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    if @XTLtype .eq. RHDO         calc sysvol = sqrt( 0.5 ) * @A * @A * @A
 Parameter: XTLTYPE -> "TETRAGONAL"
 Parameter: A -> "39"
 Parameter: A -> "39"
 Parameter: A -> "39"
 Comparing "TETRAGONAL" and "RHDO".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    if @XTLtype .eq. TRIClinic then
 Parameter: XTLTYPE -> "TETRAGONAL"
 Comparing "TETRAGONAL" and "TRICLINIC".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>    if @XTLtype .eq. RHOMbohedral then
 Parameter: XTLTYPE -> "TETRAGONAL"
 Comparing "TETRAGONAL" and "RHOMBOHEDRAL".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    ! conc    : concentration (M)
 CHARMM>    ! volumn  : ion accessible volume (Ang**3)
 CHARMM>    ! npos    : number of positive ions of a particular compound
 CHARMM>    ! nneg    : number of negative ions of a particular compound
 CHARMM>    ! nion    : number of positive and negative ions of a particular compound
 CHARMM>    ! npostot : total number of all positive ions
 CHARMM>    ! nnegtot : total number of all negative ions
 CHARMM>    ! niontot : total number of all ions
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    calc volumn = @sysvol - @molvol
 Parameter: SYSVOL -> "361077.795"
 Parameter: MOLVOL -> "44018.2965"
Evaluating: 361077.795-44018.2965
 Parameter: VOLUMN <- "317059.498"
  
 CHARMM>    calc npostot = 0
Evaluating: 0
 Parameter: NPOSTOT <- "0"
  
 CHARMM>    calc nnegtot = 0
Evaluating: 0
 Parameter: NNEGTOT <- "0"
  
 CHARMM>    calc niontot = 0
Evaluating: 0
 Parameter: NIONTOT <- "0"
  
 CHARMM>     
  
 CHARMM>    define ALLIONS sele none end
 SELRPN>      0 atoms have been selected out of   2480
  
 CHARMM>     
  
 CHARMM>    set ionind = 1
 Parameter: IONIND <- "1"
  
 CHARMM>    label do_ion
  
 CHARMM>        define POS sele none end
 SELRPN>      0 atoms have been selected out of   2480
  
 CHARMM>        define NEG sele none end
 SELRPN>      0 atoms have been selected out of   2480
  
 CHARMM>     
  
 CHARMM>        stream step2.2_ions_count.str @ionind
 Parameter: IONIND -> "1"
 VOPEN> Attempting to open::step2.2_ions_count.str::
 OPNLGU> Unit 99 opened for READONLY access to /home/charmm-gui/data/www/4814588605/step2.2_ions_count.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * NUMBER OF EACH ION STRUCTURE, AS CHOSEN BY USER;
 RDTITL> * USAGE: STREAM STEP2_IONS_COUNT.STR INDEX
 RDTITL> *
 Parameter: IN1 <- "1"
  
 CHARMM>     
  
 CHARMM>    if @?IN1 .eq. 0 stop ! ABNORMAL TERMINATION: missing index
 Comparing "1" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set isusercation = 0
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    set isuseranion  = 0
 Parameter: ISUSERANION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set pos = POT
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POS <- "POT"
  
 CHARMM>    if @IN1 .eq. 1 set neg = CLA
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEG <- "CLA"
  
 CHARMM>    if @IN1 .eq. 1 set poscharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negcharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set posval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set conc = 0.15
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: CONC <- "0.15"
  
 CHARMM>    if @IN1 .eq. 1 set natompos = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMPOS <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set natomneg = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMNEG <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set isusercation = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set isuseranion  = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERANION <- "0"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    set neutral_index = 1
 Parameter: NEUTRAL_INDEX <- "1"
  
 CHARMM>    set niontypes = 1
 Parameter: NIONTYPES <- "1"
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>        calc ncharge = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "0"
Evaluating: INT(0)
 Parameter: NCHARGE <- "0"
  
 CHARMM>        calc cgtot = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "0"
Evaluating: 0
 Parameter: CGTOT <- "0"
  
 CHARMM>     
  
 CHARMM>        calc npos = 0
Evaluating: 0
 Parameter: NPOS <- "0"
  
 CHARMM>        calc nneg = 0
Evaluating: 0
 Parameter: NNEG <- "0"
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if ncharge .lt. 0 calc npos = int( abs( @cgtot ) / @poscharge )
 Parameter: CGTOT -> "0"
 Parameter: POSCHARGE -> "1"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            if ncharge .gt. 0 calc nneg = int( abs( @cgtot ) / @negcharge )
 Parameter: CGTOT -> "0"
 Parameter: NEGCHARGE -> "1"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc diff = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "0"
 Parameter: NPOS -> "0"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "0"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(0+0*1-0*1)
 Parameter: DIFF <- "0"
  
 CHARMM>     
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            set ntries = 0
 Parameter: NTRIES <- "0"
  
 CHARMM>            label neutral
  
 CHARMM>                if diff .gt. 0 calc nneg = @nneg + 1
 Parameter: NNEG -> "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .lt. 0 calc npos = @npos + 1
 Parameter: NPOS -> "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                calc diff = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "0"
 Parameter: NPOS -> "0"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "0"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(0+0*1-0*1)
 Parameter: DIFF <- "0"
  
 CHARMM>                incr ntries
 Parameter: NTRIES <- "1"
  
 CHARMM>                if ntries .ge. 10 stop ! ABNORMAL TERMINATION: can't neutralize this system
 Comparing "1" and "10".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .ne. 0 goto neutral
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc npos = @npos + int ( @conc * 6.021 * 0.0001 * @volumn ) * @negval
 Parameter: NPOS -> "0"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "317059.498"
 Parameter: NEGVAL -> "1"
Evaluating: 0+INT(0.15*6.021*0.0001*317059.498)*1
 Parameter: NPOS <- "28"
  
 CHARMM>        calc nneg = @nneg + int ( @conc * 6.021 * 0.0001 * @volumn ) * @posval
 Parameter: NNEG -> "0"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "317059.498"
 Parameter: POSVAL -> "1"
Evaluating: 0+INT(0.15*6.021*0.0001*317059.498)*1
 Parameter: NNEG <- "28"
  
 CHARMM>     
  
 CHARMM>        if npos .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "28" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        if nneg .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "28" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Randomly place the ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        ! initial positions for all ions
  
 CHARMM>        calc xpos = @A / 2.0
 Parameter: A -> "39"
Evaluating: 39/2.0
 Parameter: XPOS <- "19.5"
  
 CHARMM>        calc ypos = @B / 2.0
 Parameter: B -> "39"
Evaluating: 39/2.0
 Parameter: YPOS <- "19.5"
  
 CHARMM>        calc zpos = @C / 2.0
 Parameter: C -> "237.395"
Evaluating: 237.395/2.0
 Parameter: ZPOS <- "118.6975"
  
 CHARMM>     
  
 CHARMM>        ! Generate positive ion
  
 CHARMM>        if npos .gt. 0 then
 Comparing "28" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isusercation .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @pos @npos
 Parameter: POS -> "POT"
 Parameter: NPOS -> "28"
  
 CHARMM>                generate POS warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 GENPSF> Segment   2 has been generated. Its identifier is POS.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        2   Number of residues   =       29
         Number of atoms         =     2508   Number of groups     =     2508
         Number of bonds         =     3704   Number of angles     =     7384
         Number of dihedrals     =    14724   Number of impropers  =        0
         Number of cross-terms   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =   28.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define POS sele segid POS end
 SELRPN>     28 atoms have been selected out of   2508
  
 CHARMM>     
  
 CHARMM>            if natompos .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                coor set xdir @xpos ydir @ypos zdir @zpos select POS end
 Parameter: XPOS -> "19.5"
 Parameter: YPOS -> "19.5"
 Parameter: ZPOS -> "118.6975"
 SELRPN>     28 atoms have been selected out of   2508
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        ! Generate negative ion
  
 CHARMM>        if nneg .gt. 0 then
 Comparing "28" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isuseranion .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @neg @nneg
 Parameter: NEG -> "CLA"
 Parameter: NNEG -> "28"
  
 CHARMM>                generate NEG warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 GENPSF> Segment   3 has been generated. Its identifier is NEG.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        3   Number of residues   =       57
         Number of atoms         =     2536   Number of groups     =     2536
         Number of bonds         =     3704   Number of angles     =     7384
         Number of dihedrals     =    14724   Number of impropers  =        0
         Number of cross-terms   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =    0.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     28 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if natomneg .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                coor set xdir @xpos ydir @ypos zdir @zpos select NEG end
 Parameter: XPOS -> "19.5"
 Parameter: YPOS -> "19.5"
 Parameter: ZPOS -> "118.6975"
 SELRPN>     28 atoms have been selected out of   2536
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele POS .or. NEG end
 SELRPN>     56 atoms have been selected out of   2536
  
 CHARMM>        define ALLIONS sele segid IONS .or. IONS end
 SELRPN>     56 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>        calc nion = @npos + @nneg
 Parameter: NPOS -> "28"
 Parameter: NNEG -> "28"
Evaluating: 28+28
 Parameter: NION <- "56"
  
 CHARMM>     
  
 CHARMM>        incr npostot by @npos
 Parameter: NPOS -> "28"
 Parameter: NPOSTOT <- "28"
  
 CHARMM>        incr nnegtot by @nneg
 Parameter: NNEG -> "28"
 Parameter: NNEGTOT <- "28"
  
 CHARMM>        incr niontot by @nion
 Parameter: NION -> "56"
 Parameter: NIONTOT <- "56"
  
 CHARMM>     
  
 CHARMM>        if nion .eq. 0 goto continue
 Comparing "56" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        !Images Setup [to place all atoms inside the box]
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        COOR CONVERT ALIGNED SYMMETRIC @A @B @C @alpha @beta @gamma
 Parameter: A -> "39"
 Parameter: B -> "39"
 Parameter: C -> "237.395"
 Parameter: ALPHA -> "90.0"
 Parameter: BETA -> "90.0"
 Parameter: GAMMA -> "90.0"
  
 CHARMM>     
  
 CHARMM>        open read unit 10 card name crystal_image.str
 VOPEN> Attempting to open::crystal_image.str::
 OPNLGU> Unit 10 opened for READONLY access to /home/charmm-gui/data/www/4814588605/crystal_image.str
  
 CHARMM>        CRYSTAL DEFINE @XTLtype @A @B @C @alpha @beta @gamma
 Parameter: XTLTYPE -> "TETRAGONAL"
 Parameter: A -> "39"
 Parameter: B -> "39"
 Parameter: C -> "237.395"
 Parameter: ALPHA -> "90.0"
 Parameter: BETA -> "90.0"
 Parameter: GAMMA -> "90.0"
 Crystal Parameters : Crystal Type = TETR
           A     =   39.00000 B    =   39.00000 C     =  237.39500
           Alpha =   90.00000 Beta =   90.00000 Gamma =   90.00000
  
 CHARMM>        CRYSTAL READ UNIT 10 CARD
 CRYSTAL FILE BEING READ FROM UNIT    10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 24. 2022. JOBID=4814588605
 TITLE> * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE> *
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 24. 2022. JOB
 TITLE>  * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE>  *
                     THERE ARE NO ROTATIONS FOR THIS TRANSFORMATION SET
    26 Transformations have been processed.

  
 CHARMM>     
  
 CHARMM>        !Image centering by residue
  
 CHARMM>        IMAGE BYRES XCEN @xcen YCEN @ycen ZCEN @zcen
 Parameter: XCEN -> "0"
 Parameter: YCEN -> "0"
 Parameter: ZCEN -> "0"
 IMAGE CENTERING ON FOR SOME ATOMS
  
 CHARMM>     
  
 CHARMM>        update image inbf 0

 SELECTED IMAGES ATOMS BEING CENTERED ABOUT  0.000000  0.000000  0.000000
 RESIDUE    2 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE    3 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE    4 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE    5 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE    6 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE    7 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE    8 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE    9 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   10 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   11 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   12 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   13 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   14 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   15 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   16 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   17 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   18 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   19 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   20 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   21 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   22 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   23 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   24 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   25 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   26 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   27 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   28 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   29 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   30 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   31 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   32 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   33 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   34 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   35 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   36 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   37 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   38 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   39 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   40 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   41 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   42 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   43 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   44 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   45 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   46 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   47 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   48 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   49 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   50 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   51 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   52 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   53 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   54 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   55 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   56 OPERATED ON BY TRANSFORMATION N1N1Z0R1
 RESIDUE   57 OPERATED ON BY TRANSFORMATION N1N1Z0R1

 <MKIMAT2>: updating the image atom lists and remapping
 Transformation   Atoms  Groups  Residues  Min-Distance
    1  N1N1N1R1 has       0       0       0       23.22
    2  N1Z0N1R1 has       0       0       0       15.29
    3  N1P1N1R1 has       0       0       0       35.38
    4  Z0N1N1R1 has       0       0       0       15.18
    5  Z0Z0N1R1 has     144     144       1        0.00
    6  Z0P1N1R1 has       0       0       0       15.13
    7  N1N1Z0R1 has       0       0       0       23.21
    8  N1Z0Z0R1 has       0       0       0       15.13
    9  N1P1Z0R1 has       0       0       0       35.37
   10  Z0N1Z0R1 has       0       0       0       15.13
   12  N1N1P1R1 has       0       0       0       23.34
   13  N1Z0P1R1 has       0       0       0       15.13
   14  N1P1P1R1 has       0       0       0       35.40
 Total of 2680 atoms and 2680 groups and   58 residues were included

 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 IMAGE
  
 CHARMM>     
  
 CHARMM>        CONS FIX SELE .NOT. IONS END
 SELRPN>   2480 atoms have been selected out of   2536
  
 CHARMM>        SKIP ALL EXCL VDW ELEC
 SKIPE> The following energy terms will be computed :
  VDW  ELEC
  
 CHARMM>        scalar wmain = charge
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Initial placement of ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>     
  
 CHARMM>        calc i   = 1
Evaluating: 1
 Parameter: I <- "1"
  
 CHARMM>        label doinit
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "1" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.407224704"
Evaluating: (39-9.0)*(0.407224704-0.5)
 Parameter: XPOS <- "-2.78325888"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.694151126"
Evaluating: (39-9.0)*(0.694151126-0.5)
 Parameter: YPOS <- "5.82453378"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.522745771"
Evaluating: (237.395-9.0)*(0.522745771-0.5)
 Parameter: ZPOS <- "5.19502037"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.78325888"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -2.78325888--19.5
 Parameter: XTRAN <- "16.7167411"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.82453378"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 5.82453378--19.5
 Parameter: YTRAN <- "25.3245338"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "5.19502037"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 5.19502037-118.6975
 Parameter: ZTRAN <- "-113.50248"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "16.7167411"
 Parameter: YTRAN -> "25.3245338"
 Parameter: ZTRAN -> "-113.50248"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    16.716741   25.324534 -113.502480
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.284495428"
Evaluating: 0.284495428*360.0
 Parameter: XPHI <- "102.418354"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.744855566"
Evaluating: 0.744855566*360.0
 Parameter: YPHI <- "268.148004"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.853781052"
Evaluating: 0.853781052*360.0
 Parameter: ZPHI <- "307.361179"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.78325888"
 Parameter: YPOS -> "5.82453378"
 Parameter: ZPOS -> "5.19502037"
 Parameter: XPHI -> "102.418354"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.215048    0.976603
    0.000000   -0.976603   -0.215048

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  102.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.78325888"
 Parameter: YPOS -> "5.82453378"
 Parameter: ZPOS -> "5.19502037"
 Parameter: YPHI -> "268.148004"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.032318    0.000000    0.999478
    0.000000    1.000000    0.000000
   -0.999478    0.000000   -0.032318

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   91.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.78325888"
 Parameter: YPOS -> "5.82453378"
 Parameter: ZPOS -> "5.19502037"
 Parameter: ZPHI -> "307.361179"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.606837   -0.794826    0.000000
    0.794826    0.606837    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   52.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.783259 XMAX =   -2.783259 XAVE =   -2.783259
    YMIN =    5.824534 YMAX =    5.824534 YAVE =    5.824534
    ZMIN =    5.195020 ZMAX =    5.195020 ZAVE =    5.195020
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.78325855"
Evaluating: -2.78325855+3.5
 Parameter: XMAX <- "0.71674145"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.82453361"
Evaluating: 5.82453361+3.5
 Parameter: YMAX <- "9.32453361"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "5.19502039"
Evaluating: 5.19502039+3.5
 Parameter: ZMAX <- "8.69502039"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.78325855"
Evaluating: -2.78325855-3.5
 Parameter: XMIN <- "-6.28325855"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.82453361"
Evaluating: 5.82453361-3.5
 Parameter: YMIN <- "2.32453361"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "5.19502039"
Evaluating: 5.19502039-3.5
 Parameter: ZMIN <- "1.69502039"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.71674145"
 Parameter: XMIN -> "-6.28325855"
 Parameter: YMAX -> "9.32453361"
 Parameter: YMIN -> "2.32453361"
 Parameter: ZMAX -> "8.69502039"
 Parameter: ZMIN -> "1.69502039"
 SELRPN>     12 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   2680
 SELRPN>     12 atoms have been selected out of   2680

            DISTANCES FOR SELECTED ATOMS
 2481 POS      POT      1        POT     -   7 NM       TUBE     1        C7            3.9155
 2481 POS      POT      1        POT     -1281 NM       TUBE     1        CZL           3.9078
 2481 POS      POT      1        POT     -1283 NM       TUBE     1        CZN           3.3495
 2481 POS      POT      1        POT     -1285 NM       TUBE     1        CZP           2.3362
 2481 POS      POT      1        POT     -1288 NM       TUBE     1        CZS           2.7812
 2481 POS      POT      1        POT     -1293 NM       TUBE     1        CZX           3.1450
 2481 POS      POT      1        POT     -1321 NM       TUBE     1        C10P          3.6297
 2481 POS      POT      1        POT     -1705 NM       TUBE     1        C1BD          2.9012
 2481 POS      POT      1        POT     -1741 NM       TUBE     1        C1CD          2.8388
 2481 POS      POT      1        POT     -1756 NM       TUBE     1        C1CS          3.2897
 2481 POS      POT      1        POT     -1938 NM       TUBE     1        C1HU          2.1950
 2481 POS      POT      1        POT     -1991 NM       TUBE     1        C1JB          3.8425
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "1" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.472256934"
Evaluating: (39-9.0)*(0.472256934-0.5)
 Parameter: XPOS <- "-0.83229198"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "3.787248818E-02"
Evaluating: (39-9.0)*(3.787248818E-02-0.5)
 Parameter: YPOS <- "-13.8638254"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.341151523"
Evaluating: (237.395-9.0)*(0.341151523-0.5)
 Parameter: ZPOS <- "-36.2801979"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.783259 XMAX =   -2.783259 XAVE =   -2.783259
    YMIN =    5.824534 YMAX =    5.824534 YAVE =    5.824534
    ZMIN =    5.195020 ZMAX =    5.195020 ZAVE =    5.195020
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.83229198"
 RDCMND substituted energy or value "?XAVE" to "-2.78325855"
Evaluating: -0.83229198--2.78325855
 Parameter: XTRAN <- "1.95096657"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.8638254"
 RDCMND substituted energy or value "?YAVE" to "5.82453361"
Evaluating: -13.8638254-5.82453361
 Parameter: YTRAN <- "-19.688359"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.2801979"
 RDCMND substituted energy or value "?ZAVE" to "5.19502039"
Evaluating: -36.2801979-5.19502039
 Parameter: ZTRAN <- "-41.4752183"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.95096657"
 Parameter: YTRAN -> "-19.688359"
 Parameter: ZTRAN -> "-41.4752183"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR     1.950967  -19.688359  -41.475218
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.606879726E-04"
Evaluating: 6.606879726E-04*360.0
 Parameter: XPHI <- "0.23784767"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.143521941E-02"
Evaluating: 8.143521941E-02*360.0
 Parameter: YPHI <- "29.316679"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.846437048"
Evaluating: 0.846437048*360.0
 Parameter: ZPHI <- "304.717337"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.83229198"
 Parameter: YPOS -> "-13.8638254"
 Parameter: ZPOS -> "-36.2801979"
 Parameter: XPHI -> "0.23784767"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999991    0.004151
    0.000000   -0.004151    0.999991

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    0.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.83229198"
 Parameter: YPOS -> "-13.8638254"
 Parameter: ZPOS -> "-36.2801979"
 Parameter: YPHI -> "29.316679"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.871927    0.000000   -0.489636
    0.000000    1.000000    0.000000
    0.489636    0.000000    0.871927

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   29.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.83229198"
 Parameter: YPOS -> "-13.8638254"
 Parameter: ZPOS -> "-36.2801979"
 Parameter: ZPHI -> "304.717337"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.569528   -0.821972    0.000000
    0.821972    0.569528    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   55.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.832292 XMAX =   -0.832292 XAVE =   -0.832292
    YMIN =  -13.863825 YMAX =  -13.863825 YAVE =  -13.863825
    ZMIN =  -36.280198 ZMAX =  -36.280198 ZAVE =  -36.280198
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.832291983"
Evaluating: -0.832291983+3.5
 Parameter: XMAX <- "2.66770802"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.8638254"
Evaluating: -13.8638254+3.5
 Parameter: YMAX <- "-10.3638254"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.2801979"
Evaluating: -36.2801979+3.5
 Parameter: ZMAX <- "-32.7801979"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.832291983"
Evaluating: -0.832291983-3.5
 Parameter: XMIN <- "-4.33229198"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.8638254"
Evaluating: -13.8638254-3.5
 Parameter: YMIN <- "-17.3638254"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.2801979"
Evaluating: -36.2801979-3.5
 Parameter: ZMIN <- "-39.7801979"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.66770802"
 Parameter: XMIN -> "-4.33229198"
 Parameter: YMAX -> "-10.3638254"
 Parameter: YMIN -> "-17.3638254"
 Parameter: ZMAX -> "-32.7801979"
 Parameter: ZMIN -> "-39.7801979"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-13.8638254"
 Parameter: YPOS -> "-13.8638254"
 Parameter: XPOS -> "-0.83229198"
 Parameter: XPOS -> "-0.83229198"
Evaluating: SQRT(-13.8638254*-13.8638254+-0.83229198*-0.83229198)
 Parameter: DIST <- "13.8887856"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "13.8887856" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "2"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "2" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "2" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.866788812"
Evaluating: (39-9.0)*(0.866788812-0.5)
 Parameter: XPOS <- "11.0036644"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "1.579332061E-02"
Evaluating: (39-9.0)*(1.579332061E-02-0.5)
 Parameter: YPOS <- "-14.5262004"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.307756778"
Evaluating: (237.395-9.0)*(0.307756778-0.5)
 Parameter: ZPOS <- "-43.9073907"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.0036644"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 11.0036644--19.5
 Parameter: XTRAN <- "30.5036644"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.5262004"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -14.5262004--19.5
 Parameter: YTRAN <- "4.9737996"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-43.9073907"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -43.9073907-118.6975
 Parameter: ZTRAN <- "-162.604891"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.5036644"
 Parameter: YTRAN -> "4.9737996"
 Parameter: ZTRAN -> "-162.604891"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    30.503664    4.973800 -162.604891
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.656685202"
Evaluating: 0.656685202*360.0
 Parameter: XPHI <- "236.406673"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.496351822"
Evaluating: 0.496351822*360.0
 Parameter: YPHI <- "178.686656"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.872131258"
Evaluating: 0.872131258*360.0
 Parameter: ZPHI <- "313.967253"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.0036644"
 Parameter: YPOS -> "-14.5262004"
 Parameter: ZPOS -> "-43.9073907"
 Parameter: XPHI -> "236.406673"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.553295   -0.832986
    0.000000    0.832986   -0.553295

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  123.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.0036644"
 Parameter: YPOS -> "-14.5262004"
 Parameter: ZPOS -> "-43.9073907"
 Parameter: YPHI -> "178.686656"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.999737    0.000000   -0.022920
    0.000000    1.000000    0.000000
    0.022920    0.000000   -0.999737

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  178.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.0036644"
 Parameter: YPOS -> "-14.5262004"
 Parameter: ZPOS -> "-43.9073907"
 Parameter: ZPHI -> "313.967253"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.694247   -0.719737    0.000000
    0.719737    0.694247    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   46.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.003664 XMAX =   11.003664 XAVE =   11.003664
    YMIN =  -14.526200 YMAX =  -14.526200 YAVE =  -14.526200
    ZMIN =  -43.907391 ZMAX =  -43.907391 ZAVE =  -43.907391
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.0036642"
Evaluating: 11.0036642+3.5
 Parameter: XMAX <- "14.5036642"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.5262002"
Evaluating: -14.5262002+3.5
 Parameter: YMAX <- "-11.0262002"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-43.9073909"
Evaluating: -43.9073909+3.5
 Parameter: ZMAX <- "-40.4073909"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.0036642"
Evaluating: 11.0036642-3.5
 Parameter: XMIN <- "7.5036642"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.5262002"
Evaluating: -14.5262002-3.5
 Parameter: YMIN <- "-18.0262002"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-43.9073909"
Evaluating: -43.9073909-3.5
 Parameter: ZMIN <- "-47.4073909"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.5036642"
 Parameter: XMIN -> "7.5036642"
 Parameter: YMAX -> "-11.0262002"
 Parameter: YMIN -> "-18.0262002"
 Parameter: ZMAX -> "-40.4073909"
 Parameter: ZMIN -> "-47.4073909"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-14.5262004"
 Parameter: YPOS -> "-14.5262004"
 Parameter: XPOS -> "11.0036644"
 Parameter: XPOS -> "11.0036644"
Evaluating: SQRT(-14.5262004*-14.5262004+11.0036644*11.0036644)
 Parameter: DIST <- "18.2233676"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "18.2233676" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "3"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "3" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "3" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.208405921"
Evaluating: (39-9.0)*(0.208405921-0.5)
 Parameter: XPOS <- "-8.74782237"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.805758348"
Evaluating: (39-9.0)*(0.805758348-0.5)
 Parameter: YPOS <- "9.17275044"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.808531203"
Evaluating: (237.395-9.0)*(0.808531203-0.5)
 Parameter: ZPOS <- "70.4669841"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.74782237"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -8.74782237--19.5
 Parameter: XTRAN <- "10.7521776"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.17275044"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 9.17275044--19.5
 Parameter: YTRAN <- "28.6727504"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "70.4669841"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 70.4669841-118.6975
 Parameter: ZTRAN <- "-48.2305159"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.7521776"
 Parameter: YTRAN -> "28.6727504"
 Parameter: ZTRAN -> "-48.2305159"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    10.752178   28.672750  -48.230516
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.378672343"
Evaluating: 0.378672343*360.0
 Parameter: XPHI <- "136.322043"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.378922255"
Evaluating: 0.378922255*360.0
 Parameter: YPHI <- "136.412012"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.487731455"
Evaluating: 0.487731455*360.0
 Parameter: ZPHI <- "175.583324"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.74782237"
 Parameter: YPOS -> "9.17275044"
 Parameter: ZPOS -> "70.4669841"
 Parameter: XPHI -> "136.322043"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.723233    0.690604
    0.000000   -0.690604   -0.723233

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  136.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.74782237"
 Parameter: YPOS -> "9.17275044"
 Parameter: ZPOS -> "70.4669841"
 Parameter: YPHI -> "136.412012"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.724316    0.000000   -0.689468
    0.000000    1.000000    0.000000
    0.689468    0.000000   -0.724316

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  136.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.74782237"
 Parameter: YPOS -> "9.17275044"
 Parameter: ZPOS -> "70.4669841"
 Parameter: ZPHI -> "175.583324"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.997030    0.077009    0.000000
   -0.077009   -0.997030    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  175.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.747822 XMAX =   -8.747822 XAVE =   -8.747822
    YMIN =    9.172750 YMAX =    9.172750 YAVE =    9.172750
    ZMIN =   70.466984 ZMAX =   70.466984 ZAVE =   70.466984
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.74782237"
Evaluating: -8.74782237+3.5
 Parameter: XMAX <- "-5.24782237"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.17275041"
Evaluating: 9.17275041+3.5
 Parameter: YMAX <- "12.6727504"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "70.4669841"
Evaluating: 70.4669841+3.5
 Parameter: ZMAX <- "73.9669841"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.74782237"
Evaluating: -8.74782237-3.5
 Parameter: XMIN <- "-12.2478224"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.17275041"
Evaluating: 9.17275041-3.5
 Parameter: YMIN <- "5.67275041"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "70.4669841"
Evaluating: 70.4669841-3.5
 Parameter: ZMIN <- "66.9669841"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.24782237"
 Parameter: XMIN -> "-12.2478224"
 Parameter: YMAX -> "12.6727504"
 Parameter: YMIN -> "5.67275041"
 Parameter: ZMAX -> "73.9669841"
 Parameter: ZMIN -> "66.9669841"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "9.17275044"
 Parameter: YPOS -> "9.17275044"
 Parameter: XPOS -> "-8.74782237"
 Parameter: XPOS -> "-8.74782237"
Evaluating: SQRT(9.17275044*9.17275044+-8.74782237*-8.74782237)
 Parameter: DIST <- "12.6753204"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "12.6753204" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "4"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "4" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "4" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.227184412"
Evaluating: (39-9.0)*(0.227184412-0.5)
 Parameter: XPOS <- "-8.18446764"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.673263088"
Evaluating: (39-9.0)*(0.673263088-0.5)
 Parameter: YPOS <- "5.19789264"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.687801663"
Evaluating: (237.395-9.0)*(0.687801663-0.5)
 Parameter: ZPOS <- "42.8929608"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.18446764"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -8.18446764--19.5
 Parameter: XTRAN <- "11.3155324"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.19789264"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 5.19789264--19.5
 Parameter: YTRAN <- "24.6978926"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "42.8929608"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 42.8929608-118.6975
 Parameter: ZTRAN <- "-75.8045392"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.3155324"
 Parameter: YTRAN -> "24.6978926"
 Parameter: ZTRAN -> "-75.8045392"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    11.315532   24.697893  -75.804539
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.322082659"
Evaluating: 0.322082659*360.0
 Parameter: XPHI <- "115.949757"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.388370379E-02"
Evaluating: 3.388370379E-02*360.0
 Parameter: YPHI <- "12.1981334"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.678856518"
Evaluating: 0.678856518*360.0
 Parameter: ZPHI <- "244.388346"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.18446764"
 Parameter: YPOS -> "5.19789264"
 Parameter: ZPOS -> "42.8929608"
 Parameter: XPHI -> "115.949757"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.437583    0.899178
    0.000000   -0.899178   -0.437583

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  115.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.18446764"
 Parameter: YPOS -> "5.19789264"
 Parameter: ZPOS -> "42.8929608"
 Parameter: YPHI -> "12.1981334"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.977423    0.000000   -0.211293
    0.000000    1.000000    0.000000
    0.211293    0.000000    0.977423

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   12.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.18446764"
 Parameter: YPOS -> "5.19789264"
 Parameter: ZPOS -> "42.8929608"
 Parameter: ZPHI -> "244.388346"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.432269   -0.901745    0.000000
    0.901745   -0.432269    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  115.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.184468 XMAX =   -8.184468 XAVE =   -8.184468
    YMIN =    5.197893 YMAX =    5.197893 YAVE =    5.197893
    ZMIN =   42.892961 ZMAX =   42.892961 ZAVE =   42.892961
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.18446767"
Evaluating: -8.18446767+3.5
 Parameter: XMAX <- "-4.68446767"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.19789266"
Evaluating: 5.19789266+3.5
 Parameter: YMAX <- "8.69789266"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "42.8929608"
Evaluating: 42.8929608+3.5
 Parameter: ZMAX <- "46.3929608"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.18446767"
Evaluating: -8.18446767-3.5
 Parameter: XMIN <- "-11.6844677"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.19789266"
Evaluating: 5.19789266-3.5
 Parameter: YMIN <- "1.69789266"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "42.8929608"
Evaluating: 42.8929608-3.5
 Parameter: ZMIN <- "39.3929608"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.68446767"
 Parameter: XMIN -> "-11.6844677"
 Parameter: YMAX -> "8.69789266"
 Parameter: YMIN -> "1.69789266"
 Parameter: ZMAX -> "46.3929608"
 Parameter: ZMIN -> "39.3929608"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "5.19789264"
 Parameter: YPOS -> "5.19789264"
 Parameter: XPOS -> "-8.18446764"
 Parameter: XPOS -> "-8.18446764"
Evaluating: SQRT(5.19789264*5.19789264+-8.18446764*-8.18446764)
 Parameter: DIST <- "9.69554529"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "9.69554529" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "5"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "5" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "5" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.170555333"
Evaluating: (39-9.0)*(0.170555333-0.5)
 Parameter: XPOS <- "-9.88334001"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.443540224"
Evaluating: (39-9.0)*(0.443540224-0.5)
 Parameter: YPOS <- "-1.69379328"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.622321977"
Evaluating: (237.395-9.0)*(0.622321977-0.5)
 Parameter: ZPOS <- "27.9377279"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.88334001"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -9.88334001--19.5
 Parameter: XTRAN <- "9.61665999"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.69379328"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -1.69379328--19.5
 Parameter: YTRAN <- "17.8062067"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.9377279"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 27.9377279-118.6975
 Parameter: ZTRAN <- "-90.7597721"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "9.61665999"
 Parameter: YTRAN -> "17.8062067"
 Parameter: ZTRAN -> "-90.7597721"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR     9.616660   17.806207  -90.759772
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.491777461"
Evaluating: 0.491777461*360.0
 Parameter: XPHI <- "177.039886"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.819545825"
Evaluating: 0.819545825*360.0
 Parameter: YPHI <- "295.036497"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.383402135"
Evaluating: 0.383402135*360.0
 Parameter: ZPHI <- "138.024769"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.88334001"
 Parameter: YPOS -> "-1.69379328"
 Parameter: ZPOS -> "27.9377279"
 Parameter: XPHI -> "177.039886"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.998666    0.051641
    0.000000   -0.051641   -0.998666

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  177.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.88334001"
 Parameter: YPOS -> "-1.69379328"
 Parameter: ZPOS -> "27.9377279"
 Parameter: YPHI -> "295.036497"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.423195    0.000000    0.906038
    0.000000    1.000000    0.000000
   -0.906038    0.000000    0.423195

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   64.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.88334001"
 Parameter: YPOS -> "-1.69379328"
 Parameter: ZPOS -> "27.9377279"
 Parameter: ZPHI -> "138.024769"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.743434    0.668809    0.000000
   -0.668809   -0.743434    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  138.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.883340 XMAX =   -9.883340 XAVE =   -9.883340
    YMIN =   -1.693793 YMAX =   -1.693793 YAVE =   -1.693793
    ZMIN =   27.937728 ZMAX =   27.937728 ZAVE =   27.937728
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.88334"
Evaluating: -9.88334+3.5
 Parameter: XMAX <- "-6.38334"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.6937933"
Evaluating: -1.6937933+3.5
 Parameter: YMAX <- "1.8062067"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.9377279"
Evaluating: 27.9377279+3.5
 Parameter: ZMAX <- "31.4377279"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.88334"
Evaluating: -9.88334-3.5
 Parameter: XMIN <- "-13.38334"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.6937933"
Evaluating: -1.6937933-3.5
 Parameter: YMIN <- "-5.1937933"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.9377279"
Evaluating: 27.9377279-3.5
 Parameter: ZMIN <- "24.4377279"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.38334"
 Parameter: XMIN -> "-13.38334"
 Parameter: YMAX -> "1.8062067"
 Parameter: YMIN -> "-5.1937933"
 Parameter: ZMAX -> "31.4377279"
 Parameter: ZMIN -> "24.4377279"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-1.69379328"
 Parameter: YPOS -> "-1.69379328"
 Parameter: XPOS -> "-9.88334001"
 Parameter: XPOS -> "-9.88334001"
Evaluating: SQRT(-1.69379328*-1.69379328+-9.88334001*-9.88334001)
 Parameter: DIST <- "10.0274297"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "10.0274297" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "6"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "6" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "6" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.87974876"
Evaluating: (39-9.0)*(0.87974876-0.5)
 Parameter: XPOS <- "11.3924628"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "8.922180277E-02"
Evaluating: (39-9.0)*(8.922180277E-02-0.5)
 Parameter: YPOS <- "-12.3233459"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.407071736"
Evaluating: (237.395-9.0)*(0.407071736-0.5)
 Parameter: ZPOS <- "-21.2243509"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.3924628"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 11.3924628--19.5
 Parameter: XTRAN <- "30.8924628"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.3233459"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -12.3233459--19.5
 Parameter: YTRAN <- "7.1766541"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.2243509"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -21.2243509-118.6975
 Parameter: ZTRAN <- "-139.921851"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "30.8924628"
 Parameter: YTRAN -> "7.1766541"
 Parameter: ZTRAN -> "-139.921851"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    30.892463    7.176654 -139.921851
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.551325104"
Evaluating: 0.551325104*360.0
 Parameter: XPHI <- "198.477037"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.414072737E-02"
Evaluating: 4.414072737E-02*360.0
 Parameter: YPHI <- "15.8906619"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.471246862"
Evaluating: 0.471246862*360.0
 Parameter: ZPHI <- "169.64887"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.3924628"
 Parameter: YPOS -> "-12.3233459"
 Parameter: ZPOS -> "-21.2243509"
 Parameter: XPHI -> "198.477037"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.948451   -0.316925
    0.000000    0.316925   -0.948451

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  161.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.3924628"
 Parameter: YPOS -> "-12.3233459"
 Parameter: ZPOS -> "-21.2243509"
 Parameter: YPHI -> "15.8906619"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.961786    0.000000   -0.273802
    0.000000    1.000000    0.000000
    0.273802    0.000000    0.961786

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   15.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.3924628"
 Parameter: YPOS -> "-12.3233459"
 Parameter: ZPOS -> "-21.2243509"
 Parameter: ZPHI -> "169.64887"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.983725    0.179680    0.000000
   -0.179680   -0.983725    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  169.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.392463 XMAX =   11.392463 XAVE =   11.392463
    YMIN =  -12.323346 YMAX =  -12.323346 YAVE =  -12.323346
    ZMIN =  -21.224351 ZMAX =  -21.224351 ZAVE =  -21.224351
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.3924628"
Evaluating: 11.3924628+3.5
 Parameter: XMAX <- "14.8924628"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.3233459"
Evaluating: -12.3233459+3.5
 Parameter: YMAX <- "-8.8233459"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.2243508"
Evaluating: -21.2243508+3.5
 Parameter: ZMAX <- "-17.7243508"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.3924628"
Evaluating: 11.3924628-3.5
 Parameter: XMIN <- "7.8924628"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.3233459"
Evaluating: -12.3233459-3.5
 Parameter: YMIN <- "-15.8233459"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.2243508"
Evaluating: -21.2243508-3.5
 Parameter: ZMIN <- "-24.7243508"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.8924628"
 Parameter: XMIN -> "7.8924628"
 Parameter: YMAX -> "-8.8233459"
 Parameter: YMIN -> "-15.8233459"
 Parameter: ZMAX -> "-17.7243508"
 Parameter: ZMIN -> "-24.7243508"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-12.3233459"
 Parameter: YPOS -> "-12.3233459"
 Parameter: XPOS -> "11.3924628"
 Parameter: XPOS -> "11.3924628"
Evaluating: SQRT(-12.3233459*-12.3233459+11.3924628*11.3924628)
 Parameter: DIST <- "16.7825225"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "16.7825225" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "7"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "7" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "7" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.96148515"
Evaluating: (39-9.0)*(0.96148515-0.5)
 Parameter: XPOS <- "13.8445545"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.427413851"
Evaluating: (39-9.0)*(0.427413851-0.5)
 Parameter: YPOS <- "-2.17758447"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.735829896"
Evaluating: (237.395-9.0)*(0.735829896-0.5)
 Parameter: ZPOS <- "53.8623691"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.8445545"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 13.8445545--19.5
 Parameter: XTRAN <- "33.3445545"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.17758447"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -2.17758447--19.5
 Parameter: YTRAN <- "17.3224155"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "53.8623691"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 53.8623691-118.6975
 Parameter: ZTRAN <- "-64.8351309"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.3445545"
 Parameter: YTRAN -> "17.3224155"
 Parameter: ZTRAN -> "-64.8351309"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    33.344555   17.322416  -64.835131
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.33960081"
Evaluating: 0.33960081*360.0
 Parameter: XPHI <- "122.256292"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.127245621"
Evaluating: 0.127245621*360.0
 Parameter: YPHI <- "45.8084236"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.815441836"
Evaluating: 0.815441836*360.0
 Parameter: ZPHI <- "293.559061"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.8445545"
 Parameter: YPOS -> "-2.17758447"
 Parameter: ZPOS -> "53.8623691"
 Parameter: XPHI -> "122.256292"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.533707    0.845669
    0.000000   -0.845669   -0.533707

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  122.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.8445545"
 Parameter: YPOS -> "-2.17758447"
 Parameter: ZPOS -> "53.8623691"
 Parameter: YPHI -> "45.8084236"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.697060    0.000000   -0.717013
    0.000000    1.000000    0.000000
    0.717013    0.000000    0.697060

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   45.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.8445545"
 Parameter: YPOS -> "-2.17758447"
 Parameter: ZPOS -> "53.8623691"
 Parameter: ZPHI -> "293.559061"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.399694   -0.916649    0.000000
    0.916649    0.399694    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   66.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.844554 XMAX =   13.844554 XAVE =   13.844554
    YMIN =   -2.177584 YMAX =   -2.177584 YAVE =   -2.177584
    ZMIN =   53.862369 ZMAX =   53.862369 ZAVE =   53.862369
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.8445545"
Evaluating: 13.8445545+3.5
 Parameter: XMAX <- "17.3445545"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.17758448"
Evaluating: -2.17758448+3.5
 Parameter: YMAX <- "1.32241552"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "53.8623691"
Evaluating: 53.8623691+3.5
 Parameter: ZMAX <- "57.3623691"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.8445545"
Evaluating: 13.8445545-3.5
 Parameter: XMIN <- "10.3445545"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.17758448"
Evaluating: -2.17758448-3.5
 Parameter: YMIN <- "-5.67758448"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "53.8623691"
Evaluating: 53.8623691-3.5
 Parameter: ZMIN <- "50.3623691"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.3445545"
 Parameter: XMIN -> "10.3445545"
 Parameter: YMAX -> "1.32241552"
 Parameter: YMIN -> "-5.67758448"
 Parameter: ZMAX -> "57.3623691"
 Parameter: ZMIN -> "50.3623691"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-2.17758447"
 Parameter: YPOS -> "-2.17758447"
 Parameter: XPOS -> "13.8445545"
 Parameter: XPOS -> "13.8445545"
Evaluating: SQRT(-2.17758447*-2.17758447+13.8445545*13.8445545)
 Parameter: DIST <- "14.0147623"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "14.0147623" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "8"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "8" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "8" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.125785906"
Evaluating: (39-9.0)*(0.125785906-0.5)
 Parameter: XPOS <- "-11.2264228"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.128822242"
Evaluating: (39-9.0)*(0.128822242-0.5)
 Parameter: YPOS <- "-11.1353327"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.489757014"
Evaluating: (237.395-9.0)*(0.489757014-0.5)
 Parameter: ZPOS <- "-2.33944679"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.2264228"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -11.2264228--19.5
 Parameter: XTRAN <- "8.2735772"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.1353327"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -11.1353327--19.5
 Parameter: YTRAN <- "8.3646673"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-2.33944679"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -2.33944679-118.6975
 Parameter: ZTRAN <- "-121.036947"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.2735772"
 Parameter: YTRAN -> "8.3646673"
 Parameter: ZTRAN -> "-121.036947"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR     8.273577    8.364667 -121.036947
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.479365804E-02"
Evaluating: 7.479365804E-02*360.0
 Parameter: XPHI <- "26.9257169"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.681854196"
Evaluating: 0.681854196*360.0
 Parameter: YPHI <- "245.467511"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.943724151"
Evaluating: 0.943724151*360.0
 Parameter: ZPHI <- "339.740694"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.2264228"
 Parameter: YPOS -> "-11.1353327"
 Parameter: ZPOS -> "-2.33944679"
 Parameter: XPHI -> "26.9257169"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.891594    0.452835
    0.000000   -0.452835    0.891594

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   26.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.2264228"
 Parameter: YPOS -> "-11.1353327"
 Parameter: ZPOS -> "-2.33944679"
 Parameter: YPHI -> "245.467511"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.415209    0.000000    0.909726
    0.000000    1.000000    0.000000
   -0.909726    0.000000   -0.415209

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  114.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.2264228"
 Parameter: YPOS -> "-11.1353327"
 Parameter: ZPOS -> "-2.33944679"
 Parameter: ZPHI -> "339.740694"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.938135   -0.346269    0.000000
    0.346269    0.938135    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   20.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.226423 XMAX =  -11.226423 XAVE =  -11.226423
    YMIN =  -11.135333 YMAX =  -11.135333 YAVE =  -11.135333
    ZMIN =   -2.339447 ZMAX =   -2.339447 ZAVE =   -2.339447
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.2264229"
Evaluating: -11.2264229+3.5
 Parameter: XMAX <- "-7.7264229"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.1353328"
Evaluating: -11.1353328+3.5
 Parameter: YMAX <- "-7.6353328"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-2.33944671"
Evaluating: -2.33944671+3.5
 Parameter: ZMAX <- "1.16055329"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.2264229"
Evaluating: -11.2264229-3.5
 Parameter: XMIN <- "-14.7264229"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.1353328"
Evaluating: -11.1353328-3.5
 Parameter: YMIN <- "-14.6353328"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-2.33944671"
Evaluating: -2.33944671-3.5
 Parameter: ZMIN <- "-5.83944671"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-7.7264229"
 Parameter: XMIN -> "-14.7264229"
 Parameter: YMAX -> "-7.6353328"
 Parameter: YMIN -> "-14.6353328"
 Parameter: ZMAX -> "1.16055329"
 Parameter: ZMIN -> "-5.83944671"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-11.1353327"
 Parameter: YPOS -> "-11.1353327"
 Parameter: XPOS -> "-11.2264228"
 Parameter: XPOS -> "-11.2264228"
Evaluating: SQRT(-11.1353327*-11.1353327+-11.2264228*-11.2264228)
 Parameter: DIST <- "15.8122801"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "15.8122801" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "9"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "9" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "9" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "7.254181033E-02"
Evaluating: (39-9.0)*(7.254181033E-02-0.5)
 Parameter: XPOS <- "-12.8237457"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.278684627"
Evaluating: (39-9.0)*(0.278684627-0.5)
 Parameter: YPOS <- "-6.63946119"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.736713192"
Evaluating: (237.395-9.0)*(0.736713192-0.5)
 Parameter: ZPOS <- "54.0641095"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.8237457"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -12.8237457--19.5
 Parameter: XTRAN <- "6.6762543"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.63946119"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -6.63946119--19.5
 Parameter: YTRAN <- "12.8605388"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "54.0641095"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 54.0641095-118.6975
 Parameter: ZTRAN <- "-64.6333905"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.6762543"
 Parameter: YTRAN -> "12.8605388"
 Parameter: ZTRAN -> "-64.6333905"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR     6.676254   12.860539  -64.633391
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.22602717"
Evaluating: 0.22602717*360.0
 Parameter: XPHI <- "81.3697812"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.617353016"
Evaluating: 0.617353016*360.0
 Parameter: YPHI <- "222.247086"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.519134123"
Evaluating: 0.519134123*360.0
 Parameter: ZPHI <- "186.888284"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.8237457"
 Parameter: YPOS -> "-6.63946119"
 Parameter: ZPOS -> "54.0641095"
 Parameter: XPHI -> "81.3697812"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.150057    0.988677
    0.000000   -0.988677    0.150057

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   81.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.8237457"
 Parameter: YPOS -> "-6.63946119"
 Parameter: ZPOS -> "54.0641095"
 Parameter: YPHI -> "222.247086"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.740252    0.000000    0.672329
    0.000000    1.000000    0.000000
   -0.672329    0.000000   -0.740252

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  137.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.8237457"
 Parameter: YPOS -> "-6.63946119"
 Parameter: ZPOS -> "54.0641095"
 Parameter: ZPHI -> "186.888284"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.992782   -0.119934    0.000000
    0.119934   -0.992782    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  173.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.823746 XMAX =  -12.823746 XAVE =  -12.823746
    YMIN =   -6.639461 YMAX =   -6.639461 YAVE =   -6.639461
    ZMIN =   54.064109 ZMAX =   54.064109 ZAVE =   54.064109
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.8237457"
Evaluating: -12.8237457+3.5
 Parameter: XMAX <- "-9.3237457"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.63946119"
Evaluating: -6.63946119+3.5
 Parameter: YMAX <- "-3.13946119"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "54.0641095"
Evaluating: 54.0641095+3.5
 Parameter: ZMAX <- "57.5641095"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.8237457"
Evaluating: -12.8237457-3.5
 Parameter: XMIN <- "-16.3237457"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.63946119"
Evaluating: -6.63946119-3.5
 Parameter: YMIN <- "-10.1394612"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "54.0641095"
Evaluating: 54.0641095-3.5
 Parameter: ZMIN <- "50.5641095"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.3237457"
 Parameter: XMIN -> "-16.3237457"
 Parameter: YMAX -> "-3.13946119"
 Parameter: YMIN -> "-10.1394612"
 Parameter: ZMAX -> "57.5641095"
 Parameter: ZMIN -> "50.5641095"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-6.63946119"
 Parameter: YPOS -> "-6.63946119"
 Parameter: XPOS -> "-12.8237457"
 Parameter: XPOS -> "-12.8237457"
Evaluating: SQRT(-6.63946119*-6.63946119+-12.8237457*-12.8237457)
 Parameter: DIST <- "14.440599"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "14.440599" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "10"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "10" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "10" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.959148357"
Evaluating: (39-9.0)*(0.959148357-0.5)
 Parameter: XPOS <- "13.7744507"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.310806748"
Evaluating: (39-9.0)*(0.310806748-0.5)
 Parameter: YPOS <- "-5.67579756"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.306522777"
Evaluating: (237.395-9.0)*(0.306522777-0.5)
 Parameter: ZPOS <- "-44.1892303"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.7744507"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 13.7744507--19.5
 Parameter: XTRAN <- "33.2744507"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.67579756"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -5.67579756--19.5
 Parameter: YTRAN <- "13.8242024"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-44.1892303"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -44.1892303-118.6975
 Parameter: ZTRAN <- "-162.88673"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.2744507"
 Parameter: YTRAN -> "13.8242024"
 Parameter: ZTRAN -> "-162.88673"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    33.274451   13.824202 -162.886730
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.31576651"
Evaluating: 0.31576651*360.0
 Parameter: XPHI <- "113.675944"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.343262339"
Evaluating: 0.343262339*360.0
 Parameter: YPHI <- "123.574442"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.167137711"
Evaluating: 0.167137711*360.0
 Parameter: ZPHI <- "60.169576"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.7744507"
 Parameter: YPOS -> "-5.67579756"
 Parameter: ZPOS -> "-44.1892303"
 Parameter: XPHI -> "113.675944"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.401563    0.915831
    0.000000   -0.915831   -0.401563

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  113.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.7744507"
 Parameter: YPOS -> "-5.67579756"
 Parameter: ZPOS -> "-44.1892303"
 Parameter: YPHI -> "123.574442"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.553020    0.000000   -0.833168
    0.000000    1.000000    0.000000
    0.833168    0.000000   -0.553020

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  123.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.7744507"
 Parameter: YPOS -> "-5.67579756"
 Parameter: ZPOS -> "-44.1892303"
 Parameter: ZPHI -> "60.169576"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.497435    0.867501    0.000000
   -0.867501    0.497435    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   60.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.774451 XMAX =   13.774451 XAVE =   13.774451
    YMIN =   -5.675797 YMAX =   -5.675797 YAVE =   -5.675797
    ZMIN =  -44.189230 ZMAX =  -44.189230 ZAVE =  -44.189230
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.774451"
Evaluating: 13.774451+3.5
 Parameter: XMAX <- "17.274451"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.67579748"
Evaluating: -5.67579748+3.5
 Parameter: YMAX <- "-2.17579748"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-44.1892303"
Evaluating: -44.1892303+3.5
 Parameter: ZMAX <- "-40.6892303"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.774451"
Evaluating: 13.774451-3.5
 Parameter: XMIN <- "10.274451"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.67579748"
Evaluating: -5.67579748-3.5
 Parameter: YMIN <- "-9.17579748"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-44.1892303"
Evaluating: -44.1892303-3.5
 Parameter: ZMIN <- "-47.6892303"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.274451"
 Parameter: XMIN -> "10.274451"
 Parameter: YMAX -> "-2.17579748"
 Parameter: YMIN -> "-9.17579748"
 Parameter: ZMAX -> "-40.6892303"
 Parameter: ZMIN -> "-47.6892303"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-5.67579756"
 Parameter: YPOS -> "-5.67579756"
 Parameter: XPOS -> "13.7744507"
 Parameter: XPOS -> "13.7744507"
Evaluating: SQRT(-5.67579756*-5.67579756+13.7744507*13.7744507)
 Parameter: DIST <- "14.8979921"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "14.8979921" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "11"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "11" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "11" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.826058098"
Evaluating: (39-9.0)*(0.826058098-0.5)
 Parameter: XPOS <- "9.78174294"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.671636083"
Evaluating: (39-9.0)*(0.671636083-0.5)
 Parameter: YPOS <- "5.14908249"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.764543792"
Evaluating: (237.395-9.0)*(0.764543792-0.5)
 Parameter: ZPOS <- "60.4204794"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.78174294"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 9.78174294--19.5
 Parameter: XTRAN <- "29.2817429"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.14908249"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 5.14908249--19.5
 Parameter: YTRAN <- "24.6490825"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "60.4204794"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 60.4204794-118.6975
 Parameter: ZTRAN <- "-58.2770206"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.2817429"
 Parameter: YTRAN -> "24.6490825"
 Parameter: ZTRAN -> "-58.2770206"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    29.281743   24.649082  -58.277021
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.926504396"
Evaluating: 0.926504396*360.0
 Parameter: XPHI <- "333.541583"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.281712869"
Evaluating: 0.281712869*360.0
 Parameter: YPHI <- "101.416633"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.213096772"
Evaluating: 0.213096772*360.0
 Parameter: ZPHI <- "76.7148379"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.78174294"
 Parameter: YPOS -> "5.14908249"
 Parameter: ZPOS -> "60.4204794"
 Parameter: XPHI -> "333.541583"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.895258   -0.445548
    0.000000    0.445548    0.895258

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   26.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.78174294"
 Parameter: YPOS -> "5.14908249"
 Parameter: ZPOS -> "60.4204794"
 Parameter: YPHI -> "101.416633"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.197942    0.000000   -0.980214
    0.000000    1.000000    0.000000
    0.980214    0.000000   -0.197942

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  101.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.78174294"
 Parameter: YPOS -> "5.14908249"
 Parameter: ZPOS -> "60.4204794"
 Parameter: ZPHI -> "76.7148379"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.229798    0.973238    0.000000
   -0.973238    0.229798    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   76.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.781743 XMAX =    9.781743 XAVE =    9.781743
    YMIN =    5.149082 YMAX =    5.149082 YAVE =    5.149082
    ZMIN =   60.420479 ZMAX =   60.420479 ZAVE =   60.420479
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.78174295"
Evaluating: 9.78174295+3.5
 Parameter: XMAX <- "13.2817429"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.14908249"
Evaluating: 5.14908249+3.5
 Parameter: YMAX <- "8.64908249"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "60.4204794"
Evaluating: 60.4204794+3.5
 Parameter: ZMAX <- "63.9204794"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.78174295"
Evaluating: 9.78174295-3.5
 Parameter: XMIN <- "6.28174295"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.14908249"
Evaluating: 5.14908249-3.5
 Parameter: YMIN <- "1.64908249"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "60.4204794"
Evaluating: 60.4204794-3.5
 Parameter: ZMIN <- "56.9204794"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.2817429"
 Parameter: XMIN -> "6.28174295"
 Parameter: YMAX -> "8.64908249"
 Parameter: YMIN -> "1.64908249"
 Parameter: ZMAX -> "63.9204794"
 Parameter: ZMIN -> "56.9204794"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "5.14908249"
 Parameter: YPOS -> "5.14908249"
 Parameter: XPOS -> "9.78174294"
 Parameter: XPOS -> "9.78174294"
Evaluating: SQRT(5.14908249*5.14908249+9.78174294*9.78174294)
 Parameter: DIST <- "11.0542094"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "11.0542094" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "12"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "12" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "12" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.457113093"
Evaluating: (39-9.0)*(0.457113093-0.5)
 Parameter: XPOS <- "-1.28660721"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.673088369"
Evaluating: (39-9.0)*(0.673088369-0.5)
 Parameter: YPOS <- "5.19265107"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.769335689"
Evaluating: (237.395-9.0)*(0.769335689-0.5)
 Parameter: ZPOS <- "61.5149247"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.28660721"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -1.28660721--19.5
 Parameter: XTRAN <- "18.2133928"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.19265107"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 5.19265107--19.5
 Parameter: YTRAN <- "24.6926511"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "61.5149247"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 61.5149247-118.6975
 Parameter: ZTRAN <- "-57.1825753"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.2133928"
 Parameter: YTRAN -> "24.6926511"
 Parameter: ZTRAN -> "-57.1825753"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    18.213393   24.692651  -57.182575
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.475322097"
Evaluating: 0.475322097*360.0
 Parameter: XPHI <- "171.115955"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.951338791"
Evaluating: 0.951338791*360.0
 Parameter: YPHI <- "342.481965"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.276074837"
Evaluating: 0.276074837*360.0
 Parameter: ZPHI <- "99.3869413"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.28660721"
 Parameter: YPOS -> "5.19265107"
 Parameter: ZPOS -> "61.5149247"
 Parameter: XPHI -> "171.115955"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.988003    0.154435
    0.000000   -0.154435   -0.988003

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  171.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.28660721"
 Parameter: YPOS -> "5.19265107"
 Parameter: ZPOS -> "61.5149247"
 Parameter: YPHI -> "342.481965"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.953622    0.000000    0.301006
    0.000000    1.000000    0.000000
   -0.301006    0.000000    0.953622

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   17.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.28660721"
 Parameter: YPOS -> "5.19265107"
 Parameter: ZPOS -> "61.5149247"
 Parameter: ZPHI -> "99.3869413"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.163101    0.986609    0.000000
   -0.986609   -0.163101    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   99.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.286607 XMAX =   -1.286607 XAVE =   -1.286607
    YMIN =    5.192651 YMAX =    5.192651 YAVE =    5.192651
    ZMIN =   61.514925 ZMAX =   61.514925 ZAVE =   61.514925
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.28660724"
Evaluating: -1.28660724+3.5
 Parameter: XMAX <- "2.21339276"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.19265107"
Evaluating: 5.19265107+3.5
 Parameter: YMAX <- "8.69265107"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "61.5149247"
Evaluating: 61.5149247+3.5
 Parameter: ZMAX <- "65.0149247"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.28660724"
Evaluating: -1.28660724-3.5
 Parameter: XMIN <- "-4.78660724"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.19265107"
Evaluating: 5.19265107-3.5
 Parameter: YMIN <- "1.69265107"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "61.5149247"
Evaluating: 61.5149247-3.5
 Parameter: ZMIN <- "58.0149247"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.21339276"
 Parameter: XMIN -> "-4.78660724"
 Parameter: YMAX -> "8.69265107"
 Parameter: YMIN -> "1.69265107"
 Parameter: ZMAX -> "65.0149247"
 Parameter: ZMIN -> "58.0149247"
 SELRPN>     18 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "18"
 Comparing "18" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   2680
 SELRPN>     18 atoms have been selected out of   2680

            DISTANCES FOR SELECTED ATOMS
 2492 POS      POT      12       POT     -  95 NM       TUBE     1        C2N           2.7227
 2492 POS      POT      12       POT     - 173 NM       TUBE     1        C4T           3.9789
 2492 POS      POT      12       POT     - 252 NM       TUBE     1        C70           4.3924
 2492 POS      POT      12       POT     -1006 NM       TUBE     1        CRY           3.4703
 2492 POS      POT      12       POT     -1029 NM       TUBE     1        CSL           3.9250
 2492 POS      POT      12       POT     -1089 NM       TUBE     1        CU9           3.0208
 2492 POS      POT      12       POT     -1253 NM       TUBE     1        CYT           2.5735
 2492 POS      POT      12       POT     -1336 NM       TUBE     1        C114          2.7753
 2492 POS      POT      12       POT     -1658 NM       TUBE     1        C1A2          3.1602
 2492 POS      POT      12       POT     -1692 NM       TUBE     1        C1B0          3.0300
 2492 POS      POT      12       POT     -1776 NM       TUBE     1        C1DC          1.9537
 2492 POS      POT      12       POT     -1870 NM       TUBE     1        C1FY          1.0231
 2492 POS      POT      12       POT     -1943 NM       TUBE     1        C1HZ          1.6244
 2492 POS      POT      12       POT     -2025 NM       TUBE     1        C1K9          2.4650
 2492 POS      POT      12       POT     -2098 NM       TUBE     1        C1MA          2.8186
 2492 POS      POT      12       POT     -2111 NM       TUBE     1        C1MN          3.7982
 2492 POS      POT      12       POT     -2355 NM       TUBE     1        C1TF          1.8482
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        17
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "17"
 Comparing "17" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "12" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.657783023"
Evaluating: (39-9.0)*(0.657783023-0.5)
 Parameter: XPOS <- "4.73349069"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.761918599"
Evaluating: (39-9.0)*(0.761918599-0.5)
 Parameter: YPOS <- "7.85755797"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.739287964"
Evaluating: (237.395-9.0)*(0.739287964-0.5)
 Parameter: ZPOS <- "54.6521745"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.286607 XMAX =   -1.286607 XAVE =   -1.286607
    YMIN =    5.192651 YMAX =    5.192651 YAVE =    5.192651
    ZMIN =   61.514925 ZMAX =   61.514925 ZAVE =   61.514925
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.73349069"
 RDCMND substituted energy or value "?XAVE" to "-1.28660724"
Evaluating: 4.73349069--1.28660724
 Parameter: XTRAN <- "6.02009793"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.85755797"
 RDCMND substituted energy or value "?YAVE" to "5.19265107"
Evaluating: 7.85755797-5.19265107
 Parameter: YTRAN <- "2.6649069"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "54.6521745"
 RDCMND substituted energy or value "?ZAVE" to "61.5149247"
Evaluating: 54.6521745-61.5149247
 Parameter: ZTRAN <- "-6.8627502"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.02009793"
 Parameter: YTRAN -> "2.6649069"
 Parameter: ZTRAN -> "-6.8627502"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR     6.020098    2.664907   -6.862750
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.174892813"
Evaluating: 0.174892813*360.0
 Parameter: XPHI <- "62.9614127"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.15407145"
Evaluating: 0.15407145*360.0
 Parameter: YPHI <- "55.465722"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.547890194"
Evaluating: 0.547890194*360.0
 Parameter: ZPHI <- "197.24047"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.73349069"
 Parameter: YPOS -> "7.85755797"
 Parameter: ZPOS -> "54.6521745"
 Parameter: XPHI -> "62.9614127"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.454590    0.890701
    0.000000   -0.890701    0.454590

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   62.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.73349069"
 Parameter: YPOS -> "7.85755797"
 Parameter: ZPOS -> "54.6521745"
 Parameter: YPHI -> "55.465722"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.566899    0.000000   -0.823787
    0.000000    1.000000    0.000000
    0.823787    0.000000    0.566899

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   55.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.73349069"
 Parameter: YPOS -> "7.85755797"
 Parameter: ZPOS -> "54.6521745"
 Parameter: ZPHI -> "197.24047"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.955069   -0.296383    0.000000
    0.296383   -0.955069    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  162.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.733491 XMAX =    4.733491 XAVE =    4.733491
    YMIN =    7.857558 YMAX =    7.857558 YAVE =    7.857558
    ZMIN =   54.652174 ZMAX =   54.652174 ZAVE =   54.652174
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.73349069"
Evaluating: 4.73349069+3.5
 Parameter: XMAX <- "8.23349069"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.85755798"
Evaluating: 7.85755798+3.5
 Parameter: YMAX <- "11.357558"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "54.6521745"
Evaluating: 54.6521745+3.5
 Parameter: ZMAX <- "58.1521745"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.73349069"
Evaluating: 4.73349069-3.5
 Parameter: XMIN <- "1.23349069"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.85755798"
Evaluating: 7.85755798-3.5
 Parameter: YMIN <- "4.35755798"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "54.6521745"
Evaluating: 54.6521745-3.5
 Parameter: ZMIN <- "51.1521745"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.23349069"
 Parameter: XMIN -> "1.23349069"
 Parameter: YMAX -> "11.357558"
 Parameter: YMIN -> "4.35755798"
 Parameter: ZMAX -> "58.1521745"
 Parameter: ZMIN -> "51.1521745"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "7.85755797"
 Parameter: YPOS -> "7.85755797"
 Parameter: XPOS -> "4.73349069"
 Parameter: XPOS -> "4.73349069"
Evaluating: SQRT(7.85755797*7.85755797+4.73349069*4.73349069)
 Parameter: DIST <- "9.17317564"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "9.17317564" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "13"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "13" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "13"
Evaluating: 13
 Parameter: J <- "13"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "13" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.338526512"
Evaluating: (39-9.0)*(0.338526512-0.5)
 Parameter: XPOS <- "-4.84420464"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.629727488"
Evaluating: (39-9.0)*(0.629727488-0.5)
 Parameter: YPOS <- "3.89182464"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.134375351"
Evaluating: (237.395-9.0)*(0.134375351-0.5)
 Parameter: ZPOS <- "-83.5068417"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.84420464"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -4.84420464--19.5
 Parameter: XTRAN <- "14.6557954"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.89182464"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 3.89182464--19.5
 Parameter: YTRAN <- "23.3918246"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-83.5068417"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -83.5068417-118.6975
 Parameter: ZTRAN <- "-202.204342"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.6557954"
 Parameter: YTRAN -> "23.3918246"
 Parameter: ZTRAN -> "-202.204342"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    14.655795   23.391825 -202.204342
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.707593613E-02"
Evaluating: 1.707593613E-02*360.0
 Parameter: XPHI <- "6.14733701"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.707364778"
Evaluating: 0.707364778*360.0
 Parameter: YPHI <- "254.65132"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.796929344"
Evaluating: 0.796929344*360.0
 Parameter: ZPHI <- "286.894564"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.84420464"
 Parameter: YPOS -> "3.89182464"
 Parameter: ZPOS -> "-83.5068417"
 Parameter: XPHI -> "6.14733701"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.994250    0.107086
    0.000000   -0.107086    0.994250

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    6.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.84420464"
 Parameter: YPOS -> "3.89182464"
 Parameter: ZPOS -> "-83.5068417"
 Parameter: YPHI -> "254.65132"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.264692    0.000000    0.964333
    0.000000    1.000000    0.000000
   -0.964333    0.000000   -0.264692

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  105.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.84420464"
 Parameter: YPOS -> "3.89182464"
 Parameter: ZPOS -> "-83.5068417"
 Parameter: ZPHI -> "286.894564"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.290611   -0.956841    0.000000
    0.956841    0.290611    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   73.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.844205 XMAX =   -4.844205 XAVE =   -4.844205
    YMIN =    3.891824 YMAX =    3.891824 YAVE =    3.891824
    ZMIN =  -83.506842 ZMAX =  -83.506842 ZAVE =  -83.506842
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.84420466"
Evaluating: -4.84420466+3.5
 Parameter: XMAX <- "-1.34420466"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.89182434"
Evaluating: 3.89182434+3.5
 Parameter: YMAX <- "7.39182434"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-83.5068417"
Evaluating: -83.5068417+3.5
 Parameter: ZMAX <- "-80.0068417"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.84420466"
Evaluating: -4.84420466-3.5
 Parameter: XMIN <- "-8.34420466"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.89182434"
Evaluating: 3.89182434-3.5
 Parameter: YMIN <- "0.39182434"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-83.5068417"
Evaluating: -83.5068417-3.5
 Parameter: ZMIN <- "-87.0068417"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.34420466"
 Parameter: XMIN -> "-8.34420466"
 Parameter: YMAX -> "7.39182434"
 Parameter: YMIN -> "0.39182434"
 Parameter: ZMAX -> "-80.0068417"
 Parameter: ZMIN -> "-87.0068417"
 SELRPN>     14 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "14"
 Comparing "14" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   2680
 SELRPN>     14 atoms have been selected out of   2680

            DISTANCES FOR SELECTED ATOMS
 2493 POS      POT      13       POT     - 547 NM       TUBE     1        CF7           3.5521
 2493 POS      POT      13       POT     -1565 NM       TUBE     1        C17H          2.6708
 2493 POS      POT      13       POT     -1593 NM       TUBE     1        C189          3.6486
 2493 POS      POT      13       POT     -1759 NM       TUBE     1        C1CV          3.9786
 2493 POS      POT      13       POT     -1980 NM       TUBE     1        C1J0          2.4783
 2493 POS      POT      13       POT     -2318 NM       TUBE     1        C1SE          3.5190
 2493 POS      POT      13       POT     -2322 NM       TUBE     1        C1SI          1.8749
 2493 POS      POT      13       POT     -2328 NM       TUBE     1        C1SO          2.1435
 2493 POS      POT      13       POT     -2333 NM       TUBE     1        C1ST          2.9583
 2493 POS      POT      13       POT     -2334 NM       TUBE     1        C1SU          4.0201
 2493 POS      POT      13       POT     -2388 NM       TUBE     1        C1UC          3.6900
 2493 POS      POT      13       POT     -2390 NM       TUBE     1        C1UE          3.3112
 2493 POS      POT      13       POT     -2396 NM       TUBE     1        C1UK          3.3394
 2493 POS      POT      13       POT     -2463 NM       TUBE     1        C1WF          2.9758
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        14
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "14"
 Comparing "14" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "13"
Evaluating: 13
 Parameter: J <- "13"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "13" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.269638071"
Evaluating: (39-9.0)*(0.269638071-0.5)
 Parameter: XPOS <- "-6.91085787"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.770595376"
Evaluating: (39-9.0)*(0.770595376-0.5)
 Parameter: YPOS <- "8.11786128"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.401254512"
Evaluating: (237.395-9.0)*(0.401254512-0.5)
 Parameter: ZPOS <- "-22.5529757"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.844205 XMAX =   -4.844205 XAVE =   -4.844205
    YMIN =    3.891824 YMAX =    3.891824 YAVE =    3.891824
    ZMIN =  -83.506842 ZMAX =  -83.506842 ZAVE =  -83.506842
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.91085787"
 RDCMND substituted energy or value "?XAVE" to "-4.84420466"
Evaluating: -6.91085787--4.84420466
 Parameter: XTRAN <- "-2.06665321"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.11786128"
 RDCMND substituted energy or value "?YAVE" to "3.89182434"
Evaluating: 8.11786128-3.89182434
 Parameter: YTRAN <- "4.22603694"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.5529757"
 RDCMND substituted energy or value "?ZAVE" to "-83.5068417"
Evaluating: -22.5529757--83.5068417
 Parameter: ZTRAN <- "60.953866"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.06665321"
 Parameter: YTRAN -> "4.22603694"
 Parameter: ZTRAN -> "60.953866"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    -2.066653    4.226037   60.953866
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.418498692"
Evaluating: 0.418498692*360.0
 Parameter: XPHI <- "150.659529"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.811585318"
Evaluating: 0.811585318*360.0
 Parameter: YPHI <- "292.170714"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.755803469"
Evaluating: 0.755803469*360.0
 Parameter: ZPHI <- "272.089249"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.91085787"
 Parameter: YPOS -> "8.11786128"
 Parameter: ZPOS -> "-22.5529757"
 Parameter: XPHI -> "150.659529"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.871723    0.489998
    0.000000   -0.489998   -0.871723

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  150.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.91085787"
 Parameter: YPOS -> "8.11786128"
 Parameter: ZPOS -> "-22.5529757"
 Parameter: YPHI -> "292.170714"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.377367    0.000000    0.926064
    0.000000    1.000000    0.000000
   -0.926064    0.000000    0.377367

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   67.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.91085787"
 Parameter: YPOS -> "8.11786128"
 Parameter: ZPOS -> "-22.5529757"
 Parameter: ZPHI -> "272.089249"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.036456   -0.999335    0.000000
    0.999335    0.036456    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   87.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.910858 XMAX =   -6.910858 XAVE =   -6.910858
    YMIN =    8.117861 YMAX =    8.117861 YAVE =    8.117861
    ZMIN =  -22.552976 ZMAX =  -22.552976 ZAVE =  -22.552976
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.91085789"
Evaluating: -6.91085789+3.5
 Parameter: XMAX <- "-3.41085789"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.11786125"
Evaluating: 8.11786125+3.5
 Parameter: YMAX <- "11.6178613"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.5529757"
Evaluating: -22.5529757+3.5
 Parameter: ZMAX <- "-19.0529757"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.91085789"
Evaluating: -6.91085789-3.5
 Parameter: XMIN <- "-10.4108579"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.11786125"
Evaluating: 8.11786125-3.5
 Parameter: YMIN <- "4.61786125"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.5529757"
Evaluating: -22.5529757-3.5
 Parameter: ZMIN <- "-26.0529757"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.41085789"
 Parameter: XMIN -> "-10.4108579"
 Parameter: YMAX -> "11.6178613"
 Parameter: YMIN -> "4.61786125"
 Parameter: ZMAX -> "-19.0529757"
 Parameter: ZMIN -> "-26.0529757"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "8.11786128"
 Parameter: YPOS -> "8.11786128"
 Parameter: XPOS -> "-6.91085787"
 Parameter: XPOS -> "-6.91085787"
Evaluating: SQRT(8.11786128*8.11786128+-6.91085787*-6.91085787)
 Parameter: DIST <- "10.661127"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "10.661127" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "14"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "14" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "14" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "5.427306886E-02"
Evaluating: (39-9.0)*(5.427306886E-02-0.5)
 Parameter: XPOS <- "-13.3718079"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "5.036687718E-02"
Evaluating: (39-9.0)*(5.036687718E-02-0.5)
 Parameter: YPOS <- "-13.4889937"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.396008153"
Evaluating: (237.395-9.0)*(0.396008153-0.5)
 Parameter: ZPOS <- "-23.7512179"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.3718079"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -13.3718079--19.5
 Parameter: XTRAN <- "6.1281921"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.4889937"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -13.4889937--19.5
 Parameter: YTRAN <- "6.0110063"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.7512179"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -23.7512179-118.6975
 Parameter: ZTRAN <- "-142.448718"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.1281921"
 Parameter: YTRAN -> "6.0110063"
 Parameter: ZTRAN -> "-142.448718"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR     6.128192    6.011006 -142.448718
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.295635422E-02"
Evaluating: 3.295635422E-02*360.0
 Parameter: XPHI <- "11.8642875"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.232725346E-02"
Evaluating: 4.232725346E-02*360.0
 Parameter: YPHI <- "15.2378112"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.672478289"
Evaluating: 0.672478289*360.0
 Parameter: ZPHI <- "242.092184"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.3718079"
 Parameter: YPOS -> "-13.4889937"
 Parameter: ZPOS -> "-23.7512179"
 Parameter: XPHI -> "11.8642875"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.978637    0.205594
    0.000000   -0.205594    0.978637

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   11.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.3718079"
 Parameter: YPOS -> "-13.4889937"
 Parameter: ZPOS -> "-23.7512179"
 Parameter: YPHI -> "15.2378112"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.964843    0.000000   -0.262826
    0.000000    1.000000    0.000000
    0.262826    0.000000    0.964843

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   15.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.3718079"
 Parameter: YPOS -> "-13.4889937"
 Parameter: ZPOS -> "-23.7512179"
 Parameter: ZPHI -> "242.092184"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.468050   -0.883702    0.000000
    0.883702   -0.468050    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  117.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.371808 XMAX =  -13.371808 XAVE =  -13.371808
    YMIN =  -13.488994 YMAX =  -13.488994 YAVE =  -13.488994
    ZMIN =  -23.751218 ZMAX =  -23.751218 ZAVE =  -23.751218
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.3718079"
Evaluating: -13.3718079+3.5
 Parameter: XMAX <- "-9.8718079"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.4889937"
Evaluating: -13.4889937+3.5
 Parameter: YMAX <- "-9.9889937"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.751218"
Evaluating: -23.751218+3.5
 Parameter: ZMAX <- "-20.251218"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.3718079"
Evaluating: -13.3718079-3.5
 Parameter: XMIN <- "-16.8718079"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.4889937"
Evaluating: -13.4889937-3.5
 Parameter: YMIN <- "-16.9889937"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.751218"
Evaluating: -23.751218-3.5
 Parameter: ZMIN <- "-27.251218"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.8718079"
 Parameter: XMIN -> "-16.8718079"
 Parameter: YMAX -> "-9.9889937"
 Parameter: YMIN -> "-16.9889937"
 Parameter: ZMAX -> "-20.251218"
 Parameter: ZMIN -> "-27.251218"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-13.4889937"
 Parameter: YPOS -> "-13.4889937"
 Parameter: XPOS -> "-13.3718079"
 Parameter: XPOS -> "-13.3718079"
Evaluating: SQRT(-13.4889937*-13.4889937+-13.3718079*-13.3718079)
 Parameter: DIST <- "18.9936357"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "18.9936357" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "15"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "15" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "15" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.514132025"
Evaluating: (39-9.0)*(0.514132025-0.5)
 Parameter: XPOS <- "0.42396075"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.496384095"
Evaluating: (39-9.0)*(0.496384095-0.5)
 Parameter: YPOS <- "-0.10847715"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.573048022"
Evaluating: (237.395-9.0)*(0.573048022-0.5)
 Parameter: ZPOS <- "16.683803"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.42396075"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 0.42396075--19.5
 Parameter: XTRAN <- "19.9239607"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.10847715"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -0.10847715--19.5
 Parameter: YTRAN <- "19.3915229"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.683803"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 16.683803-118.6975
 Parameter: ZTRAN <- "-102.013697"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "19.9239607"
 Parameter: YTRAN -> "19.3915229"
 Parameter: ZTRAN -> "-102.013697"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    19.923961   19.391523 -102.013697
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.917816735"
Evaluating: 0.917816735*360.0
 Parameter: XPHI <- "330.414025"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.494801586"
Evaluating: 0.494801586*360.0
 Parameter: YPHI <- "178.128571"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.675839318"
Evaluating: 0.675839318*360.0
 Parameter: ZPHI <- "243.302154"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.42396075"
 Parameter: YPOS -> "-0.10847715"
 Parameter: ZPOS -> "16.683803"
 Parameter: XPHI -> "330.414025"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.869616   -0.493729
    0.000000    0.493729    0.869616

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   29.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.42396075"
 Parameter: YPOS -> "-0.10847715"
 Parameter: ZPOS -> "16.683803"
 Parameter: YPHI -> "178.128571"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.999467    0.000000   -0.032657
    0.000000    1.000000    0.000000
    0.032657    0.000000   -0.999467

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  178.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.42396075"
 Parameter: YPOS -> "-0.10847715"
 Parameter: ZPOS -> "16.683803"
 Parameter: ZPHI -> "243.302154"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.449285   -0.893388    0.000000
    0.893388   -0.449285    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  116.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.423961 XMAX =    0.423961 XAVE =    0.423961
    YMIN =   -0.108477 YMAX =   -0.108477 YAVE =   -0.108477
    ZMIN =   16.683803 ZMAX =   16.683803 ZAVE =   16.683803
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.423960689"
Evaluating: 0.423960689+3.5
 Parameter: XMAX <- "3.92396069"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.108477126"
Evaluating: -0.108477126+3.5
 Parameter: YMAX <- "3.39152287"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.683803"
Evaluating: 16.683803+3.5
 Parameter: ZMAX <- "20.183803"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.423960689"
Evaluating: 0.423960689-3.5
 Parameter: XMIN <- "-3.07603931"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.108477126"
Evaluating: -0.108477126-3.5
 Parameter: YMIN <- "-3.60847713"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.683803"
Evaluating: 16.683803-3.5
 Parameter: ZMIN <- "13.183803"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.92396069"
 Parameter: XMIN -> "-3.07603931"
 Parameter: YMAX -> "3.39152287"
 Parameter: YMIN -> "-3.60847713"
 Parameter: ZMAX -> "20.183803"
 Parameter: ZMIN -> "13.183803"
 SELRPN>     16 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16"
 Comparing "16" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   2680
 SELRPN>     16 atoms have been selected out of   2680

            DISTANCES FOR SELECTED ATOMS
 2495 POS      POT      15       POT     - 333 NM       TUBE     1        C99           4.4813
 2495 POS      POT      15       POT     - 545 NM       TUBE     1        CF5           4.1879
 2495 POS      POT      15       POT     -1119 NM       TUBE     1        CV3           4.0762
 2495 POS      POT      15       POT     -1968 NM       TUBE     1        C1IO          4.2055
 2495 POS      POT      15       POT     -1970 NM       TUBE     1        C1IQ          4.2955
 2495 POS      POT      15       POT     -2012 NM       TUBE     1        C1JW          4.3013
 2495 POS      POT      15       POT     -2096 NM       TUBE     1        C1M8          3.9739
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "15" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.108445497"
Evaluating: (39-9.0)*(0.108445497-0.5)
 Parameter: XPOS <- "-11.7466351"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.868338199"
Evaluating: (39-9.0)*(0.868338199-0.5)
 Parameter: YPOS <- "11.050146"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.473542416"
Evaluating: (237.395-9.0)*(0.473542416-0.5)
 Parameter: ZPOS <- "-6.0427799"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.423961 XMAX =    0.423961 XAVE =    0.423961
    YMIN =   -0.108477 YMAX =   -0.108477 YAVE =   -0.108477
    ZMIN =   16.683803 ZMAX =   16.683803 ZAVE =   16.683803
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.7466351"
 RDCMND substituted energy or value "?XAVE" to "0.423960689"
Evaluating: -11.7466351-0.423960689
 Parameter: XTRAN <- "-12.1705958"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.050146"
 RDCMND substituted energy or value "?YAVE" to "-0.108477126"
Evaluating: 11.050146--0.108477126
 Parameter: YTRAN <- "11.1586231"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-6.0427799"
 RDCMND substituted energy or value "?ZAVE" to "16.683803"
Evaluating: -6.0427799-16.683803
 Parameter: ZTRAN <- "-22.7265829"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.1705958"
 Parameter: YTRAN -> "11.1586231"
 Parameter: ZTRAN -> "-22.7265829"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR   -12.170596   11.158623  -22.726583
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.836229758"
Evaluating: 0.836229758*360.0
 Parameter: XPHI <- "301.042713"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.511740323"
Evaluating: 0.511740323*360.0
 Parameter: YPHI <- "184.226516"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.914803506E-02"
Evaluating: 1.914803506E-02*360.0
 Parameter: ZPHI <- "6.89329262"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.7466351"
 Parameter: YPOS -> "11.050146"
 Parameter: ZPOS -> "-6.0427799"
 Parameter: XPHI -> "301.042713"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.515677   -0.856783
    0.000000    0.856783    0.515677

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   58.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.7466351"
 Parameter: YPOS -> "11.050146"
 Parameter: ZPOS -> "-6.0427799"
 Parameter: YPHI -> "184.226516"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.997280    0.000000    0.073700
    0.000000    1.000000    0.000000
   -0.073700    0.000000   -0.997280

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  175.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.7466351"
 Parameter: YPOS -> "11.050146"
 Parameter: ZPOS -> "-6.0427799"
 Parameter: ZPHI -> "6.89329262"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.992771    0.120021    0.000000
   -0.120021    0.992771    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    6.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.746635 XMAX =  -11.746635 XAVE =  -11.746635
    YMIN =   11.050146 YMAX =   11.050146 YAVE =   11.050146
    ZMIN =   -6.042780 ZMAX =   -6.042780 ZAVE =   -6.042780
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.7466351"
Evaluating: -11.7466351+3.5
 Parameter: XMAX <- "-8.2466351"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.050146"
Evaluating: 11.050146+3.5
 Parameter: YMAX <- "14.550146"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-6.04277986"
Evaluating: -6.04277986+3.5
 Parameter: ZMAX <- "-2.54277986"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.7466351"
Evaluating: -11.7466351-3.5
 Parameter: XMIN <- "-15.2466351"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.050146"
Evaluating: 11.050146-3.5
 Parameter: YMIN <- "7.550146"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-6.04277986"
Evaluating: -6.04277986-3.5
 Parameter: ZMIN <- "-9.54277986"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.2466351"
 Parameter: XMIN -> "-15.2466351"
 Parameter: YMAX -> "14.550146"
 Parameter: YMIN -> "7.550146"
 Parameter: ZMAX -> "-2.54277986"
 Parameter: ZMIN -> "-9.54277986"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "11.050146"
 Parameter: YPOS -> "11.050146"
 Parameter: XPOS -> "-11.7466351"
 Parameter: XPOS -> "-11.7466351"
Evaluating: SQRT(11.050146*11.050146+-11.7466351*-11.7466351)
 Parameter: DIST <- "16.1272801"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "16.1272801" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "16"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "16" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "16" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.756209309"
Evaluating: (39-9.0)*(0.756209309-0.5)
 Parameter: XPOS <- "7.68627927"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.569911901"
Evaluating: (39-9.0)*(0.569911901-0.5)
 Parameter: YPOS <- "2.09735703"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.143774463"
Evaluating: (237.395-9.0)*(0.143774463-0.5)
 Parameter: ZPOS <- "-81.3601315"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.68627927"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 7.68627927--19.5
 Parameter: XTRAN <- "27.1862793"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.09735703"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 2.09735703--19.5
 Parameter: YTRAN <- "21.597357"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-81.3601315"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -81.3601315-118.6975
 Parameter: ZTRAN <- "-200.057632"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "27.1862793"
 Parameter: YTRAN -> "21.597357"
 Parameter: ZTRAN -> "-200.057632"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    27.186279   21.597357 -200.057632
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.940883007"
Evaluating: 0.940883007*360.0
 Parameter: XPHI <- "338.717883"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.836092797"
Evaluating: 0.836092797*360.0
 Parameter: YPHI <- "300.993407"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.433173083"
Evaluating: 0.433173083*360.0
 Parameter: ZPHI <- "155.94231"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.68627927"
 Parameter: YPOS -> "2.09735703"
 Parameter: ZPOS -> "-81.3601315"
 Parameter: XPHI -> "338.717883"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.931805   -0.362960
    0.000000    0.362960    0.931805

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   21.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.68627927"
 Parameter: YPOS -> "2.09735703"
 Parameter: ZPOS -> "-81.3601315"
 Parameter: YPHI -> "300.993407"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.514939    0.000000    0.857227
    0.000000    1.000000    0.000000
   -0.857227    0.000000    0.514939

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   59.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.68627927"
 Parameter: YPOS -> "2.09735703"
 Parameter: ZPOS -> "-81.3601315"
 Parameter: ZPHI -> "155.94231"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.913135    0.407656    0.000000
   -0.407656   -0.913135    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  155.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.686280 XMAX =    7.686280 XAVE =    7.686280
    YMIN =    2.097357 YMAX =    2.097357 YAVE =    2.097357
    ZMIN =  -81.360132 ZMAX =  -81.360132 ZAVE =  -81.360132
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.68627969"
Evaluating: 7.68627969+3.5
 Parameter: XMAX <- "11.1862797"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.09735705"
Evaluating: 2.09735705+3.5
 Parameter: YMAX <- "5.59735705"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-81.3601318"
Evaluating: -81.3601318+3.5
 Parameter: ZMAX <- "-77.8601318"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.68627969"
Evaluating: 7.68627969-3.5
 Parameter: XMIN <- "4.18627969"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.09735705"
Evaluating: 2.09735705-3.5
 Parameter: YMIN <- "-1.40264295"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-81.3601318"
Evaluating: -81.3601318-3.5
 Parameter: ZMIN <- "-84.8601318"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.1862797"
 Parameter: XMIN -> "4.18627969"
 Parameter: YMAX -> "5.59735705"
 Parameter: YMIN -> "-1.40264295"
 Parameter: ZMAX -> "-77.8601318"
 Parameter: ZMIN -> "-84.8601318"
 SELRPN>      7 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   2680
 SELRPN>      7 atoms have been selected out of   2680

            DISTANCES FOR SELECTED ATOMS
 2496 POS      POT      16       POT     - 205 NM       TUBE     1        C5P           3.9069
 2496 POS      POT      16       POT     - 207 NM       TUBE     1        C5R           3.7666
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "16" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.468740102"
Evaluating: (39-9.0)*(0.468740102-0.5)
 Parameter: XPOS <- "-0.93779694"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.12024098"
Evaluating: (39-9.0)*(0.12024098-0.5)
 Parameter: YPOS <- "-11.3927706"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.52342409"
Evaluating: (237.395-9.0)*(0.52342409-0.5)
 Parameter: ZPOS <- "5.34994504"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.686280 XMAX =    7.686280 XAVE =    7.686280
    YMIN =    2.097357 YMAX =    2.097357 YAVE =    2.097357
    ZMIN =  -81.360132 ZMAX =  -81.360132 ZAVE =  -81.360132
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.93779694"
 RDCMND substituted energy or value "?XAVE" to "7.68627969"
Evaluating: -0.93779694-7.68627969
 Parameter: XTRAN <- "-8.62407663"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.3927706"
 RDCMND substituted energy or value "?YAVE" to "2.09735705"
Evaluating: -11.3927706-2.09735705
 Parameter: YTRAN <- "-13.4901276"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "5.34994504"
 RDCMND substituted energy or value "?ZAVE" to "-81.3601318"
Evaluating: 5.34994504--81.3601318
 Parameter: ZTRAN <- "86.7100768"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.62407663"
 Parameter: YTRAN -> "-13.4901276"
 Parameter: ZTRAN -> "86.7100768"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    -8.624077  -13.490128   86.710077
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.726220242"
Evaluating: 0.726220242*360.0
 Parameter: XPHI <- "261.439287"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.520768528"
Evaluating: 0.520768528*360.0
 Parameter: YPHI <- "187.47667"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.864348669"
Evaluating: 0.864348669*360.0
 Parameter: ZPHI <- "311.165521"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.93779694"
 Parameter: YPOS -> "-11.3927706"
 Parameter: ZPOS -> "5.34994504"
 Parameter: XPHI -> "261.439287"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.148857   -0.988859
    0.000000    0.988859   -0.148857

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   98.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.93779694"
 Parameter: YPOS -> "-11.3927706"
 Parameter: ZPOS -> "5.34994504"
 Parameter: YPHI -> "187.47667"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.991498    0.000000    0.130122
    0.000000    1.000000    0.000000
   -0.130122    0.000000   -0.991498

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  172.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.93779694"
 Parameter: YPOS -> "-11.3927706"
 Parameter: ZPOS -> "5.34994504"
 Parameter: ZPHI -> "311.165521"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.658237   -0.752811    0.000000
    0.752811    0.658237    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   48.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.937797 XMAX =   -0.937797 XAVE =   -0.937797
    YMIN =  -11.392771 YMAX =  -11.392771 YAVE =  -11.392771
    ZMIN =    5.349945 ZMAX =    5.349945 ZAVE =    5.349945
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.937796939"
Evaluating: -0.937796939+3.5
 Parameter: XMAX <- "2.56220306"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.3927706"
Evaluating: -11.3927706+3.5
 Parameter: YMAX <- "-7.8927706"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "5.34994499"
Evaluating: 5.34994499+3.5
 Parameter: ZMAX <- "8.84994499"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.937796939"
Evaluating: -0.937796939-3.5
 Parameter: XMIN <- "-4.43779694"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.3927706"
Evaluating: -11.3927706-3.5
 Parameter: YMIN <- "-14.8927706"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "5.34994499"
Evaluating: 5.34994499-3.5
 Parameter: ZMIN <- "1.84994499"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.56220306"
 Parameter: XMIN -> "-4.43779694"
 Parameter: YMAX -> "-7.8927706"
 Parameter: YMIN -> "-14.8927706"
 Parameter: ZMAX -> "8.84994499"
 Parameter: ZMIN -> "1.84994499"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-11.3927706"
 Parameter: YPOS -> "-11.3927706"
 Parameter: XPOS -> "-0.93779694"
 Parameter: XPOS -> "-0.93779694"
Evaluating: SQRT(-11.3927706*-11.3927706+-0.93779694*-0.93779694)
 Parameter: DIST <- "11.4313029"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "11.4313029" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "17"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "17" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "17" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.30791705"
Evaluating: (39-9.0)*(0.30791705-0.5)
 Parameter: XPOS <- "-5.7624885"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.174623871"
Evaluating: (39-9.0)*(0.174623871-0.5)
 Parameter: YPOS <- "-9.76128387"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.45285141"
Evaluating: (237.395-9.0)*(0.45285141-0.5)
 Parameter: ZPOS <- "-10.7685022"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.7624885"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -5.7624885--19.5
 Parameter: XTRAN <- "13.7375115"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.76128387"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -9.76128387--19.5
 Parameter: YTRAN <- "9.73871613"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-10.7685022"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -10.7685022-118.6975
 Parameter: ZTRAN <- "-129.466002"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.7375115"
 Parameter: YTRAN -> "9.73871613"
 Parameter: ZTRAN -> "-129.466002"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    13.737512    9.738716 -129.466002
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.653640068"
Evaluating: 0.653640068*360.0
 Parameter: XPHI <- "235.310424"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.134250212"
Evaluating: 0.134250212*360.0
 Parameter: YPHI <- "48.3300763"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.91868617"
Evaluating: 0.91868617*360.0
 Parameter: ZPHI <- "330.727021"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.7624885"
 Parameter: YPOS -> "-9.76128387"
 Parameter: ZPOS -> "-10.7685022"
 Parameter: XPHI -> "235.310424"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.569130   -0.822248
    0.000000    0.822248   -0.569130

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  124.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.7624885"
 Parameter: YPOS -> "-9.76128387"
 Parameter: ZPOS -> "-10.7685022"
 Parameter: YPHI -> "48.3300763"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.664838    0.000000   -0.746987
    0.000000    1.000000    0.000000
    0.746987    0.000000    0.664838

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   48.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.7624885"
 Parameter: YPOS -> "-9.76128387"
 Parameter: ZPOS -> "-10.7685022"
 Parameter: ZPHI -> "330.727021"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.872300   -0.488971    0.000000
    0.488971    0.872300    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   29.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.762488 XMAX =   -5.762488 XAVE =   -5.762488
    YMIN =   -9.761284 YMAX =   -9.761284 YAVE =   -9.761284
    ZMIN =  -10.768502 ZMAX =  -10.768502 ZAVE =  -10.768502
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.76248835"
Evaluating: -5.76248835+3.5
 Parameter: XMAX <- "-2.26248835"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.76128397"
Evaluating: -9.76128397+3.5
 Parameter: YMAX <- "-6.26128397"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-10.7685023"
Evaluating: -10.7685023+3.5
 Parameter: ZMAX <- "-7.2685023"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.76248835"
Evaluating: -5.76248835-3.5
 Parameter: XMIN <- "-9.26248835"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.76128397"
Evaluating: -9.76128397-3.5
 Parameter: YMIN <- "-13.261284"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-10.7685023"
Evaluating: -10.7685023-3.5
 Parameter: ZMIN <- "-14.2685023"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.26248835"
 Parameter: XMIN -> "-9.26248835"
 Parameter: YMAX -> "-6.26128397"
 Parameter: YMIN -> "-13.261284"
 Parameter: ZMAX -> "-7.2685023"
 Parameter: ZMIN -> "-14.2685023"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-9.76128387"
 Parameter: YPOS -> "-9.76128387"
 Parameter: XPOS -> "-5.7624885"
 Parameter: XPOS -> "-5.7624885"
Evaluating: SQRT(-9.76128387*-9.76128387+-5.7624885*-5.7624885)
 Parameter: DIST <- "11.335296"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "11.335296" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "18"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "18" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "18" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "5.172929575E-02"
Evaluating: (39-9.0)*(5.172929575E-02-0.5)
 Parameter: XPOS <- "-13.4481211"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.764444567"
Evaluating: (39-9.0)*(0.764444567-0.5)
 Parameter: YPOS <- "7.93333701"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "2.988301896E-03"
Evaluating: (237.395-9.0)*(2.988301896E-03-0.5)
 Parameter: ZPOS <- "-113.514987"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.4481211"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -13.4481211--19.5
 Parameter: XTRAN <- "6.0518789"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.93333701"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 7.93333701--19.5
 Parameter: YTRAN <- "27.433337"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-113.514987"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -113.514987-118.6975
 Parameter: ZTRAN <- "-232.212487"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.0518789"
 Parameter: YTRAN -> "27.433337"
 Parameter: ZTRAN -> "-232.212487"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR     6.051879   27.433337 -232.212487
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.226024549"
Evaluating: 0.226024549*360.0
 Parameter: XPHI <- "81.3688376"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.441520531"
Evaluating: 0.441520531*360.0
 Parameter: YPHI <- "158.947391"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.758290723"
Evaluating: 0.758290723*360.0
 Parameter: ZPHI <- "272.98466"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.4481211"
 Parameter: YPOS -> "7.93333701"
 Parameter: ZPOS -> "-113.514987"
 Parameter: XPHI -> "81.3688376"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.150073    0.988675
    0.000000   -0.988675    0.150073

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   81.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.4481211"
 Parameter: YPOS -> "7.93333701"
 Parameter: ZPOS -> "-113.514987"
 Parameter: YPHI -> "158.947391"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.933251    0.000000   -0.359225
    0.000000    1.000000    0.000000
    0.359225    0.000000   -0.933251

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  158.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.4481211"
 Parameter: YPOS -> "7.93333701"
 Parameter: ZPOS -> "-113.514987"
 Parameter: ZPHI -> "272.98466"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.052069   -0.998644    0.000000
    0.998644    0.052069    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   87.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.448121 XMAX =  -13.448121 XAVE =  -13.448121
    YMIN =    7.933337 YMAX =    7.933337 YAVE =    7.933337
    ZMIN = -113.514987 ZMAX = -113.514987 ZAVE = -113.514987
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.4481211"
Evaluating: -13.4481211+3.5
 Parameter: XMAX <- "-9.9481211"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.93333701"
Evaluating: 7.93333701+3.5
 Parameter: YMAX <- "11.433337"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-113.514987"
Evaluating: -113.514987+3.5
 Parameter: ZMAX <- "-110.014987"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.4481211"
Evaluating: -13.4481211-3.5
 Parameter: XMIN <- "-16.9481211"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.93333701"
Evaluating: 7.93333701-3.5
 Parameter: YMIN <- "4.43333701"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-113.514987"
Evaluating: -113.514987-3.5
 Parameter: ZMIN <- "-117.014987"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.9481211"
 Parameter: XMIN -> "-16.9481211"
 Parameter: YMAX -> "11.433337"
 Parameter: YMIN -> "4.43333701"
 Parameter: ZMAX -> "-110.014987"
 Parameter: ZMIN -> "-117.014987"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "7.93333701"
 Parameter: YPOS -> "7.93333701"
 Parameter: XPOS -> "-13.4481211"
 Parameter: XPOS -> "-13.4481211"
Evaluating: SQRT(7.93333701*7.93333701+-13.4481211*-13.4481211)
 Parameter: DIST <- "15.6137695"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "15.6137695" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "19"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "19" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "19" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.896901583"
Evaluating: (39-9.0)*(0.896901583-0.5)
 Parameter: XPOS <- "11.9070475"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.908950836"
Evaluating: (39-9.0)*(0.908950836-0.5)
 Parameter: YPOS <- "12.2685251"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.682776463"
Evaluating: (237.395-9.0)*(0.682776463-0.5)
 Parameter: ZPOS <- "41.7452303"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.9070475"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 11.9070475--19.5
 Parameter: XTRAN <- "31.4070475"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.2685251"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 12.2685251--19.5
 Parameter: YTRAN <- "31.7685251"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.7452303"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 41.7452303-118.6975
 Parameter: ZTRAN <- "-76.9522697"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.4070475"
 Parameter: YTRAN -> "31.7685251"
 Parameter: ZTRAN -> "-76.9522697"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    31.407048   31.768525  -76.952270
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.190524541"
Evaluating: 0.190524541*360.0
 Parameter: XPHI <- "68.5888348"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.174639476"
Evaluating: 0.174639476*360.0
 Parameter: YPHI <- "62.8702114"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.459327063"
Evaluating: 0.459327063*360.0
 Parameter: ZPHI <- "165.357743"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.9070475"
 Parameter: YPOS -> "12.2685251"
 Parameter: ZPOS -> "41.7452303"
 Parameter: XPHI -> "68.5888348"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.365058    0.930985
    0.000000   -0.930985    0.365058

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   68.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.9070475"
 Parameter: YPOS -> "12.2685251"
 Parameter: ZPOS -> "41.7452303"
 Parameter: YPHI -> "62.8702114"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.456008    0.000000   -0.889976
    0.000000    1.000000    0.000000
    0.889976    0.000000    0.456008

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   62.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.9070475"
 Parameter: YPOS -> "12.2685251"
 Parameter: ZPOS -> "41.7452303"
 Parameter: ZPHI -> "165.357743"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.967523    0.252783    0.000000
   -0.252783   -0.967523    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  165.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.907047 XMAX =   11.907047 XAVE =   11.907047
    YMIN =   12.268525 YMAX =   12.268525 YAVE =   12.268525
    ZMIN =   41.745230 ZMAX =   41.745230 ZAVE =   41.745230
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.9070475"
Evaluating: 11.9070475+3.5
 Parameter: XMAX <- "15.4070475"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.2685251"
Evaluating: 12.2685251+3.5
 Parameter: YMAX <- "15.7685251"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.7452303"
Evaluating: 41.7452303+3.5
 Parameter: ZMAX <- "45.2452303"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.9070475"
Evaluating: 11.9070475-3.5
 Parameter: XMIN <- "8.4070475"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.2685251"
Evaluating: 12.2685251-3.5
 Parameter: YMIN <- "8.7685251"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.7452303"
Evaluating: 41.7452303-3.5
 Parameter: ZMIN <- "38.2452303"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.4070475"
 Parameter: XMIN -> "8.4070475"
 Parameter: YMAX -> "15.7685251"
 Parameter: YMIN -> "8.7685251"
 Parameter: ZMAX -> "45.2452303"
 Parameter: ZMIN -> "38.2452303"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "12.2685251"
 Parameter: YPOS -> "12.2685251"
 Parameter: XPOS -> "11.9070475"
 Parameter: XPOS -> "11.9070475"
Evaluating: SQRT(12.2685251*12.2685251+11.9070475*11.9070475)
 Parameter: DIST <- "17.0966221"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "17.0966221" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "20"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "20" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "20" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.528580408"
Evaluating: (39-9.0)*(0.528580408-0.5)
 Parameter: XPOS <- "0.85741224"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.195773808"
Evaluating: (39-9.0)*(0.195773808-0.5)
 Parameter: YPOS <- "-9.12678576"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.696849509"
Evaluating: (237.395-9.0)*(0.696849509-0.5)
 Parameter: ZPOS <- "44.9594436"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.85741224"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 0.85741224--19.5
 Parameter: XTRAN <- "20.3574122"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.12678576"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -9.12678576--19.5
 Parameter: YTRAN <- "10.3732142"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.9594436"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 44.9594436-118.6975
 Parameter: ZTRAN <- "-73.7380564"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.3574122"
 Parameter: YTRAN -> "10.3732142"
 Parameter: ZTRAN -> "-73.7380564"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    20.357412   10.373214  -73.738056
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.3119229"
Evaluating: 0.3119229*360.0
 Parameter: XPHI <- "112.292244"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.910050441"
Evaluating: 0.910050441*360.0
 Parameter: YPHI <- "327.618159"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.664921163"
Evaluating: 0.664921163*360.0
 Parameter: ZPHI <- "239.371619"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.85741224"
 Parameter: YPOS -> "-9.12678576"
 Parameter: ZPOS -> "44.9594436"
 Parameter: XPHI -> "112.292244"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.379331    0.925261
    0.000000   -0.925261   -0.379331

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  112.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.85741224"
 Parameter: YPOS -> "-9.12678576"
 Parameter: ZPOS -> "44.9594436"
 Parameter: YPHI -> "327.618159"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.844498    0.000000    0.535559
    0.000000    1.000000    0.000000
   -0.535559    0.000000    0.844498

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   32.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.85741224"
 Parameter: YPOS -> "-9.12678576"
 Parameter: ZPOS -> "44.9594436"
 Parameter: ZPHI -> "239.371619"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.509468   -0.860490    0.000000
    0.860490   -0.509468    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  120.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.857412 XMAX =    0.857412 XAVE =    0.857412
    YMIN =   -9.126786 YMAX =   -9.126786 YAVE =   -9.126786
    ZMIN =   44.959444 ZMAX =   44.959444 ZAVE =   44.959444
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.857412234"
Evaluating: 0.857412234+3.5
 Parameter: XMAX <- "4.35741223"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.12678578"
Evaluating: -9.12678578+3.5
 Parameter: YMAX <- "-5.62678578"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.9594437"
Evaluating: 44.9594437+3.5
 Parameter: ZMAX <- "48.4594437"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.857412234"
Evaluating: 0.857412234-3.5
 Parameter: XMIN <- "-2.64258777"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.12678578"
Evaluating: -9.12678578-3.5
 Parameter: YMIN <- "-12.6267858"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.9594437"
Evaluating: 44.9594437-3.5
 Parameter: ZMIN <- "41.4594437"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.35741223"
 Parameter: XMIN -> "-2.64258777"
 Parameter: YMAX -> "-5.62678578"
 Parameter: YMIN -> "-12.6267858"
 Parameter: ZMAX -> "48.4594437"
 Parameter: ZMIN -> "41.4594437"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-9.12678576"
 Parameter: YPOS -> "-9.12678576"
 Parameter: XPOS -> "0.85741224"
 Parameter: XPOS -> "0.85741224"
Evaluating: SQRT(-9.12678576*-9.12678576+0.85741224*0.85741224)
 Parameter: DIST <- "9.16697191"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "9.16697191" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "21"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "21" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "21" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.840858253"
Evaluating: (39-9.0)*(0.840858253-0.5)
 Parameter: XPOS <- "10.2257476"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.571848865"
Evaluating: (39-9.0)*(0.571848865-0.5)
 Parameter: YPOS <- "2.15546595"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.993813686"
Evaluating: (237.395-9.0)*(0.993813686-0.5)
 Parameter: ZPOS <- "112.784577"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.2257476"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 10.2257476--19.5
 Parameter: XTRAN <- "29.7257476"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.15546595"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 2.15546595--19.5
 Parameter: YTRAN <- "21.6554659"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "112.784577"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 112.784577-118.6975
 Parameter: ZTRAN <- "-5.912923"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.7257476"
 Parameter: YTRAN -> "21.6554659"
 Parameter: ZTRAN -> "-5.912923"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    29.725748   21.655466   -5.912923
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.255718234"
Evaluating: 0.255718234*360.0
 Parameter: XPHI <- "92.0585642"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.772086087"
Evaluating: 0.772086087*360.0
 Parameter: YPHI <- "277.950991"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.38797846"
Evaluating: 0.38797846*360.0
 Parameter: ZPHI <- "139.672246"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.2257476"
 Parameter: YPOS -> "2.15546595"
 Parameter: ZPOS -> "112.784577"
 Parameter: XPHI -> "92.0585642"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.035921    0.999355
    0.000000   -0.999355   -0.035921

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   92.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.2257476"
 Parameter: YPOS -> "2.15546595"
 Parameter: ZPOS -> "112.784577"
 Parameter: YPHI -> "277.950991"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.138326    0.000000    0.990387
    0.000000    1.000000    0.000000
   -0.990387    0.000000    0.138326

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   82.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.2257476"
 Parameter: YPOS -> "2.15546595"
 Parameter: ZPOS -> "112.784577"
 Parameter: ZPHI -> "139.672246"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.762355    0.647159    0.000000
   -0.647159   -0.762355    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  139.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.225748 XMAX =   10.225748 XAVE =   10.225748
    YMIN =    2.155466 YMAX =    2.155466 YAVE =    2.155466
    ZMIN =  112.784577 ZMAX =  112.784577 ZAVE =  112.784577
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.2257476"
Evaluating: 10.2257476+3.5
 Parameter: XMAX <- "13.7257476"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.15546592"
Evaluating: 2.15546592+3.5
 Parameter: YMAX <- "5.65546592"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "112.784577"
Evaluating: 112.784577+3.5
 Parameter: ZMAX <- "116.284577"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.2257476"
Evaluating: 10.2257476-3.5
 Parameter: XMIN <- "6.7257476"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.15546592"
Evaluating: 2.15546592-3.5
 Parameter: YMIN <- "-1.34453408"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "112.784577"
Evaluating: 112.784577-3.5
 Parameter: ZMIN <- "109.284577"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.7257476"
 Parameter: XMIN -> "6.7257476"
 Parameter: YMAX -> "5.65546592"
 Parameter: YMIN -> "-1.34453408"
 Parameter: ZMAX -> "116.284577"
 Parameter: ZMIN -> "109.284577"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "2.15546595"
 Parameter: YPOS -> "2.15546595"
 Parameter: XPOS -> "10.2257476"
 Parameter: XPOS -> "10.2257476"
Evaluating: SQRT(2.15546595*2.15546595+10.2257476*10.2257476)
 Parameter: DIST <- "10.450452"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "10.450452" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "22"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "22" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "22" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.749756127"
Evaluating: (39-9.0)*(0.749756127-0.5)
 Parameter: XPOS <- "7.49268381"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.751526408"
Evaluating: (39-9.0)*(0.751526408-0.5)
 Parameter: YPOS <- "7.54579224"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "6.804191938E-02"
Evaluating: (237.395-9.0)*(6.804191938E-02-0.5)
 Parameter: ZPOS <- "-98.6570658"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.49268381"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 7.49268381--19.5
 Parameter: XTRAN <- "26.9926838"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.54579224"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 7.54579224--19.5
 Parameter: YTRAN <- "27.0457922"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-98.6570658"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -98.6570658-118.6975
 Parameter: ZTRAN <- "-217.354566"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.9926838"
 Parameter: YTRAN -> "27.0457922"
 Parameter: ZTRAN -> "-217.354566"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    26.992684   27.045792 -217.354566
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.799794501"
Evaluating: 0.799794501*360.0
 Parameter: XPHI <- "287.92602"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.366585729"
Evaluating: 0.366585729*360.0
 Parameter: YPHI <- "131.970862"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.415257205"
Evaluating: 0.415257205*360.0
 Parameter: ZPHI <- "149.492594"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.49268381"
 Parameter: YPOS -> "7.54579224"
 Parameter: ZPOS -> "-98.6570658"
 Parameter: XPHI -> "287.92602"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.307789   -0.951455
    0.000000    0.951455    0.307789

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   72.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.49268381"
 Parameter: YPOS -> "7.54579224"
 Parameter: ZPOS -> "-98.6570658"
 Parameter: YPHI -> "131.970862"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.668753    0.000000   -0.743485
    0.000000    1.000000    0.000000
    0.743485    0.000000   -0.668753

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  131.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.49268381"
 Parameter: YPOS -> "7.54579224"
 Parameter: ZPOS -> "-98.6570658"
 Parameter: ZPHI -> "149.492594"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.861564    0.507650    0.000000
   -0.507650   -0.861564    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  149.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.492684 XMAX =    7.492684 XAVE =    7.492684
    YMIN =    7.545792 YMAX =    7.545792 YAVE =    7.545792
    ZMIN =  -98.657066 ZMAX =  -98.657066 ZAVE =  -98.657066
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.49268383"
Evaluating: 7.49268383+3.5
 Parameter: XMAX <- "10.9926838"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.54579205"
Evaluating: 7.54579205+3.5
 Parameter: YMAX <- "11.045792"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-98.6570657"
Evaluating: -98.6570657+3.5
 Parameter: ZMAX <- "-95.1570657"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.49268383"
Evaluating: 7.49268383-3.5
 Parameter: XMIN <- "3.99268383"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.54579205"
Evaluating: 7.54579205-3.5
 Parameter: YMIN <- "4.04579205"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-98.6570657"
Evaluating: -98.6570657-3.5
 Parameter: ZMIN <- "-102.157066"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.9926838"
 Parameter: XMIN -> "3.99268383"
 Parameter: YMAX -> "11.045792"
 Parameter: YMIN -> "4.04579205"
 Parameter: ZMAX -> "-95.1570657"
 Parameter: ZMIN -> "-102.157066"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "7.54579224"
 Parameter: YPOS -> "7.54579224"
 Parameter: XPOS -> "7.49268381"
 Parameter: XPOS -> "7.49268381"
Evaluating: SQRT(7.54579224*7.54579224+7.49268381*7.49268381)
 Parameter: DIST <- "10.6338747"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "10.6338747" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "23"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "23" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "23" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.514316318"
Evaluating: (39-9.0)*(0.514316318-0.5)
 Parameter: XPOS <- "0.42948954"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.950443339"
Evaluating: (39-9.0)*(0.950443339-0.5)
 Parameter: YPOS <- "13.5133002"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.356642439"
Evaluating: (237.395-9.0)*(0.356642439-0.5)
 Parameter: ZPOS <- "-32.7421501"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.42948954"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 0.42948954--19.5
 Parameter: XTRAN <- "19.9294895"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.5133002"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 13.5133002--19.5
 Parameter: YTRAN <- "33.0133002"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.7421501"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -32.7421501-118.6975
 Parameter: ZTRAN <- "-151.43965"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "19.9294895"
 Parameter: YTRAN -> "33.0133002"
 Parameter: ZTRAN -> "-151.43965"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    19.929489   33.013300 -151.439650
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.136850292"
Evaluating: 0.136850292*360.0
 Parameter: XPHI <- "49.2661051"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.127249302"
Evaluating: 0.127249302*360.0
 Parameter: YPHI <- "45.8097487"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.388091509"
Evaluating: 0.388091509*360.0
 Parameter: ZPHI <- "139.712943"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.42948954"
 Parameter: YPOS -> "13.5133002"
 Parameter: ZPOS -> "-32.7421501"
 Parameter: XPHI -> "49.2661051"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.652547    0.757748
    0.000000   -0.757748    0.652547

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   49.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.42948954"
 Parameter: YPOS -> "13.5133002"
 Parameter: ZPOS -> "-32.7421501"
 Parameter: YPHI -> "45.8097487"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.697043    0.000000   -0.717029
    0.000000    1.000000    0.000000
    0.717029    0.000000    0.697043

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   45.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.42948954"
 Parameter: YPOS -> "13.5133002"
 Parameter: ZPOS -> "-32.7421501"
 Parameter: ZPHI -> "139.712943"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.762814    0.646617    0.000000
   -0.646617   -0.762814    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  139.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.429490 XMAX =    0.429490 XAVE =    0.429490
    YMIN =   13.513300 YMAX =   13.513300 YAVE =   13.513300
    ZMIN =  -32.742150 ZMAX =  -32.742150 ZAVE =  -32.742150
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.429489646"
Evaluating: 0.429489646+3.5
 Parameter: XMAX <- "3.92948965"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.5133002"
Evaluating: 13.5133002+3.5
 Parameter: YMAX <- "17.0133002"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.7421501"
Evaluating: -32.7421501+3.5
 Parameter: ZMAX <- "-29.2421501"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.429489646"
Evaluating: 0.429489646-3.5
 Parameter: XMIN <- "-3.07051035"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.5133002"
Evaluating: 13.5133002-3.5
 Parameter: YMIN <- "10.0133002"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.7421501"
Evaluating: -32.7421501-3.5
 Parameter: ZMIN <- "-36.2421501"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.92948965"
 Parameter: XMIN -> "-3.07051035"
 Parameter: YMAX -> "17.0133002"
 Parameter: YMIN -> "10.0133002"
 Parameter: ZMAX -> "-29.2421501"
 Parameter: ZMIN -> "-36.2421501"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "13.5133002"
 Parameter: YPOS -> "13.5133002"
 Parameter: XPOS -> "0.42948954"
 Parameter: XPOS -> "0.42948954"
Evaluating: SQRT(13.5133002*13.5133002+0.42948954*0.42948954)
 Parameter: DIST <- "13.5201237"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "13.5201237" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "24"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "24" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "24" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.220157062"
Evaluating: (39-9.0)*(0.220157062-0.5)
 Parameter: XPOS <- "-8.39528814"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.492132421"
Evaluating: (39-9.0)*(0.492132421-0.5)
 Parameter: YPOS <- "-0.23602737"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.454107299"
Evaluating: (237.395-9.0)*(0.454107299-0.5)
 Parameter: ZPOS <- "-10.4816634"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.39528814"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -8.39528814--19.5
 Parameter: XTRAN <- "11.1047119"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.23602737"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -0.23602737--19.5
 Parameter: YTRAN <- "19.2639726"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-10.4816634"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -10.4816634-118.6975
 Parameter: ZTRAN <- "-129.179163"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.1047119"
 Parameter: YTRAN -> "19.2639726"
 Parameter: ZTRAN -> "-129.179163"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    11.104712   19.263973 -129.179163
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.977255703"
Evaluating: 0.977255703*360.0
 Parameter: XPHI <- "351.812053"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.743073198"
Evaluating: 0.743073198*360.0
 Parameter: YPHI <- "267.506351"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.909189034"
Evaluating: 0.909189034*360.0
 Parameter: ZPHI <- "327.308052"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.39528814"
 Parameter: YPOS -> "-0.23602737"
 Parameter: ZPOS -> "-10.4816634"
 Parameter: XPHI -> "351.812053"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.989806   -0.142421
    0.000000    0.142421    0.989806

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    8.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.39528814"
 Parameter: YPOS -> "-0.23602737"
 Parameter: ZPOS -> "-10.4816634"
 Parameter: YPHI -> "267.506351"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.043509    0.000000    0.999053
    0.000000    1.000000    0.000000
   -0.999053    0.000000   -0.043509

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   92.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.39528814"
 Parameter: YPOS -> "-0.23602737"
 Parameter: ZPOS -> "-10.4816634"
 Parameter: ZPHI -> "327.308052"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.841587   -0.540122    0.000000
    0.540122    0.841587    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   32.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.395288 XMAX =   -8.395288 XAVE =   -8.395288
    YMIN =   -0.236027 YMAX =   -0.236027 YAVE =   -0.236027
    ZMIN =  -10.481663 ZMAX =  -10.481663 ZAVE =  -10.481663
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.39528777"
Evaluating: -8.39528777+3.5
 Parameter: XMAX <- "-4.89528777"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.236027233"
Evaluating: -0.236027233+3.5
 Parameter: YMAX <- "3.26397277"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-10.4816635"
Evaluating: -10.4816635+3.5
 Parameter: ZMAX <- "-6.9816635"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.39528777"
Evaluating: -8.39528777-3.5
 Parameter: XMIN <- "-11.8952878"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.236027233"
Evaluating: -0.236027233-3.5
 Parameter: YMIN <- "-3.73602723"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-10.4816635"
Evaluating: -10.4816635-3.5
 Parameter: ZMIN <- "-13.9816635"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.89528777"
 Parameter: XMIN -> "-11.8952878"
 Parameter: YMAX -> "3.26397277"
 Parameter: YMIN -> "-3.73602723"
 Parameter: ZMAX -> "-6.9816635"
 Parameter: ZMIN -> "-13.9816635"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-0.23602737"
 Parameter: YPOS -> "-0.23602737"
 Parameter: XPOS -> "-8.39528814"
 Parameter: XPOS -> "-8.39528814"
Evaluating: SQRT(-0.23602737*-0.23602737+-8.39528814*-8.39528814)
 Parameter: DIST <- "8.39860535"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "8.39860535" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "25"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "25" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "25" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.524709403"
Evaluating: (39-9.0)*(0.524709403-0.5)
 Parameter: XPOS <- "0.74128209"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.161783689"
Evaluating: (39-9.0)*(0.161783689-0.5)
 Parameter: YPOS <- "-10.1464893"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.400194448"
Evaluating: (237.395-9.0)*(0.400194448-0.5)
 Parameter: ZPOS <- "-22.795089"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.74128209"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 0.74128209--19.5
 Parameter: XTRAN <- "20.2412821"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-10.1464893"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -10.1464893--19.5
 Parameter: YTRAN <- "9.3535107"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.795089"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -22.795089-118.6975
 Parameter: ZTRAN <- "-141.492589"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.2412821"
 Parameter: YTRAN -> "9.3535107"
 Parameter: ZTRAN -> "-141.492589"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    20.241282    9.353511 -141.492589
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.198875149E-02"
Evaluating: 1.198875149E-02*360.0
 Parameter: XPHI <- "4.31595054"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.890740826"
Evaluating: 0.890740826*360.0
 Parameter: YPHI <- "320.666697"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.407268499"
Evaluating: 0.407268499*360.0
 Parameter: ZPHI <- "146.61666"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.74128209"
 Parameter: YPOS -> "-10.1464893"
 Parameter: ZPOS -> "-22.795089"
 Parameter: XPHI -> "4.31595054"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.997164    0.075256
    0.000000   -0.075256    0.997164

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    4.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.74128209"
 Parameter: YPOS -> "-10.1464893"
 Parameter: ZPOS -> "-22.795089"
 Parameter: YPHI -> "320.666697"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.773472    0.000000    0.633831
    0.000000    1.000000    0.000000
   -0.633831    0.000000    0.773472

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   39.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.74128209"
 Parameter: YPOS -> "-10.1464893"
 Parameter: ZPOS -> "-22.795089"
 Parameter: ZPHI -> "146.61666"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.835008    0.550238    0.000000
   -0.550238   -0.835008    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  146.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.741282 XMAX =    0.741282 XAVE =    0.741282
    YMIN =  -10.146489 YMAX =  -10.146489 YAVE =  -10.146489
    ZMIN =  -22.795089 ZMAX =  -22.795089 ZAVE =  -22.795089
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.741282084"
Evaluating: 0.741282084+3.5
 Parameter: XMAX <- "4.24128208"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-10.1464893"
Evaluating: -10.1464893+3.5
 Parameter: YMAX <- "-6.6464893"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.795089"
Evaluating: -22.795089+3.5
 Parameter: ZMAX <- "-19.295089"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.741282084"
Evaluating: 0.741282084-3.5
 Parameter: XMIN <- "-2.75871792"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-10.1464893"
Evaluating: -10.1464893-3.5
 Parameter: YMIN <- "-13.6464893"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.795089"
Evaluating: -22.795089-3.5
 Parameter: ZMIN <- "-26.295089"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.24128208"
 Parameter: XMIN -> "-2.75871792"
 Parameter: YMAX -> "-6.6464893"
 Parameter: YMIN -> "-13.6464893"
 Parameter: ZMAX -> "-19.295089"
 Parameter: ZMIN -> "-26.295089"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-10.1464893"
 Parameter: YPOS -> "-10.1464893"
 Parameter: XPOS -> "0.74128209"
 Parameter: XPOS -> "0.74128209"
Evaluating: SQRT(-10.1464893*-10.1464893+0.74128209*0.74128209)
 Parameter: DIST <- "10.1735316"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "10.1735316" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "26"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "26" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "26"
Evaluating: 26
 Parameter: J <- "26"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "26" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.172128701"
Evaluating: (39-9.0)*(0.172128701-0.5)
 Parameter: XPOS <- "-9.83613897"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.408039748"
Evaluating: (39-9.0)*(0.408039748-0.5)
 Parameter: YPOS <- "-2.75880756"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "9.60655165E-02"
Evaluating: (237.395-9.0)*(9.60655165E-02-0.5)
 Parameter: ZPOS <- "-92.2566164"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.83613897"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -9.83613897--19.5
 Parameter: XTRAN <- "9.66386103"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.75880756"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -2.75880756--19.5
 Parameter: YTRAN <- "16.7411924"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-92.2566164"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -92.2566164-118.6975
 Parameter: ZTRAN <- "-210.954116"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "9.66386103"
 Parameter: YTRAN -> "16.7411924"
 Parameter: ZTRAN -> "-210.954116"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR     9.663861   16.741192 -210.954116
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.727615076"
Evaluating: 0.727615076*360.0
 Parameter: XPHI <- "261.941427"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.553087133"
Evaluating: 0.553087133*360.0
 Parameter: YPHI <- "199.111368"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.744827757"
Evaluating: 0.744827757*360.0
 Parameter: ZPHI <- "268.137993"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.83613897"
 Parameter: YPOS -> "-2.75880756"
 Parameter: ZPOS -> "-92.2566164"
 Parameter: XPHI -> "261.941427"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.140185   -0.990125
    0.000000    0.990125   -0.140185

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   98.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.83613897"
 Parameter: YPOS -> "-2.75880756"
 Parameter: ZPOS -> "-92.2566164"
 Parameter: YPHI -> "199.111368"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.944884    0.000000    0.327405
    0.000000    1.000000    0.000000
   -0.327405    0.000000   -0.944884

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  160.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.83613897"
 Parameter: YPOS -> "-2.75880756"
 Parameter: ZPOS -> "-92.2566164"
 Parameter: ZPHI -> "268.137993"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.032492   -0.999472    0.000000
    0.999472   -0.032492    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   91.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.836139 XMAX =   -9.836139 XAVE =   -9.836139
    YMIN =   -2.758808 YMAX =   -2.758808 YAVE =   -2.758808
    ZMIN =  -92.256616 ZMAX =  -92.256616 ZAVE =  -92.256616
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.83613858"
Evaluating: -9.83613858+3.5
 Parameter: XMAX <- "-6.33613858"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.75880758"
Evaluating: -2.75880758+3.5
 Parameter: YMAX <- "0.74119242"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-92.2566163"
Evaluating: -92.2566163+3.5
 Parameter: ZMAX <- "-88.7566163"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.83613858"
Evaluating: -9.83613858-3.5
 Parameter: XMIN <- "-13.3361386"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.75880758"
Evaluating: -2.75880758-3.5
 Parameter: YMIN <- "-6.25880758"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-92.2566163"
Evaluating: -92.2566163-3.5
 Parameter: ZMIN <- "-95.7566163"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.33613858"
 Parameter: XMIN -> "-13.3361386"
 Parameter: YMAX -> "0.74119242"
 Parameter: YMIN -> "-6.25880758"
 Parameter: ZMAX -> "-88.7566163"
 Parameter: ZMIN -> "-95.7566163"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-2.75880756"
 Parameter: YPOS -> "-2.75880756"
 Parameter: XPOS -> "-9.83613897"
 Parameter: XPOS -> "-9.83613897"
Evaluating: SQRT(-2.75880756*-2.75880756+-9.83613897*-9.83613897)
 Parameter: DIST <- "10.215706"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "10.215706" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "27"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "27" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "27" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.887928253"
Evaluating: (39-9.0)*(0.887928253-0.5)
 Parameter: XPOS <- "11.6378476"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.578578371"
Evaluating: (39-9.0)*(0.578578371-0.5)
 Parameter: YPOS <- "2.35735113"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.1088781"
Evaluating: (237.395-9.0)*(0.1088781-0.5)
 Parameter: ZPOS <- "-89.3302864"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.6378476"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 11.6378476--19.5
 Parameter: XTRAN <- "31.1378476"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.35735113"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 2.35735113--19.5
 Parameter: YTRAN <- "21.8573511"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-89.3302864"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -89.3302864-118.6975
 Parameter: ZTRAN <- "-208.027786"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.1378476"
 Parameter: YTRAN -> "21.8573511"
 Parameter: ZTRAN -> "-208.027786"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    31.137848   21.857351 -208.027786
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.712402676"
Evaluating: 0.712402676*360.0
 Parameter: XPHI <- "256.464963"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.770268329"
Evaluating: 0.770268329*360.0
 Parameter: YPHI <- "277.296598"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.864564603"
Evaluating: 0.864564603*360.0
 Parameter: ZPHI <- "311.243257"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.6378476"
 Parameter: YPOS -> "2.35735113"
 Parameter: ZPOS -> "-89.3302864"
 Parameter: XPHI -> "256.464963"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.234040   -0.972227
    0.000000    0.972227   -0.234040

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  103.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.6378476"
 Parameter: YPOS -> "2.35735113"
 Parameter: ZPOS -> "-89.3302864"
 Parameter: YPHI -> "277.296598"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.127006    0.000000    0.991902
    0.000000    1.000000    0.000000
   -0.991902    0.000000    0.127006

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   82.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.6378476"
 Parameter: YPOS -> "2.35735113"
 Parameter: ZPOS -> "-89.3302864"
 Parameter: ZPHI -> "311.243257"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.659257   -0.751917    0.000000
    0.751917    0.659257    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   48.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.637848 XMAX =   11.637848 XAVE =   11.637848
    YMIN =    2.357351 YMAX =    2.357351 YAVE =    2.357351
    ZMIN =  -89.330286 ZMAX =  -89.330286 ZAVE =  -89.330286
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.6378478"
Evaluating: 11.6378478+3.5
 Parameter: XMAX <- "15.1378478"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.35735079"
Evaluating: 2.35735079+3.5
 Parameter: YMAX <- "5.85735079"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-89.3302864"
Evaluating: -89.3302864+3.5
 Parameter: ZMAX <- "-85.8302864"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.6378478"
Evaluating: 11.6378478-3.5
 Parameter: XMIN <- "8.1378478"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.35735079"
Evaluating: 2.35735079-3.5
 Parameter: YMIN <- "-1.14264921"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-89.3302864"
Evaluating: -89.3302864-3.5
 Parameter: ZMIN <- "-92.8302864"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.1378478"
 Parameter: XMIN -> "8.1378478"
 Parameter: YMAX -> "5.85735079"
 Parameter: YMIN -> "-1.14264921"
 Parameter: ZMAX -> "-85.8302864"
 Parameter: ZMIN -> "-92.8302864"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "2.35735113"
 Parameter: YPOS -> "2.35735113"
 Parameter: XPOS -> "11.6378476"
 Parameter: XPOS -> "11.6378476"
Evaluating: SQRT(2.35735113*2.35735113+11.6378476*11.6378476)
 Parameter: DIST <- "11.874199"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "11.874199" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "28"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "28" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "28" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.425129516"
Evaluating: (39-9.0)*(0.425129516-0.5)
 Parameter: XPOS <- "-2.24611452"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "4.415587218E-02"
Evaluating: (39-9.0)*(4.415587218E-02-0.5)
 Parameter: YPOS <- "-13.6753238"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.510350677"
Evaluating: (237.395-9.0)*(0.510350677-0.5)
 Parameter: ZPOS <- "2.36404287"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.24611452"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -2.24611452--19.5
 Parameter: XTRAN <- "17.2538855"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.6753238"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -13.6753238--19.5
 Parameter: YTRAN <- "5.8246762"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "2.36404287"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 2.36404287-118.6975
 Parameter: ZTRAN <- "-116.333457"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.2538855"
 Parameter: YTRAN -> "5.8246762"
 Parameter: ZTRAN -> "-116.333457"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    17.253885    5.824676 -116.333457
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.17659626"
Evaluating: 0.17659626*360.0
 Parameter: XPHI <- "63.5746536"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.153220794"
Evaluating: 0.153220794*360.0
 Parameter: YPHI <- "55.1594858"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.994340471"
Evaluating: 0.994340471*360.0
 Parameter: ZPHI <- "357.96257"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.24611452"
 Parameter: YPOS -> "-13.6753238"
 Parameter: ZPOS -> "2.36404287"
 Parameter: XPHI -> "63.5746536"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.445031    0.895515
    0.000000   -0.895515    0.445031

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   63.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.24611452"
 Parameter: YPOS -> "-13.6753238"
 Parameter: ZPOS -> "2.36404287"
 Parameter: YPHI -> "55.1594858"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.571294    0.000000   -0.820745
    0.000000    1.000000    0.000000
    0.820745    0.000000    0.571294

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   55.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.24611452"
 Parameter: YPOS -> "-13.6753238"
 Parameter: ZPOS -> "2.36404287"
 Parameter: ZPHI -> "357.96257"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.999368   -0.035552    0.000000
    0.035552    0.999368    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    2.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.246115 XMAX =   -2.246115 XAVE =   -2.246115
    YMIN =  -13.675324 YMAX =  -13.675324 YAVE =  -13.675324
    ZMIN =    2.364043 ZMAX =    2.364043 ZAVE =    2.364043
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.24611456"
Evaluating: -2.24611456+3.5
 Parameter: XMAX <- "1.25388544"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.6753237"
Evaluating: -13.6753237+3.5
 Parameter: YMAX <- "-10.1753237"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "2.36404292"
Evaluating: 2.36404292+3.5
 Parameter: ZMAX <- "5.86404292"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.24611456"
Evaluating: -2.24611456-3.5
 Parameter: XMIN <- "-5.74611456"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.6753237"
Evaluating: -13.6753237-3.5
 Parameter: YMIN <- "-17.1753237"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "2.36404292"
Evaluating: 2.36404292-3.5
 Parameter: ZMIN <- "-1.13595708"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.25388544"
 Parameter: XMIN -> "-5.74611456"
 Parameter: YMAX -> "-10.1753237"
 Parameter: YMIN -> "-17.1753237"
 Parameter: ZMAX -> "5.86404292"
 Parameter: ZMIN -> "-1.13595708"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   2680
 SELRPN>      1 atoms have been selected out of   2680

            DISTANCES FOR SELECTED ATOMS
 2508 POS      POT      28       POT     -2496 POS      POT      16       POT           3.9796
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "28" and "28".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.306512746"
Evaluating: (39-9.0)*(0.306512746-0.5)
 Parameter: XPOS <- "-5.80461762"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.128776174"
Evaluating: (39-9.0)*(0.128776174-0.5)
 Parameter: YPOS <- "-11.1367148"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.236437348"
Evaluating: (237.395-9.0)*(0.236437348-0.5)
 Parameter: ZPOS <- "-60.1963919"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.246115 XMAX =   -2.246115 XAVE =   -2.246115
    YMIN =  -13.675324 YMAX =  -13.675324 YAVE =  -13.675324
    ZMIN =    2.364043 ZMAX =    2.364043 ZAVE =    2.364043
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.80461762"
 RDCMND substituted energy or value "?XAVE" to "-2.24611456"
Evaluating: -5.80461762--2.24611456
 Parameter: XTRAN <- "-3.55850306"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.1367148"
 RDCMND substituted energy or value "?YAVE" to "-13.6753237"
Evaluating: -11.1367148--13.6753237
 Parameter: YTRAN <- "2.5386089"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-60.1963919"
 RDCMND substituted energy or value "?ZAVE" to "2.36404292"
Evaluating: -60.1963919-2.36404292
 Parameter: ZTRAN <- "-62.5604348"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.55850306"
 Parameter: YTRAN -> "2.5386089"
 Parameter: ZTRAN -> "-62.5604348"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    -3.558503    2.538609  -62.560435
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.806304638"
Evaluating: 0.806304638*360.0
 Parameter: XPHI <- "290.26967"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.576585143"
Evaluating: 0.576585143*360.0
 Parameter: YPHI <- "207.570651"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.556613211"
Evaluating: 0.556613211*360.0
 Parameter: ZPHI <- "200.380756"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.80461762"
 Parameter: YPOS -> "-11.1367148"
 Parameter: ZPOS -> "-60.1963919"
 Parameter: XPHI -> "290.26967"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.346439   -0.938072
    0.000000    0.938072    0.346439

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   69.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.80461762"
 Parameter: YPOS -> "-11.1367148"
 Parameter: ZPOS -> "-60.1963919"
 Parameter: YPHI -> "207.570651"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.886441    0.000000    0.462842
    0.000000    1.000000    0.000000
   -0.462842    0.000000   -0.886441

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  152.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.80461762"
 Parameter: YPOS -> "-11.1367148"
 Parameter: ZPOS -> "-60.1963919"
 Parameter: ZPHI -> "200.380756"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.937399   -0.348257    0.000000
    0.348257   -0.937399    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  159.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.804618 XMAX =   -5.804618 XAVE =   -5.804618
    YMIN =  -11.136715 YMAX =  -11.136715 YAVE =  -11.136715
    ZMIN =  -60.196392 ZMAX =  -60.196392 ZAVE =  -60.196392
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.80461762"
Evaluating: -5.80461762+3.5
 Parameter: XMAX <- "-2.30461762"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.1367148"
Evaluating: -11.1367148+3.5
 Parameter: YMAX <- "-7.6367148"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-60.1963919"
Evaluating: -60.1963919+3.5
 Parameter: ZMAX <- "-56.6963919"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.80461762"
Evaluating: -5.80461762-3.5
 Parameter: XMIN <- "-9.30461762"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.1367148"
Evaluating: -11.1367148-3.5
 Parameter: YMIN <- "-14.6367148"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-60.1963919"
Evaluating: -60.1963919-3.5
 Parameter: ZMIN <- "-63.6963919"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.30461762"
 Parameter: XMIN -> "-9.30461762"
 Parameter: YMAX -> "-7.6367148"
 Parameter: YMIN -> "-14.6367148"
 Parameter: ZMAX -> "-56.6963919"
 Parameter: ZMIN -> "-63.6963919"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-11.1367148"
 Parameter: YPOS -> "-11.1367148"
 Parameter: XPOS -> "-5.80461762"
 Parameter: XPOS -> "-5.80461762"
Evaluating: SQRT(-11.1367148*-11.1367148+-5.80461762*-5.80461762)
 Parameter: DIST <- "12.5586624"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "12.5586624" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "29"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "29" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "29" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "29"
 Parameter: NPOS -> "28"
Evaluating: 29-28
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.678774758"
Evaluating: (39-9.0)*(0.678774758-0.5)
 Parameter: XPOS <- "5.36324274"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "2.488092246E-02"
Evaluating: (39-9.0)*(2.488092246E-02-0.5)
 Parameter: YPOS <- "-14.2535723"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.49234258"
Evaluating: (237.395-9.0)*(0.49234258-0.5)
 Parameter: ZPOS <- "-1.74891644"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.36324274"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 5.36324274--19.5
 Parameter: XTRAN <- "24.8632427"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.2535723"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -14.2535723--19.5
 Parameter: YTRAN <- "5.2464277"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-1.74891644"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -1.74891644-118.6975
 Parameter: ZTRAN <- "-120.446416"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.8632427"
 Parameter: YTRAN -> "5.2464277"
 Parameter: ZTRAN -> "-120.446416"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    24.863243    5.246428 -120.446416
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.643319122"
Evaluating: 0.643319122*360.0
 Parameter: XPHI <- "231.594884"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.286607241"
Evaluating: 0.286607241*360.0
 Parameter: YPHI <- "103.178607"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.815670245"
Evaluating: 0.815670245*360.0
 Parameter: ZPHI <- "293.641288"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.36324274"
 Parameter: YPOS -> "-14.2535723"
 Parameter: ZPOS -> "-1.74891644"
 Parameter: XPHI -> "231.594884"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.621218   -0.783638
    0.000000    0.783638   -0.621218

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  128.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.36324274"
 Parameter: YPOS -> "-14.2535723"
 Parameter: ZPOS -> "-1.74891644"
 Parameter: YPHI -> "103.178607"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.227987    0.000000   -0.973664
    0.000000    1.000000    0.000000
    0.973664    0.000000   -0.227987

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  103.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.36324274"
 Parameter: YPOS -> "-14.2535723"
 Parameter: ZPOS -> "-1.74891644"
 Parameter: ZPHI -> "293.641288"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.401009   -0.916074    0.000000
    0.916074    0.401009    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   66.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.363243 XMAX =    5.363243 XAVE =    5.363243
    YMIN =  -14.253572 YMAX =  -14.253572 YAVE =  -14.253572
    ZMIN =   -1.748916 ZMAX =   -1.748916 ZAVE =   -1.748916
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.36324317"
Evaluating: 5.36324317+3.5
 Parameter: XMAX <- "8.86324317"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.2535722"
Evaluating: -14.2535722+3.5
 Parameter: YMAX <- "-10.7535722"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-1.74891642"
Evaluating: -1.74891642+3.5
 Parameter: ZMAX <- "1.75108358"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.36324317"
Evaluating: 5.36324317-3.5
 Parameter: XMIN <- "1.86324317"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.2535722"
Evaluating: -14.2535722-3.5
 Parameter: YMIN <- "-17.7535722"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-1.74891642"
Evaluating: -1.74891642-3.5
 Parameter: ZMIN <- "-5.24891642"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.86324317"
 Parameter: XMIN -> "1.86324317"
 Parameter: YMAX -> "-10.7535722"
 Parameter: YMIN -> "-17.7535722"
 Parameter: ZMAX -> "1.75108358"
 Parameter: ZMIN -> "-5.24891642"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-14.2535723"
 Parameter: YPOS -> "-14.2535723"
 Parameter: XPOS -> "5.36324274"
 Parameter: XPOS -> "5.36324274"
Evaluating: SQRT(-14.2535723*-14.2535723+5.36324274*5.36324274)
 Parameter: DIST <- "15.2292054"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "15.2292054" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "30"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "30" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "30" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "30"
 Parameter: NPOS -> "28"
Evaluating: 30-28
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.893645512"
Evaluating: (39-9.0)*(0.893645512-0.5)
 Parameter: XPOS <- "11.8093654"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.166923482"
Evaluating: (39-9.0)*(0.166923482-0.5)
 Parameter: YPOS <- "-9.99229554"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.253189472"
Evaluating: (237.395-9.0)*(0.253189472-0.5)
 Parameter: ZPOS <- "-56.3702905"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.8093654"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 11.8093654--19.5
 Parameter: XTRAN <- "31.3093654"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.99229554"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -9.99229554--19.5
 Parameter: YTRAN <- "9.50770446"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-56.3702905"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -56.3702905-118.6975
 Parameter: ZTRAN <- "-175.067791"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.3093654"
 Parameter: YTRAN -> "9.50770446"
 Parameter: ZTRAN -> "-175.067791"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    31.309365    9.507704 -175.067791
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.711755402"
Evaluating: 0.711755402*360.0
 Parameter: XPHI <- "256.231945"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.487217368"
Evaluating: 0.487217368*360.0
 Parameter: YPHI <- "175.398252"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.86884325"
Evaluating: 0.86884325*360.0
 Parameter: ZPHI <- "312.78357"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.8093654"
 Parameter: YPOS -> "-9.99229554"
 Parameter: ZPOS -> "-56.3702905"
 Parameter: XPHI -> "256.231945"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.237992   -0.971267
    0.000000    0.971267   -0.237992

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  103.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.8093654"
 Parameter: YPOS -> "-9.99229554"
 Parameter: ZPOS -> "-56.3702905"
 Parameter: YPHI -> "175.398252"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.996776    0.000000   -0.080229
    0.000000    1.000000    0.000000
    0.080229    0.000000   -0.996776

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  175.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.8093654"
 Parameter: YPOS -> "-9.99229554"
 Parameter: ZPOS -> "-56.3702905"
 Parameter: ZPHI -> "312.78357"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.679231   -0.733925    0.000000
    0.733925    0.679231    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   47.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.809365 XMAX =   11.809365 XAVE =   11.809365
    YMIN =   -9.992295 YMAX =   -9.992295 YAVE =   -9.992295
    ZMIN =  -56.370291 ZMAX =  -56.370291 ZAVE =  -56.370291
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.809365"
Evaluating: 11.809365+3.5
 Parameter: XMAX <- "15.309365"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.99229522"
Evaluating: -9.99229522+3.5
 Parameter: YMAX <- "-6.49229522"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-56.3702906"
Evaluating: -56.3702906+3.5
 Parameter: ZMAX <- "-52.8702906"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.809365"
Evaluating: 11.809365-3.5
 Parameter: XMIN <- "8.309365"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.99229522"
Evaluating: -9.99229522-3.5
 Parameter: YMIN <- "-13.4922952"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-56.3702906"
Evaluating: -56.3702906-3.5
 Parameter: ZMIN <- "-59.8702906"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.309365"
 Parameter: XMIN -> "8.309365"
 Parameter: YMAX -> "-6.49229522"
 Parameter: YMIN -> "-13.4922952"
 Parameter: ZMAX -> "-52.8702906"
 Parameter: ZMIN -> "-59.8702906"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-9.99229554"
 Parameter: YPOS -> "-9.99229554"
 Parameter: XPOS -> "11.8093654"
 Parameter: XPOS -> "11.8093654"
Evaluating: SQRT(-9.99229554*-9.99229554+11.8093654*11.8093654)
 Parameter: DIST <- "15.4695534"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "15.4695534" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "31"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "31" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "31" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "31"
 Parameter: NPOS -> "28"
Evaluating: 31-28
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.200809049"
Evaluating: (39-9.0)*(0.200809049-0.5)
 Parameter: XPOS <- "-8.97572853"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.149916605"
Evaluating: (39-9.0)*(0.149916605-0.5)
 Parameter: YPOS <- "-10.5025018"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.889127892"
Evaluating: (237.395-9.0)*(0.889127892-0.5)
 Parameter: ZPOS <- "88.8748649"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.97572853"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -8.97572853--19.5
 Parameter: XTRAN <- "10.5242715"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-10.5025018"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -10.5025018--19.5
 Parameter: YTRAN <- "8.9974982"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "88.8748649"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 88.8748649-118.6975
 Parameter: ZTRAN <- "-29.8226351"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.5242715"
 Parameter: YTRAN -> "8.9974982"
 Parameter: ZTRAN -> "-29.8226351"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    10.524271    8.997498  -29.822635
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.185371791"
Evaluating: 0.185371791*360.0
 Parameter: XPHI <- "66.7338448"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.54131393"
Evaluating: 0.54131393*360.0
 Parameter: YPHI <- "194.873015"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.788954223E-02"
Evaluating: 6.788954223E-02*360.0
 Parameter: ZPHI <- "24.4402352"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.97572853"
 Parameter: YPOS -> "-10.5025018"
 Parameter: ZPOS -> "88.8748649"
 Parameter: XPHI -> "66.7338448"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.395003    0.918680
    0.000000   -0.918680    0.395003

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   66.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.97572853"
 Parameter: YPOS -> "-10.5025018"
 Parameter: ZPOS -> "88.8748649"
 Parameter: YPHI -> "194.873015"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.966497    0.000000    0.256678
    0.000000    1.000000    0.000000
   -0.256678    0.000000   -0.966497

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  165.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.97572853"
 Parameter: YPOS -> "-10.5025018"
 Parameter: ZPOS -> "88.8748649"
 Parameter: ZPHI -> "24.4402352"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.910393    0.413744    0.000000
   -0.413744    0.910393    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   24.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.975729 XMAX =   -8.975729 XAVE =   -8.975729
    YMIN =  -10.502502 YMAX =  -10.502502 YAVE =  -10.502502
    ZMIN =   88.874865 ZMAX =   88.874865 ZAVE =   88.874865
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.97572856"
Evaluating: -8.97572856+3.5
 Parameter: XMAX <- "-5.47572856"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-10.5025018"
Evaluating: -10.5025018+3.5
 Parameter: YMAX <- "-7.0025018"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "88.8748649"
Evaluating: 88.8748649+3.5
 Parameter: ZMAX <- "92.3748649"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.97572856"
Evaluating: -8.97572856-3.5
 Parameter: XMIN <- "-12.4757286"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-10.5025018"
Evaluating: -10.5025018-3.5
 Parameter: YMIN <- "-14.0025018"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "88.8748649"
Evaluating: 88.8748649-3.5
 Parameter: ZMIN <- "85.3748649"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.47572856"
 Parameter: XMIN -> "-12.4757286"
 Parameter: YMAX -> "-7.0025018"
 Parameter: YMIN -> "-14.0025018"
 Parameter: ZMAX -> "92.3748649"
 Parameter: ZMIN -> "85.3748649"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-10.5025018"
 Parameter: YPOS -> "-10.5025018"
 Parameter: XPOS -> "-8.97572853"
 Parameter: XPOS -> "-8.97572853"
Evaluating: SQRT(-10.5025018*-10.5025018+-8.97572853*-8.97572853)
 Parameter: DIST <- "13.8154351"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "13.8154351" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "32"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "32" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "32" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "32"
 Parameter: NPOS -> "28"
Evaluating: 32-28
 Parameter: J <- "4"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.712734552"
Evaluating: (39-9.0)*(0.712734552-0.5)
 Parameter: XPOS <- "6.38203656"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.886773833"
Evaluating: (39-9.0)*(0.886773833-0.5)
 Parameter: YPOS <- "11.603215"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.643786068"
Evaluating: (237.395-9.0)*(0.643786068-0.5)
 Parameter: ZPOS <- "32.840019"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.38203656"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 6.38203656--19.5
 Parameter: XTRAN <- "25.8820366"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.603215"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 11.603215--19.5
 Parameter: YTRAN <- "31.103215"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.840019"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 32.840019-118.6975
 Parameter: ZTRAN <- "-85.857481"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.8820366"
 Parameter: YTRAN -> "31.103215"
 Parameter: ZTRAN -> "-85.857481"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    25.882037   31.103215  -85.857481
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.700052321"
Evaluating: 0.700052321*360.0
 Parameter: XPHI <- "252.018836"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.459676512"
Evaluating: 0.459676512*360.0
 Parameter: YPHI <- "165.483544"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.956157279"
Evaluating: 0.956157279*360.0
 Parameter: ZPHI <- "344.21662"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.38203656"
 Parameter: YPOS -> "11.603215"
 Parameter: ZPOS -> "32.840019"
 Parameter: XPHI -> "252.018836"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.308704   -0.951158
    0.000000    0.951158   -0.308704

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  107.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.38203656"
 Parameter: YPOS -> "11.603215"
 Parameter: ZPOS -> "32.840019"
 Parameter: YPHI -> "165.483544"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.968076    0.000000   -0.250658
    0.000000    1.000000    0.000000
    0.250658    0.000000   -0.968076

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  165.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.38203656"
 Parameter: YPOS -> "11.603215"
 Parameter: ZPOS -> "32.840019"
 Parameter: ZPHI -> "344.21662"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.962297   -0.272001    0.000000
    0.272001    0.962297    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   15.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.382037 XMAX =    6.382037 XAVE =    6.382037
    YMIN =   11.603215 YMAX =   11.603215 YAVE =   11.603215
    ZMIN =   32.840019 ZMAX =   32.840019 ZAVE =   32.840019
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.38203652"
Evaluating: 6.38203652+3.5
 Parameter: XMAX <- "9.88203652"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.603215"
Evaluating: 11.603215+3.5
 Parameter: YMAX <- "15.103215"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.840019"
Evaluating: 32.840019+3.5
 Parameter: ZMAX <- "36.340019"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.38203652"
Evaluating: 6.38203652-3.5
 Parameter: XMIN <- "2.88203652"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.603215"
Evaluating: 11.603215-3.5
 Parameter: YMIN <- "8.103215"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.840019"
Evaluating: 32.840019-3.5
 Parameter: ZMIN <- "29.340019"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.88203652"
 Parameter: XMIN -> "2.88203652"
 Parameter: YMAX -> "15.103215"
 Parameter: YMIN -> "8.103215"
 Parameter: ZMAX -> "36.340019"
 Parameter: ZMIN -> "29.340019"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "11.603215"
 Parameter: YPOS -> "11.603215"
 Parameter: XPOS -> "6.38203656"
 Parameter: XPOS -> "6.38203656"
Evaluating: SQRT(11.603215*11.603215+6.38203656*6.38203656)
 Parameter: DIST <- "13.2425447"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "13.2425447" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "33"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "33" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "33" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "33"
 Parameter: NPOS -> "28"
Evaluating: 33-28
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.170961393"
Evaluating: (39-9.0)*(0.170961393-0.5)
 Parameter: XPOS <- "-9.87115821"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.746465572"
Evaluating: (39-9.0)*(0.746465572-0.5)
 Parameter: YPOS <- "7.39396716"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.160641964"
Evaluating: (237.395-9.0)*(0.160641964-0.5)
 Parameter: ZPOS <- "-77.5076786"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.87115821"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -9.87115821--19.5
 Parameter: XTRAN <- "9.62884179"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.39396716"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 7.39396716--19.5
 Parameter: YTRAN <- "26.8939672"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-77.5076786"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -77.5076786-118.6975
 Parameter: ZTRAN <- "-196.205179"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "9.62884179"
 Parameter: YTRAN -> "26.8939672"
 Parameter: ZTRAN -> "-196.205179"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR     9.628842   26.893967 -196.205179
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.917447323E-02"
Evaluating: 4.917447323E-02*360.0
 Parameter: XPHI <- "17.7028104"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.596847079"
Evaluating: 0.596847079*360.0
 Parameter: YPHI <- "214.864948"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.67468401E-02"
Evaluating: 7.67468401E-02*360.0
 Parameter: ZPHI <- "27.6288624"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.87115821"
 Parameter: YPOS -> "7.39396716"
 Parameter: ZPOS -> "-77.5076786"
 Parameter: XPHI -> "17.7028104"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.952647    0.304080
    0.000000   -0.304080    0.952647

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   17.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.87115821"
 Parameter: YPOS -> "7.39396716"
 Parameter: ZPOS -> "-77.5076786"
 Parameter: YPHI -> "214.864948"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.820502    0.000000    0.571644
    0.000000    1.000000    0.000000
   -0.571644    0.000000   -0.820502

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  145.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.87115821"
 Parameter: YPOS -> "7.39396716"
 Parameter: ZPOS -> "-77.5076786"
 Parameter: ZPHI -> "27.6288624"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.885970    0.463742    0.000000
   -0.463742    0.885970    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   27.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.871158 XMAX =   -9.871158 XAVE =   -9.871158
    YMIN =    7.393967 YMAX =    7.393967 YAVE =    7.393967
    ZMIN =  -77.507678 ZMAX =  -77.507678 ZAVE =  -77.507678
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.87115845"
Evaluating: -9.87115845+3.5
 Parameter: XMAX <- "-6.37115845"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.39396719"
Evaluating: 7.39396719+3.5
 Parameter: YMAX <- "10.8939672"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-77.5076783"
Evaluating: -77.5076783+3.5
 Parameter: ZMAX <- "-74.0076783"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.87115845"
Evaluating: -9.87115845-3.5
 Parameter: XMIN <- "-13.3711584"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.39396719"
Evaluating: 7.39396719-3.5
 Parameter: YMIN <- "3.89396719"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-77.5076783"
Evaluating: -77.5076783-3.5
 Parameter: ZMIN <- "-81.0076783"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.37115845"
 Parameter: XMIN -> "-13.3711584"
 Parameter: YMAX -> "10.8939672"
 Parameter: YMIN -> "3.89396719"
 Parameter: ZMAX -> "-74.0076783"
 Parameter: ZMIN -> "-81.0076783"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "7.39396716"
 Parameter: YPOS -> "7.39396716"
 Parameter: XPOS -> "-9.87115821"
 Parameter: XPOS -> "-9.87115821"
Evaluating: SQRT(7.39396716*7.39396716+-9.87115821*-9.87115821)
 Parameter: DIST <- "12.3333092"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "12.3333092" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "34"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "34" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "34" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "34"
 Parameter: NPOS -> "28"
Evaluating: 34-28
 Parameter: J <- "6"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "8.506320452E-02"
Evaluating: (39-9.0)*(8.506320452E-02-0.5)
 Parameter: XPOS <- "-12.4481039"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.758152354"
Evaluating: (39-9.0)*(0.758152354-0.5)
 Parameter: YPOS <- "7.74457062"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.141924994"
Evaluating: (237.395-9.0)*(0.141924994-0.5)
 Parameter: ZPOS <- "-81.782541"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.4481039"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -12.4481039--19.5
 Parameter: XTRAN <- "7.0518961"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.74457062"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 7.74457062--19.5
 Parameter: YTRAN <- "27.2445706"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-81.782541"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -81.782541-118.6975
 Parameter: ZTRAN <- "-200.480041"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.0518961"
 Parameter: YTRAN -> "27.2445706"
 Parameter: ZTRAN -> "-200.480041"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR     7.051896   27.244571 -200.480041
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.221657746"
Evaluating: 0.221657746*360.0
 Parameter: XPHI <- "79.7967886"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.884970246"
Evaluating: 0.884970246*360.0
 Parameter: YPHI <- "318.589289"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.286643032"
Evaluating: 0.286643032*360.0
 Parameter: ZPHI <- "103.191492"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.4481039"
 Parameter: YPOS -> "7.74457062"
 Parameter: ZPOS -> "-81.782541"
 Parameter: XPHI -> "79.7967886"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.177140    0.984186
    0.000000   -0.984186    0.177140

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   79.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.4481039"
 Parameter: YPOS -> "7.74457062"
 Parameter: ZPOS -> "-81.782541"
 Parameter: YPHI -> "318.589289"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.749987    0.000000    0.661452
    0.000000    1.000000    0.000000
   -0.661452    0.000000    0.749987

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   41.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.4481039"
 Parameter: YPOS -> "7.74457062"
 Parameter: ZPOS -> "-81.782541"
 Parameter: ZPHI -> "103.191492"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.228206    0.973613    0.000000
   -0.973613   -0.228206    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  103.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.448104 XMAX =  -12.448104 XAVE =  -12.448104
    YMIN =    7.744571 YMAX =    7.744571 YAVE =    7.744571
    ZMIN =  -81.782541 ZMAX =  -81.782541 ZAVE =  -81.782541
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.4481039"
Evaluating: -12.4481039+3.5
 Parameter: XMAX <- "-8.9481039"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.74457061"
Evaluating: 7.74457061+3.5
 Parameter: YMAX <- "11.2445706"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-81.782541"
Evaluating: -81.782541+3.5
 Parameter: ZMAX <- "-78.282541"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.4481039"
Evaluating: -12.4481039-3.5
 Parameter: XMIN <- "-15.9481039"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.74457061"
Evaluating: 7.74457061-3.5
 Parameter: YMIN <- "4.24457061"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-81.782541"
Evaluating: -81.782541-3.5
 Parameter: ZMIN <- "-85.282541"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.9481039"
 Parameter: XMIN -> "-15.9481039"
 Parameter: YMAX -> "11.2445706"
 Parameter: YMIN -> "4.24457061"
 Parameter: ZMAX -> "-78.282541"
 Parameter: ZMIN -> "-85.282541"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "7.74457062"
 Parameter: YPOS -> "7.74457062"
 Parameter: XPOS -> "-12.4481039"
 Parameter: XPOS -> "-12.4481039"
Evaluating: SQRT(7.74457062*7.74457062+-12.4481039*-12.4481039)
 Parameter: DIST <- "14.6606161"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "14.6606161" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "35"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "35" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "35" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "35"
 Parameter: NPOS -> "28"
Evaluating: 35-28
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.188962112"
Evaluating: (39-9.0)*(0.188962112-0.5)
 Parameter: XPOS <- "-9.33113664"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.287232999"
Evaluating: (39-9.0)*(0.287232999-0.5)
 Parameter: YPOS <- "-6.38301003"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.766448212"
Evaluating: (237.395-9.0)*(0.766448212-0.5)
 Parameter: ZPOS <- "60.8554394"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.33113664"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -9.33113664--19.5
 Parameter: XTRAN <- "10.1688634"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.38301003"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -6.38301003--19.5
 Parameter: YTRAN <- "13.11699"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "60.8554394"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 60.8554394-118.6975
 Parameter: ZTRAN <- "-57.8420606"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.1688634"
 Parameter: YTRAN -> "13.11699"
 Parameter: ZTRAN -> "-57.8420606"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    10.168863   13.116990  -57.842061
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.24307668"
Evaluating: 0.24307668*360.0
 Parameter: XPHI <- "87.5076048"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.336374911"
Evaluating: 0.336374911*360.0
 Parameter: YPHI <- "121.094968"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.746113186E-02"
Evaluating: 3.746113186E-02*360.0
 Parameter: ZPHI <- "13.4860075"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.33113664"
 Parameter: YPOS -> "-6.38301003"
 Parameter: ZPOS -> "60.8554394"
 Parameter: XPHI -> "87.5076048"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.043487    0.999054
    0.000000   -0.999054    0.043487

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   87.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.33113664"
 Parameter: YPOS -> "-6.38301003"
 Parameter: ZPOS -> "60.8554394"
 Parameter: YPHI -> "121.094968"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.516458    0.000000   -0.856312
    0.000000    1.000000    0.000000
    0.856312    0.000000   -0.516458

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  121.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.33113664"
 Parameter: YPOS -> "-6.38301003"
 Parameter: ZPOS -> "60.8554394"
 Parameter: ZPHI -> "13.4860075"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.972427    0.233208    0.000000
   -0.233208    0.972427    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   13.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.331137 XMAX =   -9.331137 XAVE =   -9.331137
    YMIN =   -6.383010 YMAX =   -6.383010 YAVE =   -6.383010
    ZMIN =   60.855439 ZMAX =   60.855439 ZAVE =   60.855439
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.33113663"
Evaluating: -9.33113663+3.5
 Parameter: XMAX <- "-5.83113663"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.38301003"
Evaluating: -6.38301003+3.5
 Parameter: YMAX <- "-2.88301003"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "60.8554394"
Evaluating: 60.8554394+3.5
 Parameter: ZMAX <- "64.3554394"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.33113663"
Evaluating: -9.33113663-3.5
 Parameter: XMIN <- "-12.8311366"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.38301003"
Evaluating: -6.38301003-3.5
 Parameter: YMIN <- "-9.88301003"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "60.8554394"
Evaluating: 60.8554394-3.5
 Parameter: ZMIN <- "57.3554394"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.83113663"
 Parameter: XMIN -> "-12.8311366"
 Parameter: YMAX -> "-2.88301003"
 Parameter: YMIN -> "-9.88301003"
 Parameter: ZMAX -> "64.3554394"
 Parameter: ZMIN -> "57.3554394"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-6.38301003"
 Parameter: YPOS -> "-6.38301003"
 Parameter: XPOS -> "-9.33113664"
 Parameter: XPOS -> "-9.33113664"
Evaluating: SQRT(-6.38301003*-6.38301003+-9.33113664*-9.33113664)
 Parameter: DIST <- "11.305438"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "11.305438" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "36"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "36" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "36" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "36"
 Parameter: NPOS -> "28"
Evaluating: 36-28
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.453105723"
Evaluating: (39-9.0)*(0.453105723-0.5)
 Parameter: XPOS <- "-1.40682831"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "2.016272078E-02"
Evaluating: (39-9.0)*(2.016272078E-02-0.5)
 Parameter: YPOS <- "-14.3951184"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.856493509"
Evaluating: (237.395-9.0)*(0.856493509-0.5)
 Parameter: ZPOS <- "81.421335"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.40682831"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -1.40682831--19.5
 Parameter: XTRAN <- "18.0931717"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.3951184"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -14.3951184--19.5
 Parameter: YTRAN <- "5.1048816"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "81.421335"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 81.421335-118.6975
 Parameter: ZTRAN <- "-37.276165"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.0931717"
 Parameter: YTRAN -> "5.1048816"
 Parameter: ZTRAN -> "-37.276165"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    18.093172    5.104882  -37.276165
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.566099736"
Evaluating: 0.566099736*360.0
 Parameter: XPHI <- "203.795905"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.242840133"
Evaluating: 0.242840133*360.0
 Parameter: YPHI <- "87.4224479"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.359968141"
Evaluating: 0.359968141*360.0
 Parameter: ZPHI <- "129.588531"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.40682831"
 Parameter: YPOS -> "-14.3951184"
 Parameter: ZPOS -> "81.421335"
 Parameter: XPHI -> "203.795905"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.914989   -0.403480
    0.000000    0.403480   -0.914989

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  156.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.40682831"
 Parameter: YPOS -> "-14.3951184"
 Parameter: ZPOS -> "81.421335"
 Parameter: YPHI -> "87.4224479"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.044972    0.000000   -0.998988
    0.000000    1.000000    0.000000
    0.998988    0.000000    0.044972

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   87.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.40682831"
 Parameter: YPOS -> "-14.3951184"
 Parameter: ZPOS -> "81.421335"
 Parameter: ZPHI -> "129.588531"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.637270    0.770641    0.000000
   -0.770641   -0.637270    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  129.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.406828 XMAX =   -1.406828 XAVE =   -1.406828
    YMIN =  -14.395118 YMAX =  -14.395118 YAVE =  -14.395118
    ZMIN =   81.421335 ZMAX =   81.421335 ZAVE =   81.421335
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.40682831"
Evaluating: -1.40682831+3.5
 Parameter: XMAX <- "2.09317169"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.3951184"
Evaluating: -14.3951184+3.5
 Parameter: YMAX <- "-10.8951184"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "81.421335"
Evaluating: 81.421335+3.5
 Parameter: ZMAX <- "84.921335"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.40682831"
Evaluating: -1.40682831-3.5
 Parameter: XMIN <- "-4.90682831"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.3951184"
Evaluating: -14.3951184-3.5
 Parameter: YMIN <- "-17.8951184"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "81.421335"
Evaluating: 81.421335-3.5
 Parameter: ZMIN <- "77.921335"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.09317169"
 Parameter: XMIN -> "-4.90682831"
 Parameter: YMAX -> "-10.8951184"
 Parameter: YMIN -> "-17.8951184"
 Parameter: ZMAX -> "84.921335"
 Parameter: ZMIN -> "77.921335"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-14.3951184"
 Parameter: YPOS -> "-14.3951184"
 Parameter: XPOS -> "-1.40682831"
 Parameter: XPOS -> "-1.40682831"
Evaluating: SQRT(-14.3951184*-14.3951184+-1.40682831*-1.40682831)
 Parameter: DIST <- "14.4636994"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "14.4636994" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "37"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "37" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "37" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "37"
 Parameter: NPOS -> "28"
Evaluating: 37-28
 Parameter: J <- "9"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.319839308"
Evaluating: (39-9.0)*(0.319839308-0.5)
 Parameter: XPOS <- "-5.40482076"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.209345473"
Evaluating: (39-9.0)*(0.209345473-0.5)
 Parameter: YPOS <- "-8.71963581"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.882519438"
Evaluating: (237.395-9.0)*(0.882519438-0.5)
 Parameter: ZPOS <- "87.365527"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.40482076"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -5.40482076--19.5
 Parameter: XTRAN <- "14.0951792"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.71963581"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -8.71963581--19.5
 Parameter: YTRAN <- "10.7803642"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "87.365527"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 87.365527-118.6975
 Parameter: ZTRAN <- "-31.331973"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.0951792"
 Parameter: YTRAN -> "10.7803642"
 Parameter: ZTRAN -> "-31.331973"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    14.095179   10.780364  -31.331973
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.652049639"
Evaluating: 0.652049639*360.0
 Parameter: XPHI <- "234.73787"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.400078589"
Evaluating: 0.400078589*360.0
 Parameter: YPHI <- "144.028292"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.210292937"
Evaluating: 0.210292937*360.0
 Parameter: ZPHI <- "75.7054573"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.40482076"
 Parameter: YPOS -> "-8.71963581"
 Parameter: ZPOS -> "87.365527"
 Parameter: XPHI -> "234.73787"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.577318   -0.816519
    0.000000    0.816519   -0.577318

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  125.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.40482076"
 Parameter: YPOS -> "-8.71963581"
 Parameter: ZPOS -> "87.365527"
 Parameter: YPHI -> "144.028292"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.809307    0.000000   -0.587386
    0.000000    1.000000    0.000000
    0.587386    0.000000   -0.809307

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  144.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.40482076"
 Parameter: YPOS -> "-8.71963581"
 Parameter: ZPOS -> "87.365527"
 Parameter: ZPHI -> "75.7054573"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.246907    0.969039    0.000000
   -0.969039    0.246907    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   75.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.404821 XMAX =   -5.404821 XAVE =   -5.404821
    YMIN =   -8.719636 YMAX =   -8.719636 YAVE =   -8.719636
    ZMIN =   87.365527 ZMAX =   87.365527 ZAVE =   87.365527
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.40482076"
Evaluating: -5.40482076+3.5
 Parameter: XMAX <- "-1.90482076"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.71963584"
Evaluating: -8.71963584+3.5
 Parameter: YMAX <- "-5.21963584"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "87.365527"
Evaluating: 87.365527+3.5
 Parameter: ZMAX <- "90.865527"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.40482076"
Evaluating: -5.40482076-3.5
 Parameter: XMIN <- "-8.90482076"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.71963584"
Evaluating: -8.71963584-3.5
 Parameter: YMIN <- "-12.2196358"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "87.365527"
Evaluating: 87.365527-3.5
 Parameter: ZMIN <- "83.865527"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.90482076"
 Parameter: XMIN -> "-8.90482076"
 Parameter: YMAX -> "-5.21963584"
 Parameter: YMIN -> "-12.2196358"
 Parameter: ZMAX -> "90.865527"
 Parameter: ZMIN -> "83.865527"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-8.71963581"
 Parameter: YPOS -> "-8.71963581"
 Parameter: XPOS -> "-5.40482076"
 Parameter: XPOS -> "-5.40482076"
Evaluating: SQRT(-8.71963581*-8.71963581+-5.40482076*-5.40482076)
 Parameter: DIST <- "10.2588565"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "10.2588565" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "38"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "38" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "38" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "38"
 Parameter: NPOS -> "28"
Evaluating: 38-28
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.914370002"
Evaluating: (39-9.0)*(0.914370002-0.5)
 Parameter: XPOS <- "12.4311001"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.254926958"
Evaluating: (39-9.0)*(0.254926958-0.5)
 Parameter: YPOS <- "-7.35219126"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.609297125"
Evaluating: (237.395-9.0)*(0.609297125-0.5)
 Parameter: ZPOS <- "24.9629169"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.4311001"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 12.4311001--19.5
 Parameter: XTRAN <- "31.9311001"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.35219126"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -7.35219126--19.5
 Parameter: YTRAN <- "12.1478087"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.9629169"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 24.9629169-118.6975
 Parameter: ZTRAN <- "-93.7345831"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.9311001"
 Parameter: YTRAN -> "12.1478087"
 Parameter: ZTRAN -> "-93.7345831"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    31.931100   12.147809  -93.734583
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.773263019"
Evaluating: 0.773263019*360.0
 Parameter: XPHI <- "278.374687"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.800917295"
Evaluating: 0.800917295*360.0
 Parameter: YPHI <- "288.330226"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.262045971"
Evaluating: 0.262045971*360.0
 Parameter: ZPHI <- "94.3365496"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.4311001"
 Parameter: YPOS -> "-7.35219126"
 Parameter: ZPOS -> "24.9629169"
 Parameter: XPHI -> "278.374687"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.145646   -0.989337
    0.000000    0.989337    0.145646

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   81.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.4311001"
 Parameter: YPOS -> "-7.35219126"
 Parameter: ZPOS -> "24.9629169"
 Parameter: YPHI -> "288.330226"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.314493    0.000000    0.949260
    0.000000    1.000000    0.000000
   -0.949260    0.000000    0.314493

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   71.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.4311001"
 Parameter: YPOS -> "-7.35219126"
 Parameter: ZPOS -> "24.9629169"
 Parameter: ZPHI -> "94.3365496"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.075615    0.997137    0.000000
   -0.997137   -0.075615    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   94.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.431100 XMAX =   12.431100 XAVE =   12.431100
    YMIN =   -7.352191 YMAX =   -7.352191 YAVE =   -7.352191
    ZMIN =   24.962917 ZMAX =   24.962917 ZAVE =   24.962917
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.4311001"
Evaluating: 12.4311001+3.5
 Parameter: XMAX <- "15.9311001"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.35219122"
Evaluating: -7.35219122+3.5
 Parameter: YMAX <- "-3.85219122"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.9629169"
Evaluating: 24.9629169+3.5
 Parameter: ZMAX <- "28.4629169"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.4311001"
Evaluating: 12.4311001-3.5
 Parameter: XMIN <- "8.9311001"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.35219122"
Evaluating: -7.35219122-3.5
 Parameter: YMIN <- "-10.8521912"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.9629169"
Evaluating: 24.9629169-3.5
 Parameter: ZMIN <- "21.4629169"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.9311001"
 Parameter: XMIN -> "8.9311001"
 Parameter: YMAX -> "-3.85219122"
 Parameter: YMIN -> "-10.8521912"
 Parameter: ZMAX -> "28.4629169"
 Parameter: ZMIN -> "21.4629169"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-7.35219126"
 Parameter: YPOS -> "-7.35219126"
 Parameter: XPOS -> "12.4311001"
 Parameter: XPOS -> "12.4311001"
Evaluating: SQRT(-7.35219126*-7.35219126+12.4311001*12.4311001)
 Parameter: DIST <- "14.4425402"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "14.4425402" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "39"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "39" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "39" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "39"
 Parameter: NPOS -> "28"
Evaluating: 39-28
 Parameter: J <- "11"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.205885818"
Evaluating: (39-9.0)*(0.205885818-0.5)
 Parameter: XPOS <- "-8.82342546"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.163657574"
Evaluating: (39-9.0)*(0.163657574-0.5)
 Parameter: YPOS <- "-10.0902728"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.222509052"
Evaluating: (237.395-9.0)*(0.222509052-0.5)
 Parameter: ZPOS <- "-63.3775451"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.82342546"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -8.82342546--19.5
 Parameter: XTRAN <- "10.6765745"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-10.0902728"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -10.0902728--19.5
 Parameter: YTRAN <- "9.4097272"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-63.3775451"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -63.3775451-118.6975
 Parameter: ZTRAN <- "-182.075045"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.6765745"
 Parameter: YTRAN -> "9.4097272"
 Parameter: ZTRAN -> "-182.075045"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    10.676574    9.409727 -182.075045
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.856405121"
Evaluating: 0.856405121*360.0
 Parameter: XPHI <- "308.305844"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.429875138"
Evaluating: 0.429875138*360.0
 Parameter: YPHI <- "154.75505"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.393171448"
Evaluating: 0.393171448*360.0
 Parameter: ZPHI <- "141.541721"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.82342546"
 Parameter: YPOS -> "-10.0902728"
 Parameter: ZPOS -> "-63.3775451"
 Parameter: XPHI -> "308.305844"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.619859   -0.784713
    0.000000    0.784713    0.619859

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   51.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.82342546"
 Parameter: YPOS -> "-10.0902728"
 Parameter: ZPOS -> "-63.3775451"
 Parameter: YPHI -> "154.75505"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.904493    0.000000   -0.426489
    0.000000    1.000000    0.000000
    0.426489    0.000000   -0.904493

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  154.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.82342546"
 Parameter: YPOS -> "-10.0902728"
 Parameter: ZPOS -> "-63.3775451"
 Parameter: ZPHI -> "141.541721"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.783061    0.621945    0.000000
   -0.621945   -0.783061    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  141.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.823426 XMAX =   -8.823426 XAVE =   -8.823426
    YMIN =  -10.090273 YMAX =  -10.090273 YAVE =  -10.090273
    ZMIN =  -63.377545 ZMAX =  -63.377545 ZAVE =  -63.377545
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.82342552"
Evaluating: -8.82342552+3.5
 Parameter: XMAX <- "-5.32342552"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-10.0902727"
Evaluating: -10.0902727+3.5
 Parameter: YMAX <- "-6.5902727"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-63.3775452"
Evaluating: -63.3775452+3.5
 Parameter: ZMAX <- "-59.8775452"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.82342552"
Evaluating: -8.82342552-3.5
 Parameter: XMIN <- "-12.3234255"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-10.0902727"
Evaluating: -10.0902727-3.5
 Parameter: YMIN <- "-13.5902727"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-63.3775452"
Evaluating: -63.3775452-3.5
 Parameter: ZMIN <- "-66.8775452"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.32342552"
 Parameter: XMIN -> "-12.3234255"
 Parameter: YMAX -> "-6.5902727"
 Parameter: YMIN -> "-13.5902727"
 Parameter: ZMAX -> "-59.8775452"
 Parameter: ZMIN -> "-66.8775452"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   2680
 SELRPN>      1 atoms have been selected out of   2680

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-10.0902728"
 Parameter: YPOS -> "-10.0902728"
 Parameter: XPOS -> "-8.82342546"
 Parameter: XPOS -> "-8.82342546"
Evaluating: SQRT(-10.0902728*-10.0902728+-8.82342546*-8.82342546)
 Parameter: DIST <- "13.4039711"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "13.4039711" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "40"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "40" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "40"
Evaluating: 40
 Parameter: J <- "40"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "40" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "40"
 Parameter: NPOS -> "28"
Evaluating: 40-28
 Parameter: J <- "12"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.797693535"
Evaluating: (39-9.0)*(0.797693535-0.5)
 Parameter: XPOS <- "8.93080605"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.181338738"
Evaluating: (39-9.0)*(0.181338738-0.5)
 Parameter: YPOS <- "-9.55983786"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.692028575"
Evaluating: (237.395-9.0)*(0.692028575-0.5)
 Parameter: ZPOS <- "43.8583664"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.93080605"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 8.93080605--19.5
 Parameter: XTRAN <- "28.4308061"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.55983786"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -9.55983786--19.5
 Parameter: YTRAN <- "9.94016214"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "43.8583664"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 43.8583664-118.6975
 Parameter: ZTRAN <- "-74.8391336"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.4308061"
 Parameter: YTRAN -> "9.94016214"
 Parameter: ZTRAN -> "-74.8391336"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    28.430806    9.940162  -74.839134
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.148071702"
Evaluating: 0.148071702*360.0
 Parameter: XPHI <- "53.3058127"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.320986993"
Evaluating: 0.320986993*360.0
 Parameter: YPHI <- "115.555317"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.353704494"
Evaluating: 0.353704494*360.0
 Parameter: ZPHI <- "127.333618"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.93080605"
 Parameter: YPOS -> "-9.55983786"
 Parameter: ZPOS -> "43.8583664"
 Parameter: XPHI -> "53.3058127"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.597544    0.801836
    0.000000   -0.801836    0.597544

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   53.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.93080605"
 Parameter: YPOS -> "-9.55983786"
 Parameter: ZPOS -> "43.8583664"
 Parameter: YPHI -> "115.555317"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.431382    0.000000   -0.902169
    0.000000    1.000000    0.000000
    0.902169    0.000000   -0.431382

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  115.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.93080605"
 Parameter: YPOS -> "-9.55983786"
 Parameter: ZPOS -> "43.8583664"
 Parameter: ZPHI -> "127.333618"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.606455    0.795118    0.000000
   -0.795118   -0.606455    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  127.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.930806 XMAX =    8.930806 XAVE =    8.930806
    YMIN =   -9.559838 YMAX =   -9.559838 YAVE =   -9.559838
    ZMIN =   43.858366 ZMAX =   43.858366 ZAVE =   43.858366
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.93080606"
Evaluating: 8.93080606+3.5
 Parameter: XMAX <- "12.4308061"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.55983784"
Evaluating: -9.55983784+3.5
 Parameter: YMAX <- "-6.05983784"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "43.8583664"
Evaluating: 43.8583664+3.5
 Parameter: ZMAX <- "47.3583664"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.93080606"
Evaluating: 8.93080606-3.5
 Parameter: XMIN <- "5.43080606"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.55983784"
Evaluating: -9.55983784-3.5
 Parameter: YMIN <- "-13.0598378"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "43.8583664"
Evaluating: 43.8583664-3.5
 Parameter: ZMIN <- "40.3583664"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.4308061"
 Parameter: XMIN -> "5.43080606"
 Parameter: YMAX -> "-6.05983784"
 Parameter: YMIN -> "-13.0598378"
 Parameter: ZMAX -> "47.3583664"
 Parameter: ZMIN -> "40.3583664"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-9.55983786"
 Parameter: YPOS -> "-9.55983786"
 Parameter: XPOS -> "8.93080605"
 Parameter: XPOS -> "8.93080605"
Evaluating: SQRT(-9.55983786*-9.55983786+8.93080605*8.93080605)
 Parameter: DIST <- "13.0824232"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "13.0824232" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "41"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "41" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "41"
Evaluating: 41
 Parameter: J <- "41"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "41" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "41"
 Parameter: NPOS -> "28"
Evaluating: 41-28
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "7.290110337E-02"
Evaluating: (39-9.0)*(7.290110337E-02-0.5)
 Parameter: XPOS <- "-12.8129669"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.839362274"
Evaluating: (39-9.0)*(0.839362274-0.5)
 Parameter: YPOS <- "10.1808682"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.83315523"
Evaluating: (237.395-9.0)*(0.83315523-0.5)
 Parameter: ZPOS <- "76.0909888"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.8129669"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -12.8129669--19.5
 Parameter: XTRAN <- "6.6870331"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.1808682"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 10.1808682--19.5
 Parameter: YTRAN <- "29.6808682"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "76.0909888"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 76.0909888-118.6975
 Parameter: ZTRAN <- "-42.6065112"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.6870331"
 Parameter: YTRAN -> "29.6808682"
 Parameter: ZTRAN -> "-42.6065112"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR     6.687033   29.680868  -42.606511
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.177238887"
Evaluating: 0.177238887*360.0
 Parameter: XPHI <- "63.8059993"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.289332923"
Evaluating: 0.289332923*360.0
 Parameter: YPHI <- "104.159852"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.150847403"
Evaluating: 0.150847403*360.0
 Parameter: ZPHI <- "54.3050651"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.8129669"
 Parameter: YPOS -> "10.1808682"
 Parameter: ZPOS -> "76.0909888"
 Parameter: XPHI -> "63.8059993"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.441412    0.897305
    0.000000   -0.897305    0.441412

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   63.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.8129669"
 Parameter: YPOS -> "10.1808682"
 Parameter: ZPOS -> "76.0909888"
 Parameter: YPHI -> "104.159852"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.244628    0.000000   -0.969617
    0.000000    1.000000    0.000000
    0.969617    0.000000   -0.244628

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  104.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.8129669"
 Parameter: YPOS -> "10.1808682"
 Parameter: ZPOS -> "76.0909888"
 Parameter: ZPHI -> "54.3050651"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.583469    0.812135    0.000000
   -0.812135    0.583469    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   54.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.812967 XMAX =  -12.812967 XAVE =  -12.812967
    YMIN =   10.180868 YMAX =   10.180868 YAVE =   10.180868
    ZMIN =   76.090989 ZMAX =   76.090989 ZAVE =   76.090989
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.8129669"
Evaluating: -12.8129669+3.5
 Parameter: XMAX <- "-9.3129669"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.1808682"
Evaluating: 10.1808682+3.5
 Parameter: YMAX <- "13.6808682"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "76.0909888"
Evaluating: 76.0909888+3.5
 Parameter: ZMAX <- "79.5909888"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.8129669"
Evaluating: -12.8129669-3.5
 Parameter: XMIN <- "-16.3129669"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.1808682"
Evaluating: 10.1808682-3.5
 Parameter: YMIN <- "6.6808682"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "76.0909888"
Evaluating: 76.0909888-3.5
 Parameter: ZMIN <- "72.5909888"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.3129669"
 Parameter: XMIN -> "-16.3129669"
 Parameter: YMAX -> "13.6808682"
 Parameter: YMIN -> "6.6808682"
 Parameter: ZMAX -> "79.5909888"
 Parameter: ZMIN -> "72.5909888"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "10.1808682"
 Parameter: YPOS -> "10.1808682"
 Parameter: XPOS -> "-12.8129669"
 Parameter: XPOS -> "-12.8129669"
Evaluating: SQRT(10.1808682*10.1808682+-12.8129669*-12.8129669)
 Parameter: DIST <- "16.3652742"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "16.3652742" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "42"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "42" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "42" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "42"
 Parameter: NPOS -> "28"
Evaluating: 42-28
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.356396989"
Evaluating: (39-9.0)*(0.356396989-0.5)
 Parameter: XPOS <- "-4.30809033"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.480875063"
Evaluating: (39-9.0)*(0.480875063-0.5)
 Parameter: YPOS <- "-0.57374811"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.963112299"
Evaluating: (237.395-9.0)*(0.963112299-0.5)
 Parameter: ZPOS <- "105.772534"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.30809033"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -4.30809033--19.5
 Parameter: XTRAN <- "15.1919097"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.57374811"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -0.57374811--19.5
 Parameter: YTRAN <- "18.9262519"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "105.772534"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 105.772534-118.6975
 Parameter: ZTRAN <- "-12.924966"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.1919097"
 Parameter: YTRAN -> "18.9262519"
 Parameter: ZTRAN -> "-12.924966"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    15.191910   18.926252  -12.924966
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.888557305"
Evaluating: 0.888557305*360.0
 Parameter: XPHI <- "319.88063"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.74535455"
Evaluating: 0.74535455*360.0
 Parameter: YPHI <- "268.327638"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.533836235E-02"
Evaluating: 8.533836235E-02*360.0
 Parameter: ZPHI <- "30.7218104"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.30809033"
 Parameter: YPOS -> "-0.57374811"
 Parameter: ZPOS -> "105.772534"
 Parameter: XPHI -> "319.88063"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.764704   -0.644382
    0.000000    0.644382    0.764704

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   40.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.30809033"
 Parameter: YPOS -> "-0.57374811"
 Parameter: ZPOS -> "105.772534"
 Parameter: YPHI -> "268.327638"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.029184    0.000000    0.999574
    0.000000    1.000000    0.000000
   -0.999574    0.000000   -0.029184

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   91.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.30809033"
 Parameter: YPOS -> "-0.57374811"
 Parameter: ZPOS -> "105.772534"
 Parameter: ZPHI -> "30.7218104"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.859658    0.510870    0.000000
   -0.510870    0.859658    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   30.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.308090 XMAX =   -4.308090 XAVE =   -4.308090
    YMIN =   -0.573748 YMAX =   -0.573748 YAVE =   -0.573748
    ZMIN =  105.772534 ZMAX =  105.772534 ZAVE =  105.772534
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.30809032"
Evaluating: -4.30809032+3.5
 Parameter: XMAX <- "-0.80809032"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.573748106"
Evaluating: -0.573748106+3.5
 Parameter: YMAX <- "2.92625189"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "105.772534"
Evaluating: 105.772534+3.5
 Parameter: ZMAX <- "109.272534"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.30809032"
Evaluating: -4.30809032-3.5
 Parameter: XMIN <- "-7.80809032"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.573748106"
Evaluating: -0.573748106-3.5
 Parameter: YMIN <- "-4.07374811"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "105.772534"
Evaluating: 105.772534-3.5
 Parameter: ZMIN <- "102.272534"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.80809032"
 Parameter: XMIN -> "-7.80809032"
 Parameter: YMAX -> "2.92625189"
 Parameter: YMIN -> "-4.07374811"
 Parameter: ZMAX -> "109.272534"
 Parameter: ZMIN -> "102.272534"
 SELRPN>     23 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "23"
 Comparing "23" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   2680
 SELRPN>     23 atoms have been selected out of   2680

            DISTANCES FOR SELECTED ATOMS
 2522 NEG      CLA      14       CLA     -  35 NM       TUBE     1        CZ            2.1656
 2522 NEG      CLA      14       CLA     -  44 NM       TUBE     1        C18           3.0213
 2522 NEG      CLA      14       CLA     - 116 NM       TUBE     1        C38           1.4589
 2522 NEG      CLA      14       CLA     - 198 NM       TUBE     1        C5I           2.6900
 2522 NEG      CLA      14       CLA     - 279 NM       TUBE     1        C7R           3.2645
 2522 NEG      CLA      14       CLA     - 316 NM       TUBE     1        C8S           2.2776
 2522 NEG      CLA      14       CLA     - 397 NM       TUBE     1        CB1           2.9550
 2522 NEG      CLA      14       CLA     - 487 NM       TUBE     1        CDJ           2.8421
 2522 NEG      CLA      14       CLA     - 736 NM       TUBE     1        CKG           3.5301
 2522 NEG      CLA      14       CLA     - 819 NM       TUBE     1        CMR           4.1439
 2522 NEG      CLA      14       CLA     - 901 NM       TUBE     1        CP1           3.7976
 2522 NEG      CLA      14       CLA     -1055 NM       TUBE     1        CTB           3.1937
 2522 NEG      CLA      14       CLA     -1345 NM       TUBE     1        C11D          3.7178
 2522 NEG      CLA      14       CLA     -1550 NM       TUBE     1        C172          3.3834
 2522 NEG      CLA      14       CLA     -2030 NM       TUBE     1        C1KE          4.3289
 2522 NEG      CLA      14       CLA     -2198 NM       TUBE     1        C1P2          1.8947
 2522 NEG      CLA      14       CLA     -2274 NM       TUBE     1        C1R6          1.0220
 2522 NEG      CLA      14       CLA     -2357 NM       TUBE     1        C1TH          0.5709
 2522 NEG      CLA      14       CLA     -2434 NM       TUBE     1        C1VM          2.3313
 2522 NEG      CLA      14       CLA     -2443 NM       TUBE     1        C1VV          1.9584
 2522 NEG      CLA      14       CLA     -2472 NM       TUBE     1        C1WO          4.3268
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        21
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "21"
 Comparing "21" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "42" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "42"
 Parameter: NPOS -> "28"
Evaluating: 42-28
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.644538043"
Evaluating: (39-9.0)*(0.644538043-0.5)
 Parameter: XPOS <- "4.33614129"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.70417516"
Evaluating: (39-9.0)*(0.70417516-0.5)
 Parameter: YPOS <- "6.1252548"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.667803424"
Evaluating: (237.395-9.0)*(0.667803424-0.5)
 Parameter: ZPOS <- "38.325463"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.308090 XMAX =   -4.308090 XAVE =   -4.308090
    YMIN =   -0.573748 YMAX =   -0.573748 YAVE =   -0.573748
    ZMIN =  105.772534 ZMAX =  105.772534 ZAVE =  105.772534
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.33614129"
 RDCMND substituted energy or value "?XAVE" to "-4.30809032"
Evaluating: 4.33614129--4.30809032
 Parameter: XTRAN <- "8.64423161"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.1252548"
 RDCMND substituted energy or value "?YAVE" to "-0.573748106"
Evaluating: 6.1252548--0.573748106
 Parameter: YTRAN <- "6.69900291"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.325463"
 RDCMND substituted energy or value "?ZAVE" to "105.772534"
Evaluating: 38.325463-105.772534
 Parameter: ZTRAN <- "-67.447071"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.64423161"
 Parameter: YTRAN -> "6.69900291"
 Parameter: ZTRAN -> "-67.447071"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR     8.644232    6.699003  -67.447071
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.533515182"
Evaluating: 0.533515182*360.0
 Parameter: XPHI <- "192.065466"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.824290639"
Evaluating: 0.824290639*360.0
 Parameter: YPHI <- "296.74463"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.328028645E-02"
Evaluating: 9.328028645E-02*360.0
 Parameter: ZPHI <- "33.5809031"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.33614129"
 Parameter: YPOS -> "6.1252548"
 Parameter: ZPOS -> "38.325463"
 Parameter: XPHI -> "192.065466"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.977909   -0.209029
    0.000000    0.209029   -0.977909

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  167.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.33614129"
 Parameter: YPOS -> "6.1252548"
 Parameter: ZPOS -> "38.325463"
 Parameter: YPHI -> "296.74463"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.450015    0.000000    0.893021
    0.000000    1.000000    0.000000
   -0.893021    0.000000    0.450015

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   63.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.33614129"
 Parameter: YPOS -> "6.1252548"
 Parameter: ZPOS -> "38.325463"
 Parameter: ZPHI -> "33.5809031"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.833106    0.553114    0.000000
   -0.553114    0.833106    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   33.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.336141 XMAX =    4.336141 XAVE =    4.336141
    YMIN =    6.125255 YMAX =    6.125255 YAVE =    6.125255
    ZMIN =   38.325463 ZMAX =   38.325463 ZAVE =   38.325463
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.33614131"
Evaluating: 4.33614131+3.5
 Parameter: XMAX <- "7.83614131"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.12525479"
Evaluating: 6.12525479+3.5
 Parameter: YMAX <- "9.62525479"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.325463"
Evaluating: 38.325463+3.5
 Parameter: ZMAX <- "41.825463"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.33614131"
Evaluating: 4.33614131-3.5
 Parameter: XMIN <- "0.83614131"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.12525479"
Evaluating: 6.12525479-3.5
 Parameter: YMIN <- "2.62525479"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.325463"
Evaluating: 38.325463-3.5
 Parameter: ZMIN <- "34.825463"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.83614131"
 Parameter: XMIN -> "0.83614131"
 Parameter: YMAX -> "9.62525479"
 Parameter: YMIN -> "2.62525479"
 Parameter: ZMAX -> "41.825463"
 Parameter: ZMIN -> "34.825463"
 SELRPN>      9 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   2680
 SELRPN>      9 atoms have been selected out of   2680

            DISTANCES FOR SELECTED ATOMS
 2522 NEG      CLA      14       CLA     -1832 NM       TUBE     1        C1EW          3.7282
 2522 NEG      CLA      14       CLA     -1912 NM       TUBE     1        C1H4          3.5222
 2522 NEG      CLA      14       CLA     -1992 NM       TUBE     1        C1JC          4.3598
 2522 NEG      CLA      14       CLA     -2046 NM       TUBE     1        C1KU          4.1558
 2522 NEG      CLA      14       CLA     -2134 NM       TUBE     1        C1NA          3.3967
 2522 NEG      CLA      14       CLA     -2212 NM       TUBE     1        C1PG          3.4218
 2522 NEG      CLA      14       CLA     -2289 NM       TUBE     1        C1RL          3.5387
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "42" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "42"
 Parameter: NPOS -> "28"
Evaluating: 42-28
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.503345932"
Evaluating: (39-9.0)*(0.503345932-0.5)
 Parameter: XPOS <- "0.10037796"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.334216258"
Evaluating: (39-9.0)*(0.334216258-0.5)
 Parameter: YPOS <- "-4.97351226"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.868809608"
Evaluating: (237.395-9.0)*(0.868809608-0.5)
 Parameter: ZPOS <- "84.2342704"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.336141 XMAX =    4.336141 XAVE =    4.336141
    YMIN =    6.125255 YMAX =    6.125255 YAVE =    6.125255
    ZMIN =   38.325463 ZMAX =   38.325463 ZAVE =   38.325463
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.10037796"
 RDCMND substituted energy or value "?XAVE" to "4.33614131"
Evaluating: 0.10037796-4.33614131
 Parameter: XTRAN <- "-4.23576335"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.97351226"
 RDCMND substituted energy or value "?YAVE" to "6.12525479"
Evaluating: -4.97351226-6.12525479
 Parameter: YTRAN <- "-11.098767"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "84.2342704"
 RDCMND substituted energy or value "?ZAVE" to "38.325463"
Evaluating: 84.2342704-38.325463
 Parameter: ZTRAN <- "45.9088074"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.23576335"
 Parameter: YTRAN -> "-11.098767"
 Parameter: ZTRAN -> "45.9088074"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    -4.235763  -11.098767   45.908807
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.61943567"
Evaluating: 0.61943567*360.0
 Parameter: XPHI <- "222.996841"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.1601622"
Evaluating: 0.1601622*360.0
 Parameter: YPHI <- "57.658392"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.772633115"
Evaluating: 0.772633115*360.0
 Parameter: ZPHI <- "278.147921"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.10037796"
 Parameter: YPOS -> "-4.97351226"
 Parameter: ZPOS -> "84.2342704"
 Parameter: XPHI -> "222.996841"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.731391   -0.681958
    0.000000    0.681958   -0.731391

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  137.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.10037796"
 Parameter: YPOS -> "-4.97351226"
 Parameter: ZPOS -> "84.2342704"
 Parameter: YPHI -> "57.658392"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.534966    0.000000   -0.844874
    0.000000    1.000000    0.000000
    0.844874    0.000000    0.534966

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   57.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.10037796"
 Parameter: YPOS -> "-4.97351226"
 Parameter: ZPOS -> "84.2342704"
 Parameter: ZPHI -> "278.147921"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.141729   -0.989905    0.000000
    0.989905    0.141729    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   81.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.100378 XMAX =    0.100378 XAVE =    0.100378
    YMIN =   -4.973512 YMAX =   -4.973512 YAVE =   -4.973512
    ZMIN =   84.234270 ZMAX =   84.234270 ZAVE =   84.234270
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.100378002"
Evaluating: 0.100378002+3.5
 Parameter: XMAX <- "3.600378"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.97351228"
Evaluating: -4.97351228+3.5
 Parameter: YMAX <- "-1.47351228"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "84.2342704"
Evaluating: 84.2342704+3.5
 Parameter: ZMAX <- "87.7342704"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.100378002"
Evaluating: 0.100378002-3.5
 Parameter: XMIN <- "-3.399622"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.97351228"
Evaluating: -4.97351228-3.5
 Parameter: YMIN <- "-8.47351228"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "84.2342704"
Evaluating: 84.2342704-3.5
 Parameter: ZMIN <- "80.7342704"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.600378"
 Parameter: XMIN -> "-3.399622"
 Parameter: YMAX -> "-1.47351228"
 Parameter: YMIN -> "-8.47351228"
 Parameter: ZMAX -> "87.7342704"
 Parameter: ZMIN -> "80.7342704"
 SELRPN>     22 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "22"
 Comparing "22" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   2680
 SELRPN>     22 atoms have been selected out of   2680

            DISTANCES FOR SELECTED ATOMS
 2522 NEG      CLA      14       CLA     -  14 NM       TUBE     1        CE            0.7809
 2522 NEG      CLA      14       CLA     -  41 NM       TUBE     1        C15           3.7946
 2522 NEG      CLA      14       CLA     -  98 NM       TUBE     1        C2Q           1.2029
 2522 NEG      CLA      14       CLA     - 220 NM       TUBE     1        C64           3.3332
 2522 NEG      CLA      14       CLA     - 302 NM       TUBE     1        C8E           2.7998
 2522 NEG      CLA      14       CLA     - 308 NM       TUBE     1        C8K           3.3871
 2522 NEG      CLA      14       CLA     - 385 NM       TUBE     1        CAP           1.6326
 2522 NEG      CLA      14       CLA     - 455 NM       TUBE     1        CCN           3.5453
 2522 NEG      CLA      14       CLA     - 470 NM       TUBE     1        CD2           2.4393
 2522 NEG      CLA      14       CLA     - 553 NM       TUBE     1        CFD           2.6253
 2522 NEG      CLA      14       CLA     - 639 NM       TUBE     1        CHR           4.0239
 2522 NEG      CLA      14       CLA     -1374 NM       TUBE     1        C126          2.3920
 2522 NEG      CLA      14       CLA     -1604 NM       TUBE     1        C18K          4.4218
 2522 NEG      CLA      14       CLA     -1696 NM       TUBE     1        C1B4          2.9487
 2522 NEG      CLA      14       CLA     -2109 NM       TUBE     1        C1ML          4.4635
 2522 NEG      CLA      14       CLA     -2116 NM       TUBE     1        C1MS          3.0763
 2522 NEG      CLA      14       CLA     -2191 NM       TUBE     1        C1OV          2.1188
 2522 NEG      CLA      14       CLA     -2244 NM       TUBE     1        C1QC          4.3920
 2522 NEG      CLA      14       CLA     -2326 NM       TUBE     1        C1SM          3.0786
 2522 NEG      CLA      14       CLA     -2411 NM       TUBE     1        C1UZ          2.0444
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        20
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "20"
 Comparing "20" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "42" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "42"
 Parameter: NPOS -> "28"
Evaluating: 42-28
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.409801794"
Evaluating: (39-9.0)*(0.409801794-0.5)
 Parameter: XPOS <- "-2.70594618"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.389632171"
Evaluating: (39-9.0)*(0.389632171-0.5)
 Parameter: YPOS <- "-3.31103487"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.14194645"
Evaluating: (237.395-9.0)*(0.14194645-0.5)
 Parameter: ZPOS <- "-81.7776406"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.100378 XMAX =    0.100378 XAVE =    0.100378
    YMIN =   -4.973512 YMAX =   -4.973512 YAVE =   -4.973512
    ZMIN =   84.234270 ZMAX =   84.234270 ZAVE =   84.234270
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.70594618"
 RDCMND substituted energy or value "?XAVE" to "0.100378002"
Evaluating: -2.70594618-0.100378002
 Parameter: XTRAN <- "-2.80632418"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.31103487"
 RDCMND substituted energy or value "?YAVE" to "-4.97351228"
Evaluating: -3.31103487--4.97351228
 Parameter: YTRAN <- "1.66247741"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-81.7776406"
 RDCMND substituted energy or value "?ZAVE" to "84.2342704"
Evaluating: -81.7776406-84.2342704
 Parameter: ZTRAN <- "-166.011911"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.80632418"
 Parameter: YTRAN -> "1.66247741"
 Parameter: ZTRAN -> "-166.011911"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    -2.806324    1.662477 -166.011911
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.776351645"
Evaluating: 0.776351645*360.0
 Parameter: XPHI <- "279.486592"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.215999685"
Evaluating: 0.215999685*360.0
 Parameter: YPHI <- "77.7598866"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.170503196"
Evaluating: 0.170503196*360.0
 Parameter: ZPHI <- "61.3811506"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.70594618"
 Parameter: YPOS -> "-3.31103487"
 Parameter: ZPOS -> "-81.7776406"
 Parameter: XPHI -> "279.486592"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.164817   -0.986324
    0.000000    0.986324    0.164817

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   80.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.70594618"
 Parameter: YPOS -> "-3.31103487"
 Parameter: ZPOS -> "-81.7776406"
 Parameter: YPHI -> "77.7598866"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.212009    0.000000   -0.977268
    0.000000    1.000000    0.000000
    0.977268    0.000000    0.212009

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   77.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.70594618"
 Parameter: YPOS -> "-3.31103487"
 Parameter: ZPOS -> "-81.7776406"
 Parameter: ZPHI -> "61.3811506"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.478981    0.877825    0.000000
   -0.877825    0.478981    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   61.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.705946 XMAX =   -2.705946 XAVE =   -2.705946
    YMIN =   -3.311035 YMAX =   -3.311035 YAVE =   -3.311035
    ZMIN =  -81.777641 ZMAX =  -81.777641 ZAVE =  -81.777641
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.70594619"
Evaluating: -2.70594619+3.5
 Parameter: XMAX <- "0.79405381"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.31103488"
Evaluating: -3.31103488+3.5
 Parameter: YMAX <- "0.18896512"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-81.7776406"
Evaluating: -81.7776406+3.5
 Parameter: ZMAX <- "-78.2776406"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.70594619"
Evaluating: -2.70594619-3.5
 Parameter: XMIN <- "-6.20594619"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.31103488"
Evaluating: -3.31103488-3.5
 Parameter: YMIN <- "-6.81103488"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-81.7776406"
Evaluating: -81.7776406-3.5
 Parameter: ZMIN <- "-85.2776406"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.79405381"
 Parameter: XMIN -> "-6.20594619"
 Parameter: YMAX -> "0.18896512"
 Parameter: YMIN -> "-6.81103488"
 Parameter: ZMAX -> "-78.2776406"
 Parameter: ZMIN -> "-85.2776406"
 SELRPN>     19 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "19"
 Comparing "19" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   2680
 SELRPN>     19 atoms have been selected out of   2680

            DISTANCES FOR SELECTED ATOMS
 2522 NEG      CLA      14       CLA     - 241 NM       TUBE     1        C6P           3.7034
 2522 NEG      CLA      14       CLA     - 244 NM       TUBE     1        C6S           4.2593
 2522 NEG      CLA      14       CLA     - 285 NM       TUBE     1        C7X           2.0397
 2522 NEG      CLA      14       CLA     - 319 NM       TUBE     1        C8V           0.4372
 2522 NEG      CLA      14       CLA     - 351 NM       TUBE     1        C9R           2.8649
 2522 NEG      CLA      14       CLA     - 548 NM       TUBE     1        CF8           4.1398
 2522 NEG      CLA      14       CLA     - 605 NM       TUBE     1        CGT           3.7329
 2522 NEG      CLA      14       CLA     - 615 NM       TUBE     1        CH3           2.1653
 2522 NEG      CLA      14       CLA     -1146 NM       TUBE     1        CVU           3.3151
 2522 NEG      CLA      14       CLA     -1178 NM       TUBE     1        CWQ           2.7683
 2522 NEG      CLA      14       CLA     -1195 NM       TUBE     1        CX7           2.6282
 2522 NEG      CLA      14       CLA     -1295 NM       TUBE     1        CZZ           3.2929
 2522 NEG      CLA      14       CLA     -1299 NM       TUBE     1        C103          1.0189
 2522 NEG      CLA      14       CLA     -1302 NM       TUBE     1        C106          1.7638
 2522 NEG      CLA      14       CLA     -1620 NM       TUBE     1        C190          2.5443
 2522 NEG      CLA      14       CLA     -2049 NM       TUBE     1        C1KX          2.3588
 2522 NEG      CLA      14       CLA     -2050 NM       TUBE     1        C1KY          1.5508
 2522 NEG      CLA      14       CLA     -2053 NM       TUBE     1        C1L1          2.6968
 2522 NEG      CLA      14       CLA     -2056 NM       TUBE     1        C1L4          3.1764
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        19
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "19"
 Comparing "19" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "42" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "42"
 Parameter: NPOS -> "28"
Evaluating: 42-28
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.906009639"
Evaluating: (39-9.0)*(0.906009639-0.5)
 Parameter: XPOS <- "12.1802892"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.179358806"
Evaluating: (39-9.0)*(0.179358806-0.5)
 Parameter: YPOS <- "-9.61923582"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.42041118"
Evaluating: (237.395-9.0)*(0.42041118-0.5)
 Parameter: ZPOS <- "-18.1776885"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.705946 XMAX =   -2.705946 XAVE =   -2.705946
    YMIN =   -3.311035 YMAX =   -3.311035 YAVE =   -3.311035
    ZMIN =  -81.777641 ZMAX =  -81.777641 ZAVE =  -81.777641
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.1802892"
 RDCMND substituted energy or value "?XAVE" to "-2.70594619"
Evaluating: 12.1802892--2.70594619
 Parameter: XTRAN <- "14.8862354"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.61923582"
 RDCMND substituted energy or value "?YAVE" to "-3.31103488"
Evaluating: -9.61923582--3.31103488
 Parameter: YTRAN <- "-6.30820094"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.1776885"
 RDCMND substituted energy or value "?ZAVE" to "-81.7776406"
Evaluating: -18.1776885--81.7776406
 Parameter: ZTRAN <- "63.5999521"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.8862354"
 Parameter: YTRAN -> "-6.30820094"
 Parameter: ZTRAN -> "63.5999521"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    14.886235   -6.308201   63.599952
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.415529276"
Evaluating: 0.415529276*360.0
 Parameter: XPHI <- "149.590539"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.325167761"
Evaluating: 0.325167761*360.0
 Parameter: YPHI <- "117.060394"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.579303597"
Evaluating: 0.579303597*360.0
 Parameter: ZPHI <- "208.549295"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.1802892"
 Parameter: YPOS -> "-9.61923582"
 Parameter: ZPOS -> "-18.1776885"
 Parameter: XPHI -> "149.590539"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.862430    0.506176
    0.000000   -0.506176   -0.862430

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  149.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.1802892"
 Parameter: YPOS -> "-9.61923582"
 Parameter: ZPOS -> "-18.1776885"
 Parameter: YPHI -> "117.060394"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.454929    0.000000   -0.890527
    0.000000    1.000000    0.000000
    0.890527    0.000000   -0.454929

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  117.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.1802892"
 Parameter: YPOS -> "-9.61923582"
 Parameter: ZPOS -> "-18.1776885"
 Parameter: ZPHI -> "208.549295"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.878406   -0.477915    0.000000
    0.477915   -0.878406    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  151.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.180289 XMAX =   12.180289 XAVE =   12.180289
    YMIN =   -9.619236 YMAX =   -9.619236 YAVE =   -9.619236
    ZMIN =  -18.177688 ZMAX =  -18.177688 ZAVE =  -18.177688
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.1802892"
Evaluating: 12.1802892+3.5
 Parameter: XMAX <- "15.6802892"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.61923582"
Evaluating: -9.61923582+3.5
 Parameter: YMAX <- "-6.11923582"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.1776885"
Evaluating: -18.1776885+3.5
 Parameter: ZMAX <- "-14.6776885"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.1802892"
Evaluating: 12.1802892-3.5
 Parameter: XMIN <- "8.6802892"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.61923582"
Evaluating: -9.61923582-3.5
 Parameter: YMIN <- "-13.1192358"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.1776885"
Evaluating: -18.1776885-3.5
 Parameter: ZMIN <- "-21.6776885"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.6802892"
 Parameter: XMIN -> "8.6802892"
 Parameter: YMAX -> "-6.11923582"
 Parameter: YMIN -> "-13.1192358"
 Parameter: ZMAX -> "-14.6776885"
 Parameter: ZMIN -> "-21.6776885"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   2680
 SELRPN>      1 atoms have been selected out of   2680

            DISTANCES FOR SELECTED ATOMS
 2522 NEG      CLA      14       CLA     -2486 POS      POT      6        POT           4.1491
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "42" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "42"
 Parameter: NPOS -> "28"
Evaluating: 42-28
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.657500341"
Evaluating: (39-9.0)*(0.657500341-0.5)
 Parameter: XPOS <- "4.72501023"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.911040383"
Evaluating: (39-9.0)*(0.911040383-0.5)
 Parameter: YPOS <- "12.3312115"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.565914077"
Evaluating: (237.395-9.0)*(0.565914077-0.5)
 Parameter: ZPOS <- "15.0544456"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.180289 XMAX =   12.180289 XAVE =   12.180289
    YMIN =   -9.619236 YMAX =   -9.619236 YAVE =   -9.619236
    ZMIN =  -18.177688 ZMAX =  -18.177688 ZAVE =  -18.177688
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.72501023"
 RDCMND substituted energy or value "?XAVE" to "12.1802892"
Evaluating: 4.72501023-12.1802892
 Parameter: XTRAN <- "-7.45527897"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.3312115"
 RDCMND substituted energy or value "?YAVE" to "-9.61923582"
Evaluating: 12.3312115--9.61923582
 Parameter: YTRAN <- "21.9504473"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.0544456"
 RDCMND substituted energy or value "?ZAVE" to "-18.1776885"
Evaluating: 15.0544456--18.1776885
 Parameter: ZTRAN <- "33.2321341"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.45527897"
 Parameter: YTRAN -> "21.9504473"
 Parameter: ZTRAN -> "33.2321341"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    -7.455279   21.950447   33.232134
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.645163063"
Evaluating: 0.645163063*360.0
 Parameter: XPHI <- "232.258703"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.214662302"
Evaluating: 0.214662302*360.0
 Parameter: YPHI <- "77.2784287"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.355293482"
Evaluating: 0.355293482*360.0
 Parameter: ZPHI <- "127.905654"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.72501023"
 Parameter: YPOS -> "12.3312115"
 Parameter: ZPOS -> "15.0544456"
 Parameter: XPHI -> "232.258703"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.612097   -0.790783
    0.000000    0.790783   -0.612097

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  127.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.72501023"
 Parameter: YPOS -> "12.3312115"
 Parameter: ZPOS -> "15.0544456"
 Parameter: YPHI -> "77.2784287"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.220213    0.000000   -0.975452
    0.000000    1.000000    0.000000
    0.975452    0.000000    0.220213

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   77.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.72501023"
 Parameter: YPOS -> "12.3312115"
 Parameter: ZPOS -> "15.0544456"
 Parameter: ZPHI -> "127.905654"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.614363    0.789023    0.000000
   -0.789023   -0.614363    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  127.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.725010 XMAX =    4.725010 XAVE =    4.725010
    YMIN =   12.331211 YMAX =   12.331211 YAVE =   12.331211
    ZMIN =   15.054446 ZMAX =   15.054446 ZAVE =   15.054446
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.72501022"
Evaluating: 4.72501022+3.5
 Parameter: XMAX <- "8.22501022"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.3312115"
Evaluating: 12.3312115+3.5
 Parameter: YMAX <- "15.8312115"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.0544456"
Evaluating: 15.0544456+3.5
 Parameter: ZMAX <- "18.5544456"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.72501022"
Evaluating: 4.72501022-3.5
 Parameter: XMIN <- "1.22501022"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.3312115"
Evaluating: 12.3312115-3.5
 Parameter: YMIN <- "8.8312115"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.0544456"
Evaluating: 15.0544456-3.5
 Parameter: ZMIN <- "11.5544456"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.22501022"
 Parameter: XMIN -> "1.22501022"
 Parameter: YMAX -> "15.8312115"
 Parameter: YMIN -> "8.8312115"
 Parameter: ZMAX -> "18.5544456"
 Parameter: ZMIN -> "11.5544456"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "12.3312115"
 Parameter: YPOS -> "12.3312115"
 Parameter: XPOS -> "4.72501023"
 Parameter: XPOS -> "4.72501023"
Evaluating: SQRT(12.3312115*12.3312115+4.72501023*4.72501023)
 Parameter: DIST <- "13.2054723"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "13.2054723" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "43"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "43" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "43" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "43"
 Parameter: NPOS -> "28"
Evaluating: 43-28
 Parameter: J <- "15"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.40447001"
Evaluating: (39-9.0)*(0.40447001-0.5)
 Parameter: XPOS <- "-2.8658997"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.958437158"
Evaluating: (39-9.0)*(0.958437158-0.5)
 Parameter: YPOS <- "13.7531147"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.822889242"
Evaluating: (237.395-9.0)*(0.822889242-0.5)
 Parameter: ZPOS <- "73.7462884"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.8658997"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -2.8658997--19.5
 Parameter: XTRAN <- "16.6341003"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.7531147"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 13.7531147--19.5
 Parameter: YTRAN <- "33.2531147"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "73.7462884"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 73.7462884-118.6975
 Parameter: ZTRAN <- "-44.9512116"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "16.6341003"
 Parameter: YTRAN -> "33.2531147"
 Parameter: ZTRAN -> "-44.9512116"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    16.634100   33.253115  -44.951212
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.701925682"
Evaluating: 0.701925682*360.0
 Parameter: XPHI <- "252.693246"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.1040672E-02"
Evaluating: 4.1040672E-02*360.0
 Parameter: YPHI <- "14.7746419"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.473639407"
Evaluating: 0.473639407*360.0
 Parameter: ZPHI <- "170.510187"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.8658997"
 Parameter: YPOS -> "13.7531147"
 Parameter: ZPOS -> "73.7462884"
 Parameter: XPHI -> "252.693246"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.297487   -0.954726
    0.000000    0.954726   -0.297487

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  107.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.8658997"
 Parameter: YPOS -> "13.7531147"
 Parameter: ZPOS -> "73.7462884"
 Parameter: YPHI -> "14.7746419"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.966936    0.000000   -0.255018
    0.000000    1.000000    0.000000
    0.255018    0.000000    0.966936

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   14.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.8658997"
 Parameter: YPOS -> "13.7531147"
 Parameter: ZPOS -> "73.7462884"
 Parameter: ZPHI -> "170.510187"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.986315    0.164872    0.000000
   -0.164872   -0.986315    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  170.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.865900 XMAX =   -2.865900 XAVE =   -2.865900
    YMIN =   13.753115 YMAX =   13.753115 YAVE =   13.753115
    ZMIN =   73.746288 ZMAX =   73.746288 ZAVE =   73.746288
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.8658997"
Evaluating: -2.8658997+3.5
 Parameter: XMAX <- "0.6341003"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.7531147"
Evaluating: 13.7531147+3.5
 Parameter: YMAX <- "17.2531147"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "73.7462884"
Evaluating: 73.7462884+3.5
 Parameter: ZMAX <- "77.2462884"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.8658997"
Evaluating: -2.8658997-3.5
 Parameter: XMIN <- "-6.3658997"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.7531147"
Evaluating: 13.7531147-3.5
 Parameter: YMIN <- "10.2531147"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "73.7462884"
Evaluating: 73.7462884-3.5
 Parameter: ZMIN <- "70.2462884"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.6341003"
 Parameter: XMIN -> "-6.3658997"
 Parameter: YMAX -> "17.2531147"
 Parameter: YMIN -> "10.2531147"
 Parameter: ZMAX -> "77.2462884"
 Parameter: ZMIN -> "70.2462884"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "13.7531147"
 Parameter: YPOS -> "13.7531147"
 Parameter: XPOS -> "-2.8658997"
 Parameter: XPOS -> "-2.8658997"
Evaluating: SQRT(13.7531147*13.7531147+-2.8658997*-2.8658997)
 Parameter: DIST <- "14.0485425"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "14.0485425" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "44"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "44" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "44" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "44"
 Parameter: NPOS -> "28"
Evaluating: 44-28
 Parameter: J <- "16"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.820447949"
Evaluating: (39-9.0)*(0.820447949-0.5)
 Parameter: XPOS <- "9.61343847"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.437806049"
Evaluating: (39-9.0)*(0.437806049-0.5)
 Parameter: YPOS <- "-1.86581853"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.234973858"
Evaluating: (237.395-9.0)*(0.234973858-0.5)
 Parameter: ZPOS <- "-60.5306457"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.61343847"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 9.61343847--19.5
 Parameter: XTRAN <- "29.1134385"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.86581853"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -1.86581853--19.5
 Parameter: YTRAN <- "17.6341815"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-60.5306457"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -60.5306457-118.6975
 Parameter: ZTRAN <- "-179.228146"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.1134385"
 Parameter: YTRAN -> "17.6341815"
 Parameter: ZTRAN -> "-179.228146"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    29.113439   17.634182 -179.228146
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.95723006"
Evaluating: 0.95723006*360.0
 Parameter: XPHI <- "344.602822"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.711881956"
Evaluating: 0.711881956*360.0
 Parameter: YPHI <- "256.277504"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.483057852"
Evaluating: 0.483057852*360.0
 Parameter: ZPHI <- "173.900827"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.61343847"
 Parameter: YPOS -> "-1.86581853"
 Parameter: ZPOS -> "-60.5306457"
 Parameter: XPHI -> "344.602822"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.964108   -0.265509
    0.000000    0.265509    0.964108

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   15.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.61343847"
 Parameter: YPOS -> "-1.86581853"
 Parameter: ZPOS -> "-60.5306457"
 Parameter: YPHI -> "256.277504"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.237220    0.000000    0.971456
    0.000000    1.000000    0.000000
   -0.971456    0.000000   -0.237220

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  103.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.61343847"
 Parameter: YPOS -> "-1.86581853"
 Parameter: ZPOS -> "-60.5306457"
 Parameter: ZPHI -> "173.900827"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.994339    0.106250    0.000000
   -0.106250   -0.994339    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  173.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.613439 XMAX =    9.613439 XAVE =    9.613439
    YMIN =   -1.865819 YMAX =   -1.865819 YAVE =   -1.865819
    ZMIN =  -60.530646 ZMAX =  -60.530646 ZAVE =  -60.530646
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.61343876"
Evaluating: 9.61343876+3.5
 Parameter: XMAX <- "13.1134388"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.86581861"
Evaluating: -1.86581861+3.5
 Parameter: YMAX <- "1.63418139"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-60.5306457"
Evaluating: -60.5306457+3.5
 Parameter: ZMAX <- "-57.0306457"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.61343876"
Evaluating: 9.61343876-3.5
 Parameter: XMIN <- "6.11343876"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.86581861"
Evaluating: -1.86581861-3.5
 Parameter: YMIN <- "-5.36581861"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-60.5306457"
Evaluating: -60.5306457-3.5
 Parameter: ZMIN <- "-64.0306457"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.1134388"
 Parameter: XMIN -> "6.11343876"
 Parameter: YMAX -> "1.63418139"
 Parameter: YMIN -> "-5.36581861"
 Parameter: ZMAX -> "-57.0306457"
 Parameter: ZMIN -> "-64.0306457"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-1.86581853"
 Parameter: YPOS -> "-1.86581853"
 Parameter: XPOS -> "9.61343847"
 Parameter: XPOS -> "9.61343847"
Evaluating: SQRT(-1.86581853*-1.86581853+9.61343847*9.61343847)
 Parameter: DIST <- "9.79282789"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "9.79282789" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "45"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "45" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "45" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "45"
 Parameter: NPOS -> "28"
Evaluating: 45-28
 Parameter: J <- "17"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.170692498"
Evaluating: (39-9.0)*(0.170692498-0.5)
 Parameter: XPOS <- "-9.87922506"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.994503438"
Evaluating: (39-9.0)*(0.994503438-0.5)
 Parameter: YPOS <- "14.8351031"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.129730548"
Evaluating: (237.395-9.0)*(0.129730548-0.5)
 Parameter: ZPOS <- "-84.5676915"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.87922506"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -9.87922506--19.5
 Parameter: XTRAN <- "9.62077494"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.8351031"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 14.8351031--19.5
 Parameter: YTRAN <- "34.3351031"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-84.5676915"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -84.5676915-118.6975
 Parameter: ZTRAN <- "-203.265192"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "9.62077494"
 Parameter: YTRAN -> "34.3351031"
 Parameter: ZTRAN -> "-203.265192"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR     9.620775   34.335103 -203.265192
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.781484146"
Evaluating: 0.781484146*360.0
 Parameter: XPHI <- "281.334293"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.73799482"
Evaluating: 0.73799482*360.0
 Parameter: YPHI <- "265.678135"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.547238285"
Evaluating: 0.547238285*360.0
 Parameter: ZPHI <- "197.005783"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.87922506"
 Parameter: YPOS -> "14.8351031"
 Parameter: ZPOS -> "-84.5676915"
 Parameter: XPHI -> "281.334293"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.196533   -0.980497
    0.000000    0.980497    0.196533

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   78.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.87922506"
 Parameter: YPOS -> "14.8351031"
 Parameter: ZPOS -> "-84.5676915"
 Parameter: YPHI -> "265.678135"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.075359    0.000000    0.997156
    0.000000    1.000000    0.000000
   -0.997156    0.000000   -0.075359

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   94.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.87922506"
 Parameter: YPOS -> "14.8351031"
 Parameter: ZPOS -> "-84.5676915"
 Parameter: ZPHI -> "197.005783"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.956275   -0.292468    0.000000
    0.292468   -0.956275    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  162.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.879225 XMAX =   -9.879225 XAVE =   -9.879225
    YMIN =   14.835103 YMAX =   14.835103 YAVE =   14.835103
    ZMIN =  -84.567691 ZMAX =  -84.567691 ZAVE =  -84.567691
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.87922511"
Evaluating: -9.87922511+3.5
 Parameter: XMAX <- "-6.37922511"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.8351026"
Evaluating: 14.8351026+3.5
 Parameter: YMAX <- "18.3351026"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-84.5676915"
Evaluating: -84.5676915+3.5
 Parameter: ZMAX <- "-81.0676915"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.87922511"
Evaluating: -9.87922511-3.5
 Parameter: XMIN <- "-13.3792251"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.8351026"
Evaluating: 14.8351026-3.5
 Parameter: YMIN <- "11.3351026"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-84.5676915"
Evaluating: -84.5676915-3.5
 Parameter: ZMIN <- "-88.0676915"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.37922511"
 Parameter: XMIN -> "-13.3792251"
 Parameter: YMAX -> "18.3351026"
 Parameter: YMIN -> "11.3351026"
 Parameter: ZMAX -> "-81.0676915"
 Parameter: ZMIN -> "-88.0676915"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "14.8351031"
 Parameter: YPOS -> "14.8351031"
 Parameter: XPOS -> "-9.87922506"
 Parameter: XPOS -> "-9.87922506"
Evaluating: SQRT(14.8351031*14.8351031+-9.87922506*-9.87922506)
 Parameter: DIST <- "17.8235623"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "17.8235623" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "46"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "46" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "46" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "46"
 Parameter: NPOS -> "28"
Evaluating: 46-28
 Parameter: J <- "18"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.760010388"
Evaluating: (39-9.0)*(0.760010388-0.5)
 Parameter: XPOS <- "7.80031164"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.927267661"
Evaluating: (39-9.0)*(0.927267661-0.5)
 Parameter: YPOS <- "12.8180298"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.914444073"
Evaluating: (237.395-9.0)*(0.914444073-0.5)
 Parameter: ZPOS <- "94.6569541"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.80031164"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 7.80031164--19.5
 Parameter: XTRAN <- "27.3003116"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.8180298"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: 12.8180298--19.5
 Parameter: YTRAN <- "32.3180298"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "94.6569541"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 94.6569541-118.6975
 Parameter: ZTRAN <- "-24.0405459"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "27.3003116"
 Parameter: YTRAN -> "32.3180298"
 Parameter: ZTRAN -> "-24.0405459"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    27.300312   32.318030  -24.040546
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.406030406"
Evaluating: 0.406030406*360.0
 Parameter: XPHI <- "146.170946"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.767250877"
Evaluating: 0.767250877*360.0
 Parameter: YPHI <- "276.210316"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.273049571"
Evaluating: 0.273049571*360.0
 Parameter: ZPHI <- "98.2978456"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.80031164"
 Parameter: YPOS -> "12.8180298"
 Parameter: ZPOS -> "94.6569541"
 Parameter: XPHI -> "146.170946"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.830702    0.556717
    0.000000   -0.556717   -0.830702

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  146.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.80031164"
 Parameter: YPOS -> "12.8180298"
 Parameter: ZPOS -> "94.6569541"
 Parameter: YPHI -> "276.210316"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.108178    0.000000    0.994132
    0.000000    1.000000    0.000000
   -0.994132    0.000000    0.108178

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   83.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.80031164"
 Parameter: YPOS -> "12.8180298"
 Parameter: ZPOS -> "94.6569541"
 Parameter: ZPHI -> "98.2978456"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.144319    0.989531    0.000000
   -0.989531   -0.144319    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   98.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.800312 XMAX =    7.800312 XAVE =    7.800312
    YMIN =   12.818030 YMAX =   12.818030 YAVE =   12.818030
    ZMIN =   94.656954 ZMAX =   94.656954 ZAVE =   94.656954
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.80031164"
Evaluating: 7.80031164+3.5
 Parameter: XMAX <- "11.3003116"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.8180298"
Evaluating: 12.8180298+3.5
 Parameter: YMAX <- "16.3180298"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "94.6569541"
Evaluating: 94.6569541+3.5
 Parameter: ZMAX <- "98.1569541"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.80031164"
Evaluating: 7.80031164-3.5
 Parameter: XMIN <- "4.30031164"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.8180298"
Evaluating: 12.8180298-3.5
 Parameter: YMIN <- "9.3180298"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "94.6569541"
Evaluating: 94.6569541-3.5
 Parameter: ZMIN <- "91.1569541"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.3003116"
 Parameter: XMIN -> "4.30031164"
 Parameter: YMAX -> "16.3180298"
 Parameter: YMIN -> "9.3180298"
 Parameter: ZMAX -> "98.1569541"
 Parameter: ZMIN -> "91.1569541"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "12.8180298"
 Parameter: YPOS -> "12.8180298"
 Parameter: XPOS -> "7.80031164"
 Parameter: XPOS -> "7.80031164"
Evaluating: SQRT(12.8180298*12.8180298+7.80031164*7.80031164)
 Parameter: DIST <- "15.0048909"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "15.0048909" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "47"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "47" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "47" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "47"
 Parameter: NPOS -> "28"
Evaluating: 47-28
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.674072998"
Evaluating: (39-9.0)*(0.674072998-0.5)
 Parameter: XPOS <- "5.22218994"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.16687997"
Evaluating: (39-9.0)*(0.16687997-0.5)
 Parameter: YPOS <- "-9.9936009"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.842081437"
Evaluating: (237.395-9.0)*(0.842081437-0.5)
 Parameter: ZPOS <- "78.1296898"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.22218994"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 5.22218994--19.5
 Parameter: XTRAN <- "24.7221899"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.9936009"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -9.9936009--19.5
 Parameter: YTRAN <- "9.5063991"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "78.1296898"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 78.1296898-118.6975
 Parameter: ZTRAN <- "-40.5678102"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.7221899"
 Parameter: YTRAN -> "9.5063991"
 Parameter: ZTRAN -> "-40.5678102"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    24.722190    9.506399  -40.567810
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.242620086"
Evaluating: 0.242620086*360.0
 Parameter: XPHI <- "87.343231"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.222572627"
Evaluating: 0.222572627*360.0
 Parameter: YPHI <- "80.1261457"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.640320096"
Evaluating: 0.640320096*360.0
 Parameter: ZPHI <- "230.515235"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.22218994"
 Parameter: YPOS -> "-9.9936009"
 Parameter: ZPOS -> "78.1296898"
 Parameter: XPHI -> "87.343231"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.046353    0.998925
    0.000000   -0.998925    0.046353

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   87.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.22218994"
 Parameter: YPOS -> "-9.9936009"
 Parameter: ZPOS -> "78.1296898"
 Parameter: YPHI -> "80.1261457"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.171480    0.000000   -0.985188
    0.000000    1.000000    0.000000
    0.985188    0.000000    0.171480

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   80.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.22218994"
 Parameter: YPOS -> "-9.9936009"
 Parameter: ZPOS -> "78.1296898"
 Parameter: ZPHI -> "230.515235"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.635873   -0.771794    0.000000
    0.771794   -0.635873    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  129.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.222190 XMAX =    5.222190 XAVE =    5.222190
    YMIN =   -9.993601 YMAX =   -9.993601 YAVE =   -9.993601
    ZMIN =   78.129690 ZMAX =   78.129690 ZAVE =   78.129690
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.22218994"
Evaluating: 5.22218994+3.5
 Parameter: XMAX <- "8.72218994"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.99360091"
Evaluating: -9.99360091+3.5
 Parameter: YMAX <- "-6.49360091"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "78.1296898"
Evaluating: 78.1296898+3.5
 Parameter: ZMAX <- "81.6296898"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.22218994"
Evaluating: 5.22218994-3.5
 Parameter: XMIN <- "1.72218994"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.99360091"
Evaluating: -9.99360091-3.5
 Parameter: YMIN <- "-13.4936009"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "78.1296898"
Evaluating: 78.1296898-3.5
 Parameter: ZMIN <- "74.6296898"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.72218994"
 Parameter: XMIN -> "1.72218994"
 Parameter: YMAX -> "-6.49360091"
 Parameter: YMIN -> "-13.4936009"
 Parameter: ZMAX -> "81.6296898"
 Parameter: ZMIN -> "74.6296898"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-9.9936009"
 Parameter: YPOS -> "-9.9936009"
 Parameter: XPOS -> "5.22218994"
 Parameter: XPOS -> "5.22218994"
Evaluating: SQRT(-9.9936009*-9.9936009+5.22218994*5.22218994)
 Parameter: DIST <- "11.275785"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "11.275785" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "48"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "48" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "48" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "48"
 Parameter: NPOS -> "28"
Evaluating: 48-28
 Parameter: J <- "20"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.675125732"
Evaluating: (39-9.0)*(0.675125732-0.5)
 Parameter: XPOS <- "5.25377196"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "4.631955758E-03"
Evaluating: (39-9.0)*(4.631955758E-03-0.5)
 Parameter: YPOS <- "-14.8610413"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.673834801"
Evaluating: (237.395-9.0)*(0.673834801-0.5)
 Parameter: ZPOS <- "39.7029994"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.25377196"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 5.25377196--19.5
 Parameter: XTRAN <- "24.753772"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.8610413"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -14.8610413--19.5
 Parameter: YTRAN <- "4.6389587"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.7029994"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 39.7029994-118.6975
 Parameter: ZTRAN <- "-78.9945006"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.753772"
 Parameter: YTRAN -> "4.6389587"
 Parameter: ZTRAN -> "-78.9945006"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    24.753772    4.638959  -78.994501
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.596727736"
Evaluating: 0.596727736*360.0
 Parameter: XPHI <- "214.821985"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.841302769"
Evaluating: 0.841302769*360.0
 Parameter: YPHI <- "302.868997"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.467074773"
Evaluating: 0.467074773*360.0
 Parameter: ZPHI <- "168.146918"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.25377196"
 Parameter: YPOS -> "-14.8610413"
 Parameter: ZPOS -> "39.7029994"
 Parameter: XPHI -> "214.821985"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.820930   -0.571029
    0.000000    0.571029   -0.820930

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  145.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.25377196"
 Parameter: YPOS -> "-14.8610413"
 Parameter: ZPOS -> "39.7029994"
 Parameter: YPHI -> "302.868997"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.542720    0.000000    0.839914
    0.000000    1.000000    0.000000
   -0.839914    0.000000    0.542720

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   57.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.25377196"
 Parameter: YPOS -> "-14.8610413"
 Parameter: ZPOS -> "39.7029994"
 Parameter: ZPHI -> "168.146918"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.978678    0.205403    0.000000
   -0.205403   -0.978678    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  168.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.253772 XMAX =    5.253772 XAVE =    5.253772
    YMIN =  -14.861041 YMAX =  -14.861041 YAVE =  -14.861041
    ZMIN =   39.702999 ZMAX =   39.702999 ZAVE =   39.702999
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.25377194"
Evaluating: 5.25377194+3.5
 Parameter: XMAX <- "8.75377194"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.8610413"
Evaluating: -14.8610413+3.5
 Parameter: YMAX <- "-11.3610413"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.7029994"
Evaluating: 39.7029994+3.5
 Parameter: ZMAX <- "43.2029994"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.25377194"
Evaluating: 5.25377194-3.5
 Parameter: XMIN <- "1.75377194"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.8610413"
Evaluating: -14.8610413-3.5
 Parameter: YMIN <- "-18.3610413"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.7029994"
Evaluating: 39.7029994-3.5
 Parameter: ZMIN <- "36.2029994"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.75377194"
 Parameter: XMIN -> "1.75377194"
 Parameter: YMAX -> "-11.3610413"
 Parameter: YMIN -> "-18.3610413"
 Parameter: ZMAX -> "43.2029994"
 Parameter: ZMIN -> "36.2029994"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-14.8610413"
 Parameter: YPOS -> "-14.8610413"
 Parameter: XPOS -> "5.25377196"
 Parameter: XPOS -> "5.25377196"
Evaluating: SQRT(-14.8610413*-14.8610413+5.25377196*5.25377196)
 Parameter: DIST <- "15.7623814"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "15.7623814" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "49"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "49" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "49"
Evaluating: 49
 Parameter: J <- "49"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "49" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "49"
 Parameter: NPOS -> "28"
Evaluating: 49-28
 Parameter: J <- "21"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "3.205727719E-02"
Evaluating: (39-9.0)*(3.205727719E-02-0.5)
 Parameter: XPOS <- "-14.0382817"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.103734609"
Evaluating: (39-9.0)*(0.103734609-0.5)
 Parameter: YPOS <- "-11.8879617"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.959298945"
Evaluating: (237.395-9.0)*(0.959298945-0.5)
 Parameter: ZPOS <- "104.901583"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.0382817"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -14.0382817--19.5
 Parameter: XTRAN <- "5.4617183"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.8879617"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -11.8879617--19.5
 Parameter: YTRAN <- "7.6120383"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "104.901583"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 104.901583-118.6975
 Parameter: ZTRAN <- "-13.795917"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.4617183"
 Parameter: YTRAN -> "7.6120383"
 Parameter: ZTRAN -> "-13.795917"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR     5.461718    7.612038  -13.795917
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.065397782E-03"
Evaluating: 7.065397782E-03*360.0
 Parameter: XPHI <- "2.5435432"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.494896811"
Evaluating: 0.494896811*360.0
 Parameter: YPHI <- "178.162852"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.325325003"
Evaluating: 0.325325003*360.0
 Parameter: ZPHI <- "117.117001"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.0382817"
 Parameter: YPOS -> "-11.8879617"
 Parameter: ZPOS -> "104.901583"
 Parameter: XPHI -> "2.5435432"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999015    0.044379
    0.000000   -0.044379    0.999015

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    2.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.0382817"
 Parameter: YPOS -> "-11.8879617"
 Parameter: ZPOS -> "104.901583"
 Parameter: YPHI -> "178.162852"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.999486    0.000000   -0.032059
    0.000000    1.000000    0.000000
    0.032059    0.000000   -0.999486

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  178.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.0382817"
 Parameter: YPOS -> "-11.8879617"
 Parameter: ZPOS -> "104.901583"
 Parameter: ZPHI -> "117.117001"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.455809    0.890078    0.000000
   -0.890078   -0.455809    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  117.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.038282 XMAX =  -14.038282 XAVE =  -14.038282
    YMIN =  -11.887962 YMAX =  -11.887962 YAVE =  -11.887962
    ZMIN =  104.901583 ZMAX =  104.901583 ZAVE =  104.901583
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.0382817"
Evaluating: -14.0382817+3.5
 Parameter: XMAX <- "-10.5382817"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.8879617"
Evaluating: -11.8879617+3.5
 Parameter: YMAX <- "-8.3879617"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "104.901583"
Evaluating: 104.901583+3.5
 Parameter: ZMAX <- "108.401583"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.0382817"
Evaluating: -14.0382817-3.5
 Parameter: XMIN <- "-17.5382817"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.8879617"
Evaluating: -11.8879617-3.5
 Parameter: YMIN <- "-15.3879617"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "104.901583"
Evaluating: 104.901583-3.5
 Parameter: ZMIN <- "101.401583"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.5382817"
 Parameter: XMIN -> "-17.5382817"
 Parameter: YMAX -> "-8.3879617"
 Parameter: YMIN -> "-15.3879617"
 Parameter: ZMAX -> "108.401583"
 Parameter: ZMIN -> "101.401583"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-11.8879617"
 Parameter: YPOS -> "-11.8879617"
 Parameter: XPOS -> "-14.0382817"
 Parameter: XPOS -> "-14.0382817"
Evaluating: SQRT(-11.8879617*-11.8879617+-14.0382817*-14.0382817)
 Parameter: DIST <- "18.3955698"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "18.3955698" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "50"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "50" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "50" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "50"
 Parameter: NPOS -> "28"
Evaluating: 50-28
 Parameter: J <- "22"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.911308708"
Evaluating: (39-9.0)*(0.911308708-0.5)
 Parameter: XPOS <- "12.3392612"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.112484211"
Evaluating: (39-9.0)*(0.112484211-0.5)
 Parameter: YPOS <- "-11.6254737"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.745672325"
Evaluating: (237.395-9.0)*(0.745672325-0.5)
 Parameter: ZPOS <- "56.1103307"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.3392612"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 12.3392612--19.5
 Parameter: XTRAN <- "31.8392612"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-11.6254737"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -11.6254737--19.5
 Parameter: YTRAN <- "7.8745263"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "56.1103307"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 56.1103307-118.6975
 Parameter: ZTRAN <- "-62.5871693"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.8392612"
 Parameter: YTRAN -> "7.8745263"
 Parameter: ZTRAN -> "-62.5871693"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    31.839261    7.874526  -62.587169
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.992727528"
Evaluating: 0.992727528*360.0
 Parameter: XPHI <- "357.38191"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.650689371"
Evaluating: 0.650689371*360.0
 Parameter: YPHI <- "234.248174"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.950367071"
Evaluating: 0.950367071*360.0
 Parameter: ZPHI <- "342.132146"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.3392612"
 Parameter: YPOS -> "-11.6254737"
 Parameter: ZPOS -> "56.1103307"
 Parameter: XPHI -> "357.38191"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.998956   -0.045678
    0.000000    0.045678    0.998956

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    2.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.3392612"
 Parameter: YPOS -> "-11.6254737"
 Parameter: ZPOS -> "56.1103307"
 Parameter: YPHI -> "234.248174"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.584276    0.000000    0.811555
    0.000000    1.000000    0.000000
   -0.811555    0.000000   -0.584276

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  125.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.3392612"
 Parameter: YPOS -> "-11.6254737"
 Parameter: ZPOS -> "56.1103307"
 Parameter: ZPHI -> "342.132146"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.951767   -0.306823    0.000000
    0.306823    0.951767    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   17.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.339261 XMAX =   12.339261 XAVE =   12.339261
    YMIN =  -11.625474 YMAX =  -11.625474 YAVE =  -11.625474
    ZMIN =   56.110331 ZMAX =   56.110331 ZAVE =   56.110331
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.3392612"
Evaluating: 12.3392612+3.5
 Parameter: XMAX <- "15.8392612"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-11.6254737"
Evaluating: -11.6254737+3.5
 Parameter: YMAX <- "-8.1254737"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "56.1103307"
Evaluating: 56.1103307+3.5
 Parameter: ZMAX <- "59.6103307"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.3392612"
Evaluating: 12.3392612-3.5
 Parameter: XMIN <- "8.8392612"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-11.6254737"
Evaluating: -11.6254737-3.5
 Parameter: YMIN <- "-15.1254737"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "56.1103307"
Evaluating: 56.1103307-3.5
 Parameter: ZMIN <- "52.6103307"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.8392612"
 Parameter: XMIN -> "8.8392612"
 Parameter: YMAX -> "-8.1254737"
 Parameter: YMIN -> "-15.1254737"
 Parameter: ZMAX -> "59.6103307"
 Parameter: ZMIN -> "52.6103307"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-11.6254737"
 Parameter: YPOS -> "-11.6254737"
 Parameter: XPOS -> "12.3392612"
 Parameter: XPOS -> "12.3392612"
Evaluating: SQRT(-11.6254737*-11.6254737+12.3392612*12.3392612)
 Parameter: DIST <- "16.9531415"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "16.9531415" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "51"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "51" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "51"
Evaluating: 51
 Parameter: J <- "51"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "51" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "51"
 Parameter: NPOS -> "28"
Evaluating: 51-28
 Parameter: J <- "23"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.49157601"
Evaluating: (39-9.0)*(0.49157601-0.5)
 Parameter: XPOS <- "-0.2527197"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "8.377381316E-02"
Evaluating: (39-9.0)*(8.377381316E-02-0.5)
 Parameter: YPOS <- "-12.4867856"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.907950666"
Evaluating: (237.395-9.0)*(0.907950666-0.5)
 Parameter: ZPOS <- "93.1738924"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.2527197"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -0.2527197--19.5
 Parameter: XTRAN <- "19.2472803"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.4867856"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -12.4867856--19.5
 Parameter: YTRAN <- "7.0132144"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "93.1738924"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 93.1738924-118.6975
 Parameter: ZTRAN <- "-25.5236076"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "19.2472803"
 Parameter: YTRAN -> "7.0132144"
 Parameter: ZTRAN -> "-25.5236076"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    19.247280    7.013214  -25.523608
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.336383442"
Evaluating: 0.336383442*360.0
 Parameter: XPHI <- "121.098039"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.416249952"
Evaluating: 0.416249952*360.0
 Parameter: YPHI <- "149.849983"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.583807864"
Evaluating: 0.583807864*360.0
 Parameter: ZPHI <- "210.170831"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.2527197"
 Parameter: YPOS -> "-12.4867856"
 Parameter: ZPOS -> "93.1738924"
 Parameter: XPHI -> "121.098039"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.516504    0.856285
    0.000000   -0.856285   -0.516504

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  121.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.2527197"
 Parameter: YPOS -> "-12.4867856"
 Parameter: ZPOS -> "93.1738924"
 Parameter: YPHI -> "149.849983"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.864713    0.000000   -0.502266
    0.000000    1.000000    0.000000
    0.502266    0.000000   -0.864713

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  149.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.2527197"
 Parameter: YPOS -> "-12.4867856"
 Parameter: ZPOS -> "93.1738924"
 Parameter: ZPHI -> "210.170831"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.864531   -0.502580    0.000000
    0.502580   -0.864531    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  149.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.252720 XMAX =   -0.252720 XAVE =   -0.252720
    YMIN =  -12.486786 YMAX =  -12.486786 YAVE =  -12.486786
    ZMIN =   93.173892 ZMAX =   93.173892 ZAVE =   93.173892
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.2527197"
Evaluating: -0.2527197+3.5
 Parameter: XMAX <- "3.2472803"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.4867856"
Evaluating: -12.4867856+3.5
 Parameter: YMAX <- "-8.9867856"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "93.1738924"
Evaluating: 93.1738924+3.5
 Parameter: ZMAX <- "96.6738924"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.2527197"
Evaluating: -0.2527197-3.5
 Parameter: XMIN <- "-3.7527197"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.4867856"
Evaluating: -12.4867856-3.5
 Parameter: YMIN <- "-15.9867856"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "93.1738924"
Evaluating: 93.1738924-3.5
 Parameter: ZMIN <- "89.6738924"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.2472803"
 Parameter: XMIN -> "-3.7527197"
 Parameter: YMAX -> "-8.9867856"
 Parameter: YMIN -> "-15.9867856"
 Parameter: ZMAX -> "96.6738924"
 Parameter: ZMIN -> "89.6738924"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-12.4867856"
 Parameter: YPOS -> "-12.4867856"
 Parameter: XPOS -> "-0.2527197"
 Parameter: XPOS -> "-0.2527197"
Evaluating: SQRT(-12.4867856*-12.4867856+-0.2527197*-0.2527197)
 Parameter: DIST <- "12.4893427"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "12.4893427" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "52"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "52" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "52" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "52"
 Parameter: NPOS -> "28"
Evaluating: 52-28
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.338307309"
Evaluating: (39-9.0)*(0.338307309-0.5)
 Parameter: XPOS <- "-4.85078073"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "5.697288608E-02"
Evaluating: (39-9.0)*(5.697288608E-02-0.5)
 Parameter: YPOS <- "-13.2908134"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.620876227"
Evaluating: (237.395-9.0)*(0.620876227-0.5)
 Parameter: ZPOS <- "27.6075259"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.85078073"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -4.85078073--19.5
 Parameter: XTRAN <- "14.6492193"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.2908134"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -13.2908134--19.5
 Parameter: YTRAN <- "6.2091866"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.6075259"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 27.6075259-118.6975
 Parameter: ZTRAN <- "-91.0899741"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.6492193"
 Parameter: YTRAN -> "6.2091866"
 Parameter: ZTRAN -> "-91.0899741"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    14.649219    6.209187  -91.089974
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.471387543E-02"
Evaluating: 6.471387543E-02*360.0
 Parameter: XPHI <- "23.2969952"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.498863159"
Evaluating: 0.498863159*360.0
 Parameter: YPHI <- "179.590737"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.324107333E-03"
Evaluating: 4.324107333E-03*360.0
 Parameter: ZPHI <- "1.55667864"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.85078073"
 Parameter: YPOS -> "-13.2908134"
 Parameter: ZPOS -> "27.6075259"
 Parameter: XPHI -> "23.2969952"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.918467    0.395497
    0.000000   -0.395497    0.918467

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   23.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.85078073"
 Parameter: YPOS -> "-13.2908134"
 Parameter: ZPOS -> "27.6075259"
 Parameter: YPHI -> "179.590737"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.999974    0.000000   -0.007143
    0.000000    1.000000    0.000000
    0.007143    0.000000   -0.999974

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  179.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.85078073"
 Parameter: YPOS -> "-13.2908134"
 Parameter: ZPOS -> "27.6075259"
 Parameter: ZPHI -> "1.55667864"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.999631    0.027166    0.000000
   -0.027166    0.999631    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    1.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.850781 XMAX =   -4.850781 XAVE =   -4.850781
    YMIN =  -13.290813 YMAX =  -13.290813 YAVE =  -13.290813
    ZMIN =   27.607526 ZMAX =   27.607526 ZAVE =   27.607526
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.85078076"
Evaluating: -4.85078076+3.5
 Parameter: XMAX <- "-1.35078076"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.2908134"
Evaluating: -13.2908134+3.5
 Parameter: YMAX <- "-9.7908134"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.6075259"
Evaluating: 27.6075259+3.5
 Parameter: ZMAX <- "31.1075259"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.85078076"
Evaluating: -4.85078076-3.5
 Parameter: XMIN <- "-8.35078076"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.2908134"
Evaluating: -13.2908134-3.5
 Parameter: YMIN <- "-16.7908134"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.6075259"
Evaluating: 27.6075259-3.5
 Parameter: ZMIN <- "24.1075259"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.35078076"
 Parameter: XMIN -> "-8.35078076"
 Parameter: YMAX -> "-9.7908134"
 Parameter: YMIN -> "-16.7908134"
 Parameter: ZMAX -> "31.1075259"
 Parameter: ZMIN -> "24.1075259"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-13.2908134"
 Parameter: YPOS -> "-13.2908134"
 Parameter: XPOS -> "-4.85078073"
 Parameter: XPOS -> "-4.85078073"
Evaluating: SQRT(-13.2908134*-13.2908134+-4.85078073*-4.85078073)
 Parameter: DIST <- "14.1483495"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "14.1483495" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "53"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "53" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "53" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "53"
 Parameter: NPOS -> "28"
Evaluating: 53-28
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.428813109"
Evaluating: (39-9.0)*(0.428813109-0.5)
 Parameter: XPOS <- "-2.13560673"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.347861456"
Evaluating: (39-9.0)*(0.347861456-0.5)
 Parameter: YPOS <- "-4.56415632"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.363784221"
Evaluating: (237.395-9.0)*(0.363784221-0.5)
 Parameter: ZPOS <- "-31.1110028"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.13560673"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -2.13560673--19.5
 Parameter: XTRAN <- "17.3643933"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.56415632"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -4.56415632--19.5
 Parameter: YTRAN <- "14.9358437"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.1110028"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -31.1110028-118.6975
 Parameter: ZTRAN <- "-149.808503"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.3643933"
 Parameter: YTRAN -> "14.9358437"
 Parameter: ZTRAN -> "-149.808503"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    17.364393   14.935844 -149.808503
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.273400826"
Evaluating: 0.273400826*360.0
 Parameter: XPHI <- "98.4242974"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.717436164"
Evaluating: 0.717436164*360.0
 Parameter: YPHI <- "258.277019"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.376475365"
Evaluating: 0.376475365*360.0
 Parameter: ZPHI <- "135.531131"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.13560673"
 Parameter: YPOS -> "-4.56415632"
 Parameter: ZPOS -> "-31.1110028"
 Parameter: XPHI -> "98.4242974"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.146503    0.989210
    0.000000   -0.989210   -0.146503

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   98.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.13560673"
 Parameter: YPOS -> "-4.56415632"
 Parameter: ZPOS -> "-31.1110028"
 Parameter: YPHI -> "258.277019"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.203180    0.000000    0.979141
    0.000000    1.000000    0.000000
   -0.979141    0.000000   -0.203180

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  101.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.13560673"
 Parameter: YPOS -> "-4.56415632"
 Parameter: ZPOS -> "-31.1110028"
 Parameter: ZPHI -> "135.531131"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.713631    0.700522    0.000000
   -0.700522   -0.713631    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  135.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.135607 XMAX =   -2.135607 XAVE =   -2.135607
    YMIN =   -4.564156 YMAX =   -4.564156 YAVE =   -4.564156
    ZMIN =  -31.111003 ZMAX =  -31.111003 ZAVE =  -31.111003
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.13560687"
Evaluating: -2.13560687+3.5
 Parameter: XMAX <- "1.36439313"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.56415618"
Evaluating: -4.56415618+3.5
 Parameter: YMAX <- "-1.06415618"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.1110028"
Evaluating: -31.1110028+3.5
 Parameter: ZMAX <- "-27.6110028"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.13560687"
Evaluating: -2.13560687-3.5
 Parameter: XMIN <- "-5.63560687"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.56415618"
Evaluating: -4.56415618-3.5
 Parameter: YMIN <- "-8.06415618"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.1110028"
Evaluating: -31.1110028-3.5
 Parameter: ZMIN <- "-34.6110028"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.36439313"
 Parameter: XMIN -> "-5.63560687"
 Parameter: YMAX -> "-1.06415618"
 Parameter: YMIN -> "-8.06415618"
 Parameter: ZMAX -> "-27.6110028"
 Parameter: ZMIN -> "-34.6110028"
 SELRPN>     20 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "20"
 Comparing "20" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   2680
 SELRPN>     20 atoms have been selected out of   2680

            DISTANCES FOR SELECTED ATOMS
 2533 NEG      CLA      25       CLA     -  81 NM       TUBE     1        C29           4.1824
 2533 NEG      CLA      25       CLA     -  84 NM       TUBE     1        C2C           3.2458
 2533 NEG      CLA      25       CLA     -  96 NM       TUBE     1        C2O           2.6512
 2533 NEG      CLA      25       CLA     - 142 NM       TUBE     1        C3Y           1.5055
 2533 NEG      CLA      25       CLA     - 143 NM       TUBE     1        C3Z           2.9007
 2533 NEG      CLA      25       CLA     - 145 NM       TUBE     1        C41           3.7119
 2533 NEG      CLA      25       CLA     - 530 NM       TUBE     1        CEQ           1.8294
 2533 NEG      CLA      25       CLA     - 541 NM       TUBE     1        CF1           1.5706
 2533 NEG      CLA      25       CLA     - 560 NM       TUBE     1        CFK           1.3225
 2533 NEG      CLA      25       CLA     - 582 NM       TUBE     1        CG6           4.0692
 2533 NEG      CLA      25       CLA     - 594 NM       TUBE     1        CGI           3.6030
 2533 NEG      CLA      25       CLA     - 822 NM       TUBE     1        CMU           3.2027
 2533 NEG      CLA      25       CLA     - 838 NM       TUBE     1        CNA           1.8341
 2533 NEG      CLA      25       CLA     - 854 NM       TUBE     1        CNQ           1.7304
 2533 NEG      CLA      25       CLA     -1797 NM       TUBE     1        C1DX          4.0787
 2533 NEG      CLA      25       CLA     -1802 NM       TUBE     1        C1E2          3.9756
 2533 NEG      CLA      25       CLA     -1803 NM       TUBE     1        C1E3          2.9517
 2533 NEG      CLA      25       CLA     -1806 NM       TUBE     1        C1E6          3.7242
 2533 NEG      CLA      25       CLA     -1812 NM       TUBE     1        C1EC          3.5878
 2533 NEG      CLA      25       CLA     -2313 NM       TUBE     1        C1S9          3.1298
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        20
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "20"
 Comparing "20" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "53" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "53"
 Parameter: NPOS -> "28"
Evaluating: 53-28
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.464193848"
Evaluating: (39-9.0)*(0.464193848-0.5)
 Parameter: XPOS <- "-1.07418456"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.871871807"
Evaluating: (39-9.0)*(0.871871807-0.5)
 Parameter: YPOS <- "11.1561542"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.115568719"
Evaluating: (237.395-9.0)*(0.115568719-0.5)
 Parameter: ZPOS <- "-87.8021824"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.135607 XMAX =   -2.135607 XAVE =   -2.135607
    YMIN =   -4.564156 YMAX =   -4.564156 YAVE =   -4.564156
    ZMIN =  -31.111003 ZMAX =  -31.111003 ZAVE =  -31.111003
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.07418456"
 RDCMND substituted energy or value "?XAVE" to "-2.13560687"
Evaluating: -1.07418456--2.13560687
 Parameter: XTRAN <- "1.06142231"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.1561542"
 RDCMND substituted energy or value "?YAVE" to "-4.56415618"
Evaluating: 11.1561542--4.56415618
 Parameter: YTRAN <- "15.7203104"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-87.8021824"
 RDCMND substituted energy or value "?ZAVE" to "-31.1110028"
Evaluating: -87.8021824--31.1110028
 Parameter: ZTRAN <- "-56.6911796"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.06142231"
 Parameter: YTRAN -> "15.7203104"
 Parameter: ZTRAN -> "-56.6911796"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR     1.061422   15.720310  -56.691180
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.101749755"
Evaluating: 0.101749755*360.0
 Parameter: XPHI <- "36.6299118"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.260753214E-02"
Evaluating: 8.260753214E-02*360.0
 Parameter: YPHI <- "29.7387116"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.489343418"
Evaluating: 0.489343418*360.0
 Parameter: ZPHI <- "176.16363"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.07418456"
 Parameter: YPOS -> "11.1561542"
 Parameter: ZPOS -> "-87.8021824"
 Parameter: XPHI -> "36.6299118"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.802506    0.596644
    0.000000   -0.596644    0.802506

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   36.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.07418456"
 Parameter: YPOS -> "11.1561542"
 Parameter: ZPOS -> "-87.8021824"
 Parameter: YPHI -> "29.7387116"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.868297    0.000000   -0.496045
    0.000000    1.000000    0.000000
    0.496045    0.000000    0.868297

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   29.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.07418456"
 Parameter: YPOS -> "11.1561542"
 Parameter: ZPOS -> "-87.8021824"
 Parameter: ZPHI -> "176.16363"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.997759    0.066907    0.000000
   -0.066907   -0.997759    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  176.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.074185 XMAX =   -1.074185 XAVE =   -1.074185
    YMIN =   11.156154 YMAX =   11.156154 YAVE =   11.156154
    ZMIN =  -87.802182 ZMAX =  -87.802182 ZAVE =  -87.802182
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.07418458"
Evaluating: -1.07418458+3.5
 Parameter: XMAX <- "2.42581542"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.1561542"
Evaluating: 11.1561542+3.5
 Parameter: YMAX <- "14.6561542"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-87.8021824"
Evaluating: -87.8021824+3.5
 Parameter: ZMAX <- "-84.3021824"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.07418458"
Evaluating: -1.07418458-3.5
 Parameter: XMIN <- "-4.57418458"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.1561542"
Evaluating: 11.1561542-3.5
 Parameter: YMIN <- "7.6561542"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-87.8021824"
Evaluating: -87.8021824-3.5
 Parameter: ZMIN <- "-91.3021824"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.42581542"
 Parameter: XMIN -> "-4.57418458"
 Parameter: YMAX -> "14.6561542"
 Parameter: YMIN -> "7.6561542"
 Parameter: ZMAX -> "-84.3021824"
 Parameter: ZMIN -> "-91.3021824"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "11.1561542"
 Parameter: YPOS -> "11.1561542"
 Parameter: XPOS -> "-1.07418456"
 Parameter: XPOS -> "-1.07418456"
Evaluating: SQRT(11.1561542*11.1561542+-1.07418456*-1.07418456)
 Parameter: DIST <- "11.2077495"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "11.2077495" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "54"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "54" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "54"
Evaluating: 54
 Parameter: J <- "54"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "54" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "54"
 Parameter: NPOS -> "28"
Evaluating: 54-28
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.686241197"
Evaluating: (39-9.0)*(0.686241197-0.5)
 Parameter: XPOS <- "5.58723591"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "5.67491219E-02"
Evaluating: (39-9.0)*(5.67491219E-02-0.5)
 Parameter: YPOS <- "-13.2975263"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.853585728"
Evaluating: (237.395-9.0)*(0.853585728-0.5)
 Parameter: ZPOS <- "80.7572123"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.58723591"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: 5.58723591--19.5
 Parameter: XTRAN <- "25.0872359"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.2975263"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -13.2975263--19.5
 Parameter: YTRAN <- "6.2024737"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "80.7572123"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 80.7572123-118.6975
 Parameter: ZTRAN <- "-37.9402877"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.0872359"
 Parameter: YTRAN -> "6.2024737"
 Parameter: ZTRAN -> "-37.9402877"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    25.087236    6.202474  -37.940288
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.641006966"
Evaluating: 0.641006966*360.0
 Parameter: XPHI <- "230.762508"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.331401981"
Evaluating: 0.331401981*360.0
 Parameter: YPHI <- "119.304713"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.155877945"
Evaluating: 0.155877945*360.0
 Parameter: ZPHI <- "56.1160602"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.58723591"
 Parameter: YPOS -> "-13.2975263"
 Parameter: ZPOS -> "80.7572123"
 Parameter: XPHI -> "230.762508"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.632536   -0.774531
    0.000000    0.774531   -0.632536

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  129.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.58723591"
 Parameter: YPOS -> "-13.2975263"
 Parameter: ZPOS -> "80.7572123"
 Parameter: YPHI -> "119.304713"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.489454    0.000000   -0.872029
    0.000000    1.000000    0.000000
    0.872029    0.000000   -0.489454

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  119.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.58723591"
 Parameter: YPOS -> "-13.2975263"
 Parameter: ZPOS -> "80.7572123"
 Parameter: ZPHI -> "56.1160602"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.557512    0.830169    0.000000
   -0.830169    0.557512    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   56.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.587236 XMAX =    5.587236 XAVE =    5.587236
    YMIN =  -13.297526 YMAX =  -13.297526 YAVE =  -13.297526
    ZMIN =   80.757212 ZMAX =   80.757212 ZAVE =   80.757212
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.58723591"
Evaluating: 5.58723591+3.5
 Parameter: XMAX <- "9.08723591"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.2975263"
Evaluating: -13.2975263+3.5
 Parameter: YMAX <- "-9.7975263"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "80.7572123"
Evaluating: 80.7572123+3.5
 Parameter: ZMAX <- "84.2572123"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.58723591"
Evaluating: 5.58723591-3.5
 Parameter: XMIN <- "2.08723591"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.2975263"
Evaluating: -13.2975263-3.5
 Parameter: YMIN <- "-16.7975263"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "80.7572123"
Evaluating: 80.7572123-3.5
 Parameter: ZMIN <- "77.2572123"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.08723591"
 Parameter: XMIN -> "2.08723591"
 Parameter: YMAX -> "-9.7975263"
 Parameter: YMIN -> "-16.7975263"
 Parameter: ZMAX -> "84.2572123"
 Parameter: ZMIN -> "77.2572123"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of   2680
 SELRPN>      1 atoms have been selected out of   2680

            DISTANCES FOR SELECTED ATOMS
 2534 NEG      CLA      26       CLA     -2527 NEG      CLA      19       CLA           4.2371
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "54"
Evaluating: 54
 Parameter: J <- "54"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "54" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "54"
 Parameter: NPOS -> "28"
Evaluating: 54-28
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "2.445159091E-03"
Evaluating: (39-9.0)*(2.445159091E-03-0.5)
 Parameter: XPOS <- "-14.9266452"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.319735761"
Evaluating: (39-9.0)*(0.319735761-0.5)
 Parameter: YPOS <- "-5.40792717"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.393697696"
Evaluating: (237.395-9.0)*(0.393697696-0.5)
 Parameter: ZPOS <- "-24.2789147"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.587236 XMAX =    5.587236 XAVE =    5.587236
    YMIN =  -13.297526 YMAX =  -13.297526 YAVE =  -13.297526
    ZMIN =   80.757212 ZMAX =   80.757212 ZAVE =   80.757212
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.9266452"
 RDCMND substituted energy or value "?XAVE" to "5.58723591"
Evaluating: -14.9266452-5.58723591
 Parameter: XTRAN <- "-20.5138811"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.40792717"
 RDCMND substituted energy or value "?YAVE" to "-13.2975263"
Evaluating: -5.40792717--13.2975263
 Parameter: YTRAN <- "7.88959913"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.2789147"
 RDCMND substituted energy or value "?ZAVE" to "80.7572123"
Evaluating: -24.2789147-80.7572123
 Parameter: ZTRAN <- "-105.036127"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-20.5138811"
 Parameter: YTRAN -> "7.88959913"
 Parameter: ZTRAN -> "-105.036127"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR   -20.513881    7.889599 -105.036127
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.980750177"
Evaluating: 0.980750177*360.0
 Parameter: XPHI <- "353.070064"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.571186676"
Evaluating: 0.571186676*360.0
 Parameter: YPHI <- "205.627203"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.921972748"
Evaluating: 0.921972748*360.0
 Parameter: ZPHI <- "331.910189"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.9266452"
 Parameter: YPOS -> "-5.40792717"
 Parameter: ZPOS -> "-24.2789147"
 Parameter: XPHI -> "353.070064"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.992694   -0.120656
    0.000000    0.120656    0.992694

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    6.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.9266452"
 Parameter: YPOS -> "-5.40792717"
 Parameter: ZPOS -> "-24.2789147"
 Parameter: YPHI -> "205.627203"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.901627    0.000000    0.432514
    0.000000    1.000000    0.000000
   -0.432514    0.000000   -0.901627

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  154.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.9266452"
 Parameter: YPOS -> "-5.40792717"
 Parameter: ZPOS -> "-24.2789147"
 Parameter: ZPHI -> "331.910189"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.882211   -0.470855    0.000000
    0.470855    0.882211    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   28.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.926645 XMAX =  -14.926645 XAVE =  -14.926645
    YMIN =   -5.407927 YMAX =   -5.407927 YAVE =   -5.407927
    ZMIN =  -24.278915 ZMAX =  -24.278915 ZAVE =  -24.278915
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.9266452"
Evaluating: -14.9266452+3.5
 Parameter: XMAX <- "-11.4266452"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.40792718"
Evaluating: -5.40792718+3.5
 Parameter: YMAX <- "-1.90792718"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.2789147"
Evaluating: -24.2789147+3.5
 Parameter: ZMAX <- "-20.7789147"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.9266452"
Evaluating: -14.9266452-3.5
 Parameter: XMIN <- "-18.4266452"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.40792718"
Evaluating: -5.40792718-3.5
 Parameter: YMIN <- "-8.90792718"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.2789147"
Evaluating: -24.2789147-3.5
 Parameter: ZMIN <- "-27.7789147"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-11.4266452"
 Parameter: XMIN -> "-18.4266452"
 Parameter: YMAX -> "-1.90792718"
 Parameter: YMIN -> "-8.90792718"
 Parameter: ZMAX -> "-20.7789147"
 Parameter: ZMIN -> "-27.7789147"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-5.40792717"
 Parameter: YPOS -> "-5.40792717"
 Parameter: XPOS -> "-14.9266452"
 Parameter: XPOS -> "-14.9266452"
Evaluating: SQRT(-5.40792717*-5.40792717+-14.9266452*-14.9266452)
 Parameter: DIST <- "15.8760957"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "15.8760957" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "55"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "55" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "55" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "55"
 Parameter: NPOS -> "28"
Evaluating: 55-28
 Parameter: J <- "27"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.441613838"
Evaluating: (39-9.0)*(0.441613838-0.5)
 Parameter: XPOS <- "-1.75158486"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.220499387"
Evaluating: (39-9.0)*(0.220499387-0.5)
 Parameter: YPOS <- "-8.38501839"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.491504392"
Evaluating: (237.395-9.0)*(0.491504392-0.5)
 Parameter: ZPOS <- "-1.94035439"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.75158486"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -1.75158486--19.5
 Parameter: XTRAN <- "17.7484151"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.38501839"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -8.38501839--19.5
 Parameter: YTRAN <- "11.1149816"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-1.94035439"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: -1.94035439-118.6975
 Parameter: ZTRAN <- "-120.637854"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "17.7484151"
 Parameter: YTRAN -> "11.1149816"
 Parameter: ZTRAN -> "-120.637854"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    17.748415   11.114982 -120.637854
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.25947789"
Evaluating: 0.25947789*360.0
 Parameter: XPHI <- "93.4120404"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.564069184"
Evaluating: 0.564069184*360.0
 Parameter: YPHI <- "203.064906"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.317955813"
Evaluating: 0.317955813*360.0
 Parameter: ZPHI <- "114.464093"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.75158486"
 Parameter: YPOS -> "-8.38501839"
 Parameter: ZPOS -> "-1.94035439"
 Parameter: XPHI -> "93.4120404"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.059516    0.998227
    0.000000   -0.998227   -0.059516

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   93.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.75158486"
 Parameter: YPOS -> "-8.38501839"
 Parameter: ZPOS -> "-1.94035439"
 Parameter: YPHI -> "203.064906"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.920062    0.000000    0.391774
    0.000000    1.000000    0.000000
   -0.391774    0.000000   -0.920062

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  156.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.75158486"
 Parameter: YPOS -> "-8.38501839"
 Parameter: ZPOS -> "-1.94035439"
 Parameter: ZPHI -> "114.464093"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
   -0.414123    0.910221    0.000000
   -0.910221   -0.414123    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  114.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.751585 XMAX =   -1.751585 XAVE =   -1.751585
    YMIN =   -8.385019 YMAX =   -8.385019 YAVE =   -8.385019
    ZMIN =   -1.940354 ZMAX =   -1.940354 ZAVE =   -1.940354
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.75158452"
Evaluating: -1.75158452+3.5
 Parameter: XMAX <- "1.74841548"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.38501858"
Evaluating: -8.38501858+3.5
 Parameter: YMAX <- "-4.88501858"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-1.94035436"
Evaluating: -1.94035436+3.5
 Parameter: ZMAX <- "1.55964564"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.75158452"
Evaluating: -1.75158452-3.5
 Parameter: XMIN <- "-5.25158452"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.38501858"
Evaluating: -8.38501858-3.5
 Parameter: YMIN <- "-11.8850186"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-1.94035436"
Evaluating: -1.94035436-3.5
 Parameter: ZMIN <- "-5.44035436"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.74841548"
 Parameter: XMIN -> "-5.25158452"
 Parameter: YMAX -> "-4.88501858"
 Parameter: YMIN -> "-11.8850186"
 Parameter: ZMAX -> "1.55964564"
 Parameter: ZMIN -> "-5.44035436"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-8.38501839"
 Parameter: YPOS -> "-8.38501839"
 Parameter: XPOS -> "-1.75158486"
 Parameter: XPOS -> "-1.75158486"
Evaluating: SQRT(-8.38501839*-8.38501839+-1.75158486*-1.75158486)
 Parameter: DIST <- "8.56601325"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "8.56601325" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "56"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "56" and "56".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "28"
 Comparing "56" and "28".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "56"
 Parameter: NPOS -> "28"
Evaluating: 56-28
 Parameter: J <- "28"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.233047926"
Evaluating: (39-9.0)*(0.233047926-0.5)
 Parameter: XPOS <- "-8.00856222"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "39"
 RDCMND substituted energy or value "?RANDOM" to "0.478720246"
Evaluating: (39-9.0)*(0.478720246-0.5)
 Parameter: YPOS <- "-0.63839262"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "237.395"
 RDCMND substituted energy or value "?RANDOM" to "0.828415"
Evaluating: (237.395-9.0)*(0.828415-0.5)
 Parameter: ZPOS <- "75.0083439"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.500000 XMAX =  -19.500000 XAVE =  -19.500000
    YMIN =  -19.500000 YMAX =  -19.500000 YAVE =  -19.500000
    ZMIN =  118.697500 ZMAX =  118.697500 ZAVE =  118.697500
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.00856222"
 RDCMND substituted energy or value "?XAVE" to "-19.5"
Evaluating: -8.00856222--19.5
 Parameter: XTRAN <- "11.4914378"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.63839262"
 RDCMND substituted energy or value "?YAVE" to "-19.5"
Evaluating: -0.63839262--19.5
 Parameter: YTRAN <- "18.8616074"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "75.0083439"
 RDCMND substituted energy or value "?ZAVE" to "118.6975"
Evaluating: 75.0083439-118.6975
 Parameter: ZTRAN <- "-43.6891561"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.4914378"
 Parameter: YTRAN -> "18.8616074"
 Parameter: ZTRAN -> "-43.6891561"
 SELRPN>      1 atoms have been selected out of   2536
 TRANSLATION VECTOR    11.491438   18.861607  -43.689156
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.174576899"
Evaluating: 0.174576899*360.0
 Parameter: XPHI <- "62.8476836"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.183759263"
Evaluating: 0.183759263*360.0
 Parameter: YPHI <- "66.1533347"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.987459108"
Evaluating: 0.987459108*360.0
 Parameter: ZPHI <- "355.485279"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.00856222"
 Parameter: YPOS -> "-0.63839262"
 Parameter: ZPOS -> "75.0083439"
 Parameter: XPHI -> "62.8476836"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.456358    0.889796
    0.000000   -0.889796    0.456358

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   62.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.00856222"
 Parameter: YPOS -> "-0.63839262"
 Parameter: ZPOS -> "75.0083439"
 Parameter: YPHI -> "66.1533347"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.404290    0.000000   -0.914631
    0.000000    1.000000    0.000000
    0.914631    0.000000    0.404290

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   66.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.00856222"
 Parameter: YPOS -> "-0.63839262"
 Parameter: ZPOS -> "75.0083439"
 Parameter: ZPHI -> "355.485279"
 SELRPN>      1 atoms have been selected out of   2536
 ROTATION MATRIX
    0.996897   -0.078715    0.000000
    0.078715    0.996897    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    4.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   2536
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.008562 XMAX =   -8.008562 XAVE =   -8.008562
    YMIN =   -0.638393 YMAX =   -0.638393 YAVE =   -0.638393
    ZMIN =   75.008344 ZMAX =   75.008344 ZAVE =   75.008344
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.0085622"
Evaluating: -8.0085622+3.5
 Parameter: XMAX <- "-4.5085622"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.638392609"
Evaluating: -0.638392609+3.5
 Parameter: YMAX <- "2.86160739"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "75.0083439"
Evaluating: 75.0083439+3.5
 Parameter: ZMAX <- "78.5083439"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.0085622"
Evaluating: -8.0085622-3.5
 Parameter: XMIN <- "-11.5085622"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.638392609"
Evaluating: -0.638392609-3.5
 Parameter: YMIN <- "-4.13839261"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "75.0083439"
Evaluating: 75.0083439-3.5
 Parameter: ZMIN <- "71.5083439"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.5085622"
 Parameter: XMIN -> "-11.5085622"
 Parameter: YMAX -> "2.86160739"
 Parameter: YMIN -> "-4.13839261"
 Parameter: ZMAX -> "78.5083439"
 Parameter: ZMIN -> "71.5083439"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            set filltube = no
 Parameter: FILLTUBE <- "NO"
  
 CHARMM>            if @filltube .eq. no then
 Parameter: FILLTUBE -> "NO"
 Comparing "NO" and "NO".
 IF test evaluated as true.  Performing command
  
 CHARMM>                if @?imtube .eq. 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>                    if imtube .eq. yes then
 Comparing "YES" and "YES".
 IF test evaluated as true.  Performing command
  
 CHARMM>                        if pbc .eq. x then
 Comparing "Z" and "X".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. y then
 Comparing "Z" and "Y".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                        if pbc .eq. z then
 Comparing "Z" and "Z".
 IF test evaluated as true.  Performing command
  
 CHARMM>                            calc dist = sqrt( @ypos * @ypos + @xpos * @xpos )
 Parameter: YPOS -> "-0.63839262"
 Parameter: YPOS -> "-0.63839262"
 Parameter: XPOS -> "-8.00856222"
 Parameter: XPOS -> "-8.00856222"
Evaluating: SQRT(-0.63839262*-0.63839262+-8.00856222*-8.00856222)
 Parameter: DIST <- "8.03396627"
  
 CHARMM>                            if dist .lt. @rtube goto doinit
 Parameter: RTUBE -> "4.362"
 Comparing "8.03396627" and "4.362".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                        endif
  
 CHARMM>                    endif
  
 CHARMM>                endif
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "57"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "56"
 Comparing "57" and "56".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        label continue
  
 CHARMM>     
  
 CHARMM>        update image inbf 0

 SELECTED IMAGES ATOMS BEING CENTERED ABOUT  0.000000  0.000000  0.000000

 <MKIMAT2>: updating the image atom lists and remapping
 Transformation   Atoms  Groups  Residues  Min-Distance
    1  N1N1N1R1 has       0       0       0       26.65
    2  N1Z0N1R1 has       0       0       0       15.06
    3  N1P1N1R1 has       0       0       0       29.76
    4  Z0N1N1R1 has       0       0       0       19.82
    5  Z0Z0N1R1 has       8       8       2        0.00
    6  Z0P1N1R1 has       0       0       0       18.47
    7  N1N1Z0R1 has       0       0       0       17.00
    8  N1Z0Z0R1 has       1       1       1       10.23
    9  N1P1Z0R1 has       0       0       0       16.24
   10  Z0N1Z0R1 has       3       3       3        9.30
   12  N1N1P1R1 has       0       0       0       29.84
   13  N1Z0P1R1 has       0       0       0       19.70
   14  N1P1P1R1 has       0       0       0       29.81
 Total of 2548 atoms and 2548 groups and   63 residues were included

 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 IMAGE
  
 CHARMM>        COOR CONVERT SYMMETRIC ALIGNED @A @B @C @alpha @beta @gamma
 Parameter: A -> "39"
 Parameter: B -> "39"
 Parameter: C -> "237.395"
 Parameter: ALPHA -> "90.0"
 Parameter: BETA -> "90.0"
 Parameter: GAMMA -> "90.0"
  
 CHARMM>        CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>        ! get the number of @pos residues to reorder
  
 CHARMM>        define JUNK sele segid IONS .and. resname @pos end
 Parameter: POS -> "POT"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natompos
 Parameter: NATOMS -> "0"
 Parameter: NATOMPOS -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr npos by @nresi
 Parameter: NRESI -> "0"
 Parameter: NPOS <- "28"
  
 CHARMM>     
  
 CHARMM>        ! join POS to @pos via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>        ! get the number of @neg residues to reorder
  
 CHARMM>        define JUNK sele segid IONS .and. resname @neg end
 Parameter: NEG -> "CLA"
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natomneg
 Parameter: NATOMS -> "0"
 Parameter: NATOMNEG -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr nneg by @nresi
 Parameter: NRESI -> "0"
 Parameter: NNEG <- "28"
  
 CHARMM>     
  
 CHARMM>        ! join NEG to @neg via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            ! if POS was reordered, NEG may still need to be reordered
  
 CHARMM>            define POS sele segid POS end
 SELRPN>     28 atoms have been selected out of   2536
  
 CHARMM>            set posat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "2481"
 Parameter: POSAT <- "2481"
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     28 atoms have been selected out of   2536
  
 CHARMM>            set negat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "2509"
 Parameter: NEGAT <- "2509"
  
 CHARMM>     
  
 CHARMM>            if negat .eq. 0 goto skipreorder
 Comparing "2509" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            if posat .gt. @negat then
 Parameter: NEGAT -> "2509"
 Comparing "2481" and "2509".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        label skipreorder
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! join everything to IONS segment
  
 CHARMM>        !
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>      0 atoms have been selected out of   2536
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NIONATOMS <- "0"
  
 CHARMM>     
  
 CHARMM>        define POS sele segid POS end
 SELRPN>     28 atoms have been selected out of   2536
  
 CHARMM>        set nposatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "28"
 Parameter: NPOSATOMS <- "28"
  
 CHARMM>     
  
 CHARMM>        define NEG sele segid NEG end
 SELRPN>     28 atoms have been selected out of   2536
  
 CHARMM>        set nnegatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "28"
 Parameter: NNEGATOMS <- "28"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            rename segid IONS sele segid POS end
 SELRPN>     28 atoms have been selected out of   2536
 SEGMENT 'POS     ' IS RENAMED TO 'IONS    '
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>     28 atoms have been selected out of   2536
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "28"
 Parameter: NIONATOMS <- "28"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "28" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if nnegatoms .gt. 0 join IONS NEG renumber
 Comparing "28" and "0".
 IF test evaluated as true.  Performing command
 SEGMENTS "IONS    " AND "NEG     " HAVE BEEN JOINED.
 THE RESIDUE IDENTIFIERS HAVE BEEN RENUMBERED
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        2   Number of residues   =       57
         Number of atoms         =     2536   Number of groups     =     2536
         Number of bonds         =     3704   Number of angles     =     7384
         Number of dihedrals     =    14724   Number of impropers  =        0
         Number of cross-terms   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =    0.00000
  
 CHARMM>        else
 Skip commands until next ENDIF
  
 CHARMM>     
  
 CHARMM>        incr ionind
 Parameter: IONIND <- "2"
  
 CHARMM>        if ionind le @niontypes goto do_ion
 Parameter: NIONTYPES -> "1"
 Comparing "2" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    crystal free
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step2.2_ions_orient.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step2.2_ions_orient.crd::
 OPNLGU> Unit 10 opened for READONLY access to /home/charmm-gui/data/www/4814588605/step2.2_ions_orient.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON MAR, 24. 2022. JOB
 TITLE> * GENERATES IONS
 TITLE> *  DATE:     3/24/22     14:24:16      CREATED BY USER: APACHE
 TITLE> *

 ** WARNING ** Coordinates were overwritten for  2480 atoms.
 *** LEVEL  2 WARNING *** BOMLEV IS    0
  
 CHARMM>     
  
 CHARMM>    open write unit 10 card name step2.2_ions.pdb
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step2.2_ions.pdb::
 OPNLGU> Unit 10 opened for WRITE access to /home/charmm-gui/data/www/4814588605/step2.2_ions.pdb
  
 CHARMM>    write coor unit 10 pdb
 RDTITL> CLOSE UNIT 10
 RDTITL> No title read.
  Write CHARMM-pdb format
  
 CHARMM>    close unit 10
 VCLOSE: Closing unit   10 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    calc cgtotinit = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "0"
Evaluating: 0
 Parameter: CGTOTINIT <- "0"
  
 CHARMM>    calc cgtot = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "0"
Evaluating: INT(0)
 Parameter: CGTOT <- "0"
  
 CHARMM>    if cgtot .ne. 0 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    calc cgdiff = abs(@cgtot - @cgtotinit)
 Parameter: CGTOT -> "0"
 Parameter: CGTOTINIT -> "0"
Evaluating: ABS(0-0)
 Parameter: CGDIFF <- "0"
  
 CHARMM>    if cgdiff .gt. 0.0001 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "0" and "0.0001".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    define target sele .not. segid IONS end
 SELRPN>   2480 atoms have been selected out of   2536
  
 CHARMM>    if ?nsel .gt. 0 delete atom sele target end
 RDCMND substituted energy or value "?NSEL" to "2480"
 Comparing "2480" and "0".
 IF test evaluated as true.  Performing command
 SELRPN>   2480 atoms have been selected out of   2536

 Message from MAPIC: Atom numbers are changed.

 Message from MAPIC:          1 residues deleted.

 Message from MAPIC:          1 segments deleted.
 DELTIC:      3704 bonds deleted
 DELTIC:      7384 angles deleted
 DELTIC:     14724 dihedrals deleted
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =       56
         Number of atoms         =       56   Number of groups     =       56
         Number of bonds         =        0   Number of angles     =        0
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =    0.00000
  
 CHARMM>     
  
 CHARMM>    write title card name step2.2_ions.str
 VOPEN> Attempting to open::step2.2_ions.str::
 RDTITL> * SET NIONTYPES = 1
 RDTITL> * SET NPOSTOT = 28
 RDTITL> * SET NNEGTOT = 28
 RDTITL> * SET NIONTOT = 56
 RDTITL> *
 VCLOSE: Closing unit   90 with status "KEEP"
 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 CARD
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    ! Write CHARMM commands to regenerate ion part of PSF
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set dojoin = no
 Parameter: DOJOIN <- "NO"
  
 CHARMM>     
  
 CHARMM>    bomlev 2 ! force error if no atoms written
  
 CHARMM>     
  
 CHARMM>    write psf  card name step2.2_ions.psf
 VOPEN> Attempting to open::step2.2_ions.psf::
 RDTITL> WRITE COOR CARD NAME STEP2.2_IONS.CRD
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>    write coor card name step2.2_ions.crd
 VOPEN> Attempting to open::step2.2_ions.crd::
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    stop
 VCLOSE: Closing unit   20 with status "KEEP"
$$$$$$  New timer profile $$$$$
 Total time                     27.90 Other:            0.00

                    NORMAL TERMINATION BY NORMAL STOP
                    MOST SEVERE WARNING WAS AT LEVEL  1

                    $$$$$ JOB ACCOUNTING INFORMATION $$$$$
                     ELAPSED TIME:    27.90  SECONDS 
                         CPU TIME:    15.35  SECONDS 
